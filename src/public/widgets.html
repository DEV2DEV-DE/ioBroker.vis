<!-- --------------bars.html--- START -->
<!--
    ioBroker.vis bars Widget-Set

    version: "0.1.4"

    Copyright 2013-2016 bluefox<dogafox@gmail.com>
-->
<link rel="stylesheet" type="text/css" href="widgets/bars/css/bars.css" />
<link rel="stylesheet" type="text/css" href="widgets/bars/css/sidebar.css" />
<link rel="stylesheet" type="text/css" href="widgets/bars/css/barButtons.css" />
<script type="text/javascript" src="widgets/bars/js/bars.js"></script>
<script type="text/javascript" src="widgets/bars/js/jquery.sidebar.js"></script>

<script id="tplBarFilter"
		type="text/ejs"
		class="vis-tpl"
		data-vis-type="filter"
		data-vis-set="bars"
		data-vis-name="Filter bar"
		data-vis-prev='<img src="widgets/bars/img/Prev_bars_filter.png"></img>'
		data-vis-attrs="bCount[1]/number,1,100,1;bTheme[sidebar-red]/style,,sidebar-,background-color;bPosition[floatHorizontal]/select,floatHorizontal,floatVertical,dockTop,dockBottom,dockLeft,dockRight;bOnlyOneSelected/checkbox;bValue/filters;alwaysOpened/checkbox;"
		data-vis-attrs0="group.button_options;bSpace[5]/slider,0,100,1;bRadius[5]/slider,0,100,1;bOffset[0]/slider,0,100,1;bTextAlign[center]/select,center,left,right;bImageAlign[center]/select,center,left,right;bLayout[fixed]/select,auto,fixed;imagePaddingLeft[10]/slider,0,100,1;imagePaddingTop[2]/slider,0,100,1;"
		data-vis-attrs1="group.style;bStyleNormal/style,barButtons,-button,background;bStyleActive/style,barButtons,-button,background;"
		data-vis-attrs2="group.effects;bShowEffect[show]/effect;bShowEffectMs[100]/number;bHideEffect[show]/effect;bHideEffectMs[100]/number;"
		data-vis-attrs3="group.buttons/byindex;buttonsImage(1-bCount)/image;buttonsText(1-bCount);buttonsOption(1-bCount)/filters;"
		data-vis-init="initOptions">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px;overflow:visible" id="<%= this.data.attr('wid') %>"
	    data-vis-hide-helper=<%== (this.data.attr('bPosition')=='dockTop' || this.data.attr('bPosition')=='dockBottom' || this.data.attr('bPosition')=='dockRight' || this.data.attr('bPosition')=='dockRight') ? 'true' : 'false' %>
	    data-vis-resizable='<%== (this.data.attr('bPosition')=='dockTop' || this.data.attr('bPosition')=='dockBottom' || this.data.attr('bPosition')=='dockRight' || this.data.attr('bPosition')=='dockRight') ? '{"disabled":true}': '' %>'
	    data-vis-draggable='<%== (this.data.attr('bPosition')=='dockTop' || this.data.attr('bPosition')=='dockBottom' || this.data.attr('bPosition')=='dockRight' || this.data.attr('bPosition')=='dockRight') ? '{"disabled":true}': '' %>'
	    >
        <div class="vis-widget-body" style="overflow: visible"></div>
        <% vis.binds.bars.init(this.data.wid, this.data, this.view, "tplBarFilter"); %>
    </div>
</script>

<script id="tplBarNavigator"
		type="text/ejs"
		class="vis-tpl"
		data-vis-type="navigation"
		data-vis-set="bars"
		data-vis-prev='<img src="widgets/bars/img/Prev_bars_view.png"></img>'
		data-vis-name="Views bar"
		data-vis-attrs="bCount[1]/number,1,100,1;bTheme[sidebar-blue]/style,,sidebar-,background-color;bPosition[floatHorizontal]/select,floatHorizontal,floatVertical,dockTop,dockBottom,dockLeft,dockRight;alwaysOpened/checkbox;"
		data-vis-attrs0="group.button_options;bSpace[5]/slider,0,100,1;bRadius[5]/slider,0,100,1;bOffset[0]/slider,0,100,1;bTextAlign[center]/select,center,left,right;bImageAlign[center]/select,center,left,right;bLayout[fixed]/select,auto,fixed;imagePaddingLeft[10]/slider,0,100,1;imagePaddingTop[2]/slider,0,100,1;"
		data-vis-attrs1="group.style;bStyleNormal/style,barButtons,-button,background;bStyleActive/style,barButtons,-button,background;"
		data-vis-attrs2="group.effects;bShowEffect[show]/effect;bShowEffectMs[100]/number;bHideEffect[show]/effect;bHideEffectMs[100]/number;"
		data-vis-attrs3="group.buttons/byindex;buttonsImage(1-bCount)/image;buttonsText(1-bCount);buttonsOption(1-bCount)/views;"
		data-vis-init="initOptions">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px;overflow:visible" id="<%= this.data.attr('wid') %>"
	    data-vis-hide-helper=<%== (this.data.attr('bPosition')=='dockTop' || this.data.attr('bPosition')=='dockBottom' || this.data.attr('bPosition')=='dockRight' || this.data.attr('bPosition')=='dockRight') ? 'true' : 'false' %>
	    data-vis-resizable='<%== (this.data.attr('bPosition')=='dockTop' || this.data.attr('bPosition')=='dockBottom' || this.data.attr('bPosition')=='dockRight' || this.data.attr('bPosition')=='dockRight') ? '{"disabled":true}': '' %>'
	    data-vis-draggable='<%== (this.data.attr('bPosition')=='dockTop' || this.data.attr('bPosition')=='dockBottom' || this.data.attr('bPosition')=='dockRight' || this.data.attr('bPosition')=='dockRight') ? '{"disabled":true}': '' %>'
	    >
        <div class="vis-widget-body" style="overflow: visible"></div>
        <% vis.binds.bars.init(this.data.wid, this.data, this.view, "tplBarNavigator"); %>
    </div>
</script>

<!-- --------------bars.html--- END -->
<!-- --------------basic.html--- START -->
<link rel="stylesheet" type="text/css" href="widgets/basic/css/table.css" />
<script type="text/javascript" src="widgets/basic/js/table.js"></script>

<script type="text/javascript">
    'use strict';

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            // Bars
            "src":              {"en": "Source",                    "de": "Quelle",                 "ru": "Адрес"},
            "refreshInterval":  {"en": "Refresh interval(ms)",      "de": "Updatezeit(ms)",         "ru": "Интервал обновления(ms)"},
            "is_comma":         {"en": "Divider comma",             "de": "Komme als Trennung",     "ru": "Запятая-разделитель"},
            "is_tdp":           {"en": "Use thousands separator",  "de": "Tausender Trennzeichen",  "ru": "Use thousands separator"},
            "digits":           {"en": "Digits after comma",        "de": "Zeichen nach Komma",     "ru": "Знаков после запятой"},
            "oid":              {"en": "Object ID",                 "de": "Object ID",              "ru": "ID Объекта"},
            "html_prepend":     {"en": "Prepend value",             "de": "Voranstellen HTML",      "ru": "Префикс значения"},
            "html_append":      {"en": "Append to value",           "de": "HTML anhängen",          "ru": "Суффикс значения"},
            "html_append_singular": {
                "en": "Append to value (Singular)",
                "de": "HTML anhängen (Singulär)",
                "ru": "Суффикс значения(един.ч.)"
            },
            "html_append_plural": {
                "en": "Append to value (Plural)",
                "de": "HTML anhängen(Plüral)",
                "ru": "Суффикс значения(множ.ч.)"
            },
            "html_prepend_tooltip":    {
                "en": "Write HTML code here that will be placed before,\x0Ae.g. <b> ",
                "de": "HTML Kod, der wird vom dem Wert platziert,\x0Az.B. <b>",
                "ru": "HTML код будет помещён перед значением,\x0Aнапример <b>"
            },
            "html_append_tooltip":     {
                "en": "Write HTML code here that will be placed before,\x0Ae.g. </b>",
                "de": "HTML Kod, der wird vom dem Wert platziert,\x0Az.B. </b>",
                "ru": "HTML код будет помещён после значения,\x0Aнапример </b>"
            },
            "stretch":          {"en": "Stretch",                   "de": "Strecken",               "ru": "Растянуть"},
            "factor":           {"en": "Multiplex factor",          "de": "Multiplikation",         "ru": "Множитеть"},
            "class_true":       {"en": "Class if quality 'true'",   "de": "Klasse bei Qualität 'true'", "ru": "Класс, если качество 'true'"},
            "class_false":      {"en": "Class if quality 'false'",  "de": "Klasse bei Qualität 'false'", "ru": "Класс, если качество 'false'"},
            "test_html":        {"en": "Text for test",             "de": "Testtext",               "ru": "Тестовый текст"},
            "test_html_tooltip": {
                "en": "You can specify the test text if value is now empty to visualise settings.\x0AIt is valid only during edit.",
                "de": "Man kann noch Testtext setzen um die Einstellungen visuell zu sehen.\x0ADas ist nur während Edit gültig.",
                "ru": "Можно задать тестовый текст, что бы видеть настройки визуально.\x0AОн действителен только во время редактирования."
            },
            "html":             {"en": "HTML",                      "de": "HTML",                   "ru": "HTML"},
            "oid-quality":      {"en": "Quality ID",                "de": "Qualität ID",            "ru": "ID-Качество"},
            "oid-quality_tooltip":     {
                "en": "You can set additionally Quality ID to indicate if the value valid or not.",
                "de": "Man kann noch zusätzlich Qualität ID setzetn um zu zeigen ob das Wert aktuell ist.",
                "ru": "Можно дополнительно установить ID-Качества, что бы показать актуальное значение или нет."},
            "title":            {"en": "Title",                     "de": "Titel",                  "ru": "Заголовок"},
            "title_font":       {"en": "Title font name",           "de": "Titelschriftname",       "ru": "Шрифт заголовка"},
            "title_color":      {"en": "Title color",               "de": "Titelfarbe",             "ru": "Цвет заголовка"},
            "title_back":       {"en": "Title backg. color",        "de": "Titelhintergrund",       "ru": "Цвет фона текста"},
            "title_top":        {"en": "Title top padding",         "de": "Titel-Oben-Abstand",     "ru": "Отступ заголовка сверху"},
            "title_left":       {"en": "Title left padding",        "de": "Titel-Links-Abstand",    "ru": "Отступ заголовка слева"},
            "header_height":    {"en": "Header height",             "de": "Kopfhöhe",               "ru": "Высота заголовока"},
            "header_color":     {"en": "Header color",              "de": "Kopffarbe",              "ru": "Цвет фона заголовка"},
            "refreshOnWakeUp":  {"en": "Refresh on wake up",        "de": "Update bei Aufwachen",   "ru": "Обновлять при выходе из сна"},
            "refreshOnViewChange": {"en": "Refresh on view change", "de": "Update bei Viewwechsel", "ru": "Обновлять при смене страницы"},
            "refreshWithNoQuery": {"en": "Do not add anything to URL", "de": "Addiere nichst zu URL", "ru": "Ничего не добавлять к URL"},
            "src_":             {"en": "URL, by value=",            "de": "URL falls Wert=",        "ru": "Адрес при значении "},
            "nav_view":         {"en": "View to navigate",          "de": "View zum Navigieren",    "ru": "Перейти на страницу"},
            "group_effects":    {"en": "Show/Hide Effects",         "de": "Anzeige Effekte",        "ru": "Эффекты появления/исчезновения"},
            "group_extended":   {"en": "Extended settings",         "de": "Erweiterte Eistellungen", "ru": "Расширенные настройки"},
            "body-background":  {"en": "Background color by changing", "de": "Hintegrund by Wechsel", "ru": "Фон при смене страниц"},
            "sync":             {"en": "Hide and show together:",   "de": "Anzeigen und verbergen gleichzeitig", "ru": "Появления и исчезновение вместе"},
            // Effects
            "show":             {"en": "show",                      "de": "show",                   "ru": "show"},
            "blind":            {"en": "blind",                     "de": "blind",                  "ru": "blind"},
            "bounce":           {"en": "bounce",                    "de": "bounce",                 "ru": "bounce"},
            "clip":             {"en": "clip",                      "de": "clip",                   "ru": "clip"},
            "drop":             {"en": "drop",                      "de": "drop",                   "ru": "drop"},
            "explode":          {"en": "explode",                   "de": "explode",                "ru": "explode"},
            "fade":             {"en": "fade",                      "de": "fade",                   "ru": "fade"},
            "fold":             {"en": "fold",                      "de": "fold",                   "ru": "fold"},
            "highlight":        {"en": "highlight",                 "de": "highlight",              "ru": "highlight"},
            "puff":             {"en": "puff",                      "de": "puff",                   "ru": "puff"},
            "pulsate":          {"en": "pulsate",                   "de": "pulsate",                "ru": "pulsate"},
            "scale":            {"en": "scale",                     "de": "scale",                  "ru": "scale"},
            "shake":            {"en": "shake",                     "de": "shake",                  "ru": "shake"},
            "size":             {"en": "size",                      "de": "size",                   "ru": "size"},
            "slide":            {"en": "slide",                     "de": "slide",                  "ru": "slide"},
            "is_milliseconds":  {"en": "Milliseconds",              "de": "Millisekunden",          "ru": "Миллисекунды"},
            "is_milliseconds_tooltip": {
                "en": "Is object is milliseconds from 1970.01.01 00:00:00. Normally no.",
                "de": "Ob das Wert die Milleskunden seit 1970.01.01 00:00:00 ist. Normalerweise nicht.",
                "ru": "Является ли значение объекта миллисекундами с 1970.01.01 00:00:00. Обычно нет."
            },
            "format_date":      {"en": "Dateformat",                "de": "Datumformat",            "ru": "Формат даты"},
            "format_date_tooltip": {
                "en": "Dateformat",
                "de": "Datumformat",
                "ru": "Формат даты"
            },
            "show_interval":    {"en": "As interval",               "de": "Als Intervall",          "ru": "Как интервал"},
            "hide_effect":      {"en": "Hide effect",               "de": "Verbergeneffekt",        "ru": "Эффект скрытия"},
            "hide_duration":    {"en": "Hide duration(ms)",         "de": "Verbergendauer",         "ru": "Длительность скрытия(мс)"},
            "hide_options":     {"en": "Hide options",              "de": "Verbergenoptionen",      "ru": "Опции скрытия"},
            "show_effect":      {"en": "Show effect",               "de": "Anzeigeeffekt",          "ru": "Эффект появления"},
            "show_duration":    {"en": "Show duration(ms)",         "de": "Anzeigedauer",           "ru": "Длительность появления(мс)"},
            "show_options":     {"en": "Show options",              "de": "Anzeigeoptionen",        "ru": "Опции появления"},
            "left":             {"en": "left",                      "de": "links",                  "ru": "лево"},
            "right":            {"en": "right",                     "de": "rechts",                 "ru": "право"},
            "top":              {"en": "top",                       "de": "oben",                   "ru": "верх"},
            "bottom":           {"en": "bottom",                    "de": "unten",                  "ru": "низ"},

            "contains_view":    {"en": "Contains view",             "de": "Viewname",               "ru": "Имя страницы"},
            "persistent":       {"en": "Persistent",                "de": "Bleibend",               "ru": "Постоянно"},
            "persistent_tooltip": {
                "en": "If persistent the view will not be destroyed when inactive, just hide.\nElsewise the view will be destroyed, if inactive.",
                "de": "Falls 'Bleibend', dann wird die View nicht zerstört, sondern nur versteckt wenn inaktive. Sonst wird die View immer wieder kreiert und zerstört.",
                "ru": "Если выбранно 'Постоянно', то страница не будет уничтожаться, если она не активна. В противном случае страница будет создаваться и разрушаться."},
            "notIfInvisible":       {"en": "Only if visible",                "de": "Nur falls sichtbar",               "ru": "Только если видимо"},
            "notIfInvisible_tooltip": {
                "en": "View will be used only if this widget is visible",
                "de": "Die View wird nur benutzt, wenn dieses Widget sichtbar ist",
                "ru": "Страница будет использоваться только в том случае, если виден этот виджет"
            },
            "valuelist":        {"en": "Values list",               "de": "Wertenliste",            "ru": "Список значений"},
            "valuelist_tooltip": {
                "en": "Divide values with semicolon, like 'ok;warning;alram'. Every text accordingly for value 0,1,2 and so on\nTo have ';' in text use §§ instead.",
                "de": "Die Werte mit Semikolon trennen, wie 'ok;Warnung;Alarm'. Jeder Text ist entsprechend für das Wert 0,1,2 usw.\nUm ';' im Text zu haben, schrein '§§'.",
                "ru": "Разделять значения точкой запятой, например 'ok;Внимание;Тревога'. Каждый текст соответственно для значения 0,1,2 итд.\nДля написания ';' в тексте используй '§§'."
            },
            "html_false":       {"en": "HTML by 'false'",           "de": "HTML bei 'false'",       "ru": "HTML если 0"},
            "html_true":        {"en": "HTML by 'true'",            "de": "HTML bei 'true'",        "ru": "HTML если 1"},
            "text_false":       {"en": "Text by 'false'",           "de": "Text bei 'false'",       "ru": "Текст если 0"},
            "text_true":        {"en": "Text by 'true'",            "de": "Text bei 'true'",        "ru": "Текст если 1"},
            "svg_false":        {"en": "SVG by 'false'",            "de": "SVG bei 'false'",        "ru": "SVG если 0"},
            "svg_true":         {"en": "SVG by 'true'",             "de": "SVG bei 'true'",         "ru": "SVG если 1"},
            "svg_opacity":      {"en": "Opacity",                   "de": "Durchsichtigkeit",       "ru": "Прозрачность"},
            "html_closed":      {"en": "HTML by 'closed'",          "de": "HTML bei 'zu'",          "ru": "HTML если закрыто"},
            "html_open":        {"en": "HTML by 'open'",            "de": "HTML bei 'auf'",         "ru": "HTML если открыто"},
            "html_tilt":        {"en": "HTML by 'tilted'",          "de": "HTML bei 'gekippt'",     "ru": "HTML если наклоненно"},
            "html_tilt_tooltip": {
                "en": "0 - Closed, 1 - tilt, 2 - open",
                "de": "0- Zu, 1 - gekippt, 2 - auf",
                "ru": "0 - закрыто, 1 - откинуто, 2 - открыто"
            },
            "color":            {"en": "Color",                     "de": "Farbe",                  "ru": "Цвет"},
            "shadow":           {"en": "Opacity",                   "de": "Durchsichtigkeit",       "ru": "Тень"},
            "shadow_tooltip":   {
                "en": "CSS Shadow, like '10px 10px 5px #888888'",
                "de": "CSS Shatten, wie '10px 10px 5px #888888'",
                "ru": "CSS Тень, как '10px 10px 5px #888888'"
            },
            "reverse":          {"en": "Revers value",              "de": "Wert umkehren",          "ru": "Перевернуть значение"},
            "border":           {"en": "Border",                    "de": "Rand",                   "ru": "Окантовка"},
            "border_tooltip":   {
                "en": "CSS border, like 'green 5px solid'",
                "de": "CSS Rand, wie 'green 5px solid'",
                "ru": "CSS бордюр, как 'green 5px solid'"
            },
            "test_text":        {"en": "Test text",                 "de": "Testtext",               "ru": "Тестовый текст"},
            "max_width":        {"en": "Max. width",                "de": "Maximale Breite",        "ru": "Максимальная ширина"},
            "style":            {"en": "Style for ",                "de": "Stil für ",              "ru": "Стиль для "},
            "style_tooltip":    {
                "en": "Write here css style, like: 'color:red;background:white'",
                "de": "Hier muss CSS Stil stehen, wie 'color:red;background:white'",
                "ru": "CSS Стиль, например: 'color:red;background:white'"},
            "count":            {"en": "Values number to",          "de": "Wertsanzahl bis",        "ru": "Количество значений до"},
            "test_list":        {"en": "Test value",                "de": "Testwert",               "ru": "Тестовое значение"},
            "urlValue":         {"en": "Call URL on click",         "de": "Rufe URL bei click",     "ru": "Вызвать URL при нажатии"},
            "group_ccontrol":   {"en": "Advanced control",          "de": "Extrasteuerung",         "ru": "Продвинутое управление"},
            "urlFalse":         {"en": "URL on false",              "de": "URL bei false",          "ru": "URL при false"},
            "urlTrue":          {"en": "URL on true",               "de": "URL bei true",           "ru": "URL при true"},
            "oidFalse":         {"en": "Object ID on false",        "de": "Objekt ID bei false",    "ru": "ID объекта при false"},
            "oidTrue":          {"en": "Object ID on true",         "de": "Objekt ID bei true",     "ru": "ID объекта при true"},
            "oidTrueValue":     {"en": "Value for OÍD on true",     "de": "Wert für ID bei false",  "ru": "Значение для ID при false"},
            "oidFalseValue":    {"en": "Value for OÍD on false",    "de": "Wert für ID bei true",   "ru": "Значение для ID при true"},
            "square":           {"en": "square",                    "de": "square",                 "ru": "квадрат"},
            "pentagone":        {"en": "pentagone",                 "de": "pentagone",              "ru": "Пятиуголник"},
            "hexagone":         {"en": "hexagone",                  "de": "hexagone",               "ru": "Шестиугольник"},
            "octagone":         {"en": "octagone",                  "de": "octagone",               "ru": "Восьмиугольник"},
            "circle":           {"en": "circle",                    "de": "Kreis",                  "ru": "Круг"},
            "svgType":          {"en": "Type",                      "de": "Typ",                    "ru": "Тип"},
            "strokeColor":      {"en": "Stroke color",              "de": "Liniefarbe",             "ru": "Цвет линии"},
            "fill":             {"en": "Fill color",                "de": "Füllfarbe",              "ru": "Цвет заливки"},
            "strokeWidth":      {"en": "Stroke width",              "de": "Liniebreite",            "ru": "Ширина линии"},
            "rotate":           {"en": "Rotate",                    "de": "Drehen",                 "ru": "Повернуть на"},
            "no_control":       {"en": "Read only",                 "de": "Nur Anzeige",            "ru": "Только показывать"},
            "numeric":          {"en": "Number",                    "de": "Nummer",                 "ru": "Число"},
            "autoSet":          {"en": "Auto set",                  "de": "Auto-setzen",            "ru": "Авто запись"},
            "autoSet_tooltip":  {
                "en": "Without 'Auto set' you must press ENTER,\x0ato write the value.",
                "de": "Ohne 'Auto-setzen' man muss danach ENTER drucken,\x0A um das Wert zu schreiben.",
                "ru": "Без 'Авто записи' нужно нажать ENTER,\x0Aчто бы записать значение."
            },
            "group_views":      {"en": "Views",                     "de": "Views",                  "ru": "Страницы"},
            "group_frames":     {"en": "iFrames",                   "de": "iFrames",                "ru": "iFrames"},
            "horizontal":       {"en": "horizontal",                "de": "horizontal",             "ru": "горизонтально"},
            "vertical":         {"en": "vertical",                  "de": "senkrecht",              "ru": "вертикально"},
            "orientation":      {"en": "Orientation",               "de": "Ausrichtung ",           "ru": "Направление"},
            "noSandbox":        {"en": "No sandbox",                "de": "Kein Sandkasten",        "ru": "Не запускать в песочнице"},
            "scrollX":          {"en": "Scroll X",                  "de": "Scroll X",               "ru": "Scroll X"},
            "scrollY":          {"en": "Scroll Y",                  "de": "Scroll Y",               "ru": "Scroll Y"},
            "seamless":         {"en": "Seamless",                  "de": "Kein Rahmen",            "ru": "Без рамки"},
            "filters":          {"en": "Filters",                   "de": "Filter",                 "ru": "Фильтры"},
            "filters_Tooltip":  {
                "en": "Divided by semicolon,\x0Ae.g: light;control",
                "de": "Geteilt mir Semikolon\x0Az.B.: Licht;Steuerung",
                "ru": "Разделять точкой запятой\x0Aнапример: Свет;Управление"
            },
            "Select ID":        {"en": "Select ID",                 "de": "ID auswählen",           "ru": "Выбрать ID"},
            "redirect_url":     {"en": "Redirect URL",              "de": "Weiterleiten nach Logout", "ru": "Перейти на URL после выхода"},
            "in_app_close":     {"en": "Close mobile APP",          "de": "Mobiles APP schliessen", "ru": "Закрыть мобильное приложение"},
            "en-US":            {"en": "english",                   "de": "Englisch",               "ru": "английский"},
            "ru-RU":            {"en": "russian",                   "de": "Russisch",               "ru": "русский"},
            "continuous":       {"en": "Continuous",                "de": "Immer zuhören",          "ru": "Непрерывно"},
            "keywords":         {"en": "Keywords",                  "de": "Schlüsselworte",         "ru": "Ключевые слова"},
            "noImage":          {"en": "No image",                  "de": "Kein Bild",              "ru": "Без картинки"},
            "imageInactive":    {"en": "Inactive",                  "de": "Inaktiv",                "ru": "Не активно"},
            "imageActive":      {"en": "Active",                    "de": "Aktiv",                  "ru": "Активно"},
            "imageStarted":     {"en": "Started",                   "de": "Gestartet",              "ru": "Запущено"},
            "imageDetected":    {"en": "Detected",                  "de": "Gefunden",               "ru": "Обнаружено"},
            "imageSent":        {"en": "Sent",                      "de": "Gesedet",                "ru": "Отослано"},
            "imageHeightPx":    {"en": "Height (px)",               "de": "Höhe (px)",              "ru": "Высота (px)"},
            "imageWidthPx":     {"en": "Width (px)",                "de": "Breite (px)",            "ru": "Ширина (px)"},
            "noText":           {"en": "No help text",              "de": "Keine Hilfetext",        "ru": "Без текста помощи"},
            "noResults":        {"en": "No results",                "de": "Keine Ergebnise",        "ru": "Без результатов"},
            "keyWordColor":     {"en": "Key word color",            "de": "Schlüsselworte-Farbe",   "ru": "Цвет ключевых слов"},
            "keyWordColor_tooltip": {
                "en": "Text color, if key word found",
                "de": "Textfarbe, wenn im Text Schlüsselwort gefunden ist.",
                "ru": "Цвет текста, когда обнаружено ключевое слово"
            },
            "textSentColor":    {"en": "Text sent color",           "de": "Gesendet-Farbe",         "ru": "Цвет отосланного текста"},
            "textSentColor_tooltip": {
                "en": "Text color, when text sent to processing it",
                "de": "Textfarbe, wenn Text ist für Abarbeitung gesendet.",
                "ru": "Цвет текста, когда текст отослан на обработку"
            },
            "speechMode":       {"en": "Speech mode",               "de": "Sprachmodus",            "ru": "Режим речи"},
            "single":           {"en": "single",                    "de": "Ein mal",                "ru": "Одиночный"},
            "startstop":        {"en": "start/stop",                "de": "Start/Stop",             "ru": "Старт/стоп"},
            "line":             {"en": "line",                      "de": "Linie",                  "ru": "линия"},
            "triangle":         {"en": "triangle",                  "de": "Dreieck",                "ru": "треугольник"},
            "star":             {"en": "star",                      "de": "Stern",                  "ru": "звезда"},
            "arrow":            {"en": "arrow",                     "de": "Pfeil",                  "ru": "стрела"},
            "scaleWidth":       {"en": "Scale width",               "de": "breiten Skala",          "ru": "Масштаб по ширине"},
            "scaleHeight":      {"en": "Scale height",              "de": "höhen Skala",            "ru": "Масштаб по высоте"},
            "autoFocus": {
                "en": "Auto focus",
                "de": "Autofokus",
                "ru": "Автофокус",
                "pt": "Auto-foco",
                "nl": "Autofocus",
                "fr": "Mise au point automatique",
                "it": "Messa a fuoco automatica",
                "es": "Enfoque automático",
                "pl": "Automatyczne ustawianie ostrości",
                "zh-cn": "自动对焦"
            }
        });
    }

    $.extend(true, systemDictionary, {
        "Edit note":    {"en": "Edit note",     "de": "Meldung eingeben",   "ru": "Сообщение"},
        "Clear":        {"en": "Clear",         "de": "Löschen",            "ru": "Очистить"},
        "Ok":           {"en": "Ok",            "de": "Ok",                 "ru": "Ok"},
        "Cancel":       {"en": "Cancel",        "de": "Abbrechen",          "ru": "Отмена"},
        "all":          {"en": "all",           "de": "Alle",               "ru": "Все"},
        "just&nbsp;now":  {"en": "just&nbsp;now", "de": "gerade&nbsp;jetzt", "ru": "только&nbsp;что"},
        "for&nbsp;%s&nbsp;min.":  {"en": "for&nbsp;%s&nbsp;min.", "de": "vor&nbsp;%s&nbsp;Min.", "ru": "%s&nbsp;мин. назад"},
        "for&nbsp;%s&nbsp;hr.&nbsp;and&nbsp;%s&nbsp;min.": {
            "en": "for&nbsp;%s&nbsp;hr.&nbsp;and&nbsp;%s&nbsp;min.",
            "de": "vor&nbsp;%s&nbsp;St.&nbsp;und&nbsp;%s&nbsp;Min.",
            "ru": "%s&nbsp;часов&nbsp;и&nbsp;%s&nbsp;мин. назад"
        },
        "yesterday":              {"en": "yesterday", "de": "gestern", "ru": "вчера"},
        "for&nbsp;%s&nbsp;hours": {"en": "for&nbsp;%s&nbsp;hours", "de": "vor&nbsp;%s&nbsp;Stunden", "ru": "%s&nbsp;часов назад"},
        "click to create":        {"en": "click to create", "de": "klicken um zu erzeugen", "ru": "нажать что бы создать"},
        "This option works only in APP": {
            "en": "This option works only in APP",
            "de": "Funktioniert nur im APP",
            "ru": "Работает только в мобильном приложении"
        },
        "info_start": {
            "en": "Click on the microphone icon and begin speaking.",
            "de": "Klicken Sie das Mikrophon an und sagen Sie etwas.",
            "ru": "Нажмите на микрофон и начинайте говорить."
        },
        "info_speak_now": {
            "en": "Speak now.",
            "de": "Sage etwas.",
            "ru": "Говорите."
        },
        "info_no_speech": {
            "en": "No speech was detected. You may need to adjust your <a href=\"//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892\">microphone settings</a>.",
            "de": "No speech was detected. You may need to adjust your <a href=\"//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892\">microphone settings</a>.",
            "ru": "Речи не обнаружено. Может надо настроить микрофон <a href=\"//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892\">Настройки микрофона</a>."
        },
        "info_no_microphone": {
            "en": "No microphone was found. Ensure that a microphone is installed and that <a href=\"//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892\"> microphone settings</a> are configured correctly.",
            "de": "No microphone was found. Ensure that a microphone is installed and that <a href=\"//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892\"> microphone settings</a> are configured correctly.",
            "ru": "No microphone was found. Ensure that a microphone is installed and that <a href=\"//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892\"> microphone settings</a> are configured correctly."
        },
        "info_allow": {
            "en": "Click the \"Allow\" button above to enable your microphone.",
            "de": "Click the \"Allow\" button above to enable your microphone.",
            "ru": "Нажмите на кнопку \"разрешить\" сверху, что бы активировать микрофон."
        },
        "info_denied": {
            "en": "Permission to use microphone was denied.",
            "de": "Permission to use microphone was denied.",
            "ru": "Доступ к микрофону был запрещён."
        },
        "info_blocked": {
            "en": "Permission to use microphone is blocked. To change, go to chrome://settings/contentExceptions#media-stream",
            "de": "Permission to use microphone is blocked. To change, go to chrome://settings/contentExceptions#media-stream",
            "ru": "Доступ к микрофону блокирован. Что бы изменить настройки идите <a href=\"chrome://settings/contentExceptions#media-stream\">сюда</a>"
        },
        "info_upgrade": {
            "en": "Web Speech API is not supported by this browser. Upgrade to<a href=\"//www.google.com/chrome\">Chrome</a> version 25 or later.",
            "de": "Web Speech API is not supported by this browser. Upgrade to<a href=\"//www.google.com/chrome\">Chrome</a> version 25 or later.",
            "ru": "Web Speech API не поддерживается этим браузером. Обновите до <a href=\"//www.google.com/chrome\">Chrome</a> версии 25 или новее."
        }
    });

    vis.binds.stateful = {
        view: function (el, viewArr, persistent, notIfInvisible) {
            var $this = $(el);
            var oid   = $this.attr('data-oid');
            var timer = null;

            function draw(val) {
                timer = null;
                var view = viewArr[val];
                if (!persistent) {
                    $this.parent().find('div.vis-view').remove();
                } else {
                    $this.parent().find('div.vis-view').hide().appendTo($('#vis_container'));
                }
                if (vis.views[view]) {
                    vis.renderView(view, view, true, function (_view) {
                        var $view = $('#visview_' + _view);
                        $view.show().data('persistent', persistent);
                        if (!$this.find('#visview_' + _view).length) {
                            $view.appendTo($this);
                        }
                    });
                }
                vis.destroyUnusedViews();
            }

            function onChange(e, newVal) {
                if (newVal === 'true'  || newVal === true)  newVal = 1;
                if (newVal === 'false' || newVal === false) newVal = 0;
                if (notIfInvisible && !$this.is(':visible')) {
                    return;
                }

                if (timer) {
                    clearTimeout(timer)
                }
                timer = setTimeout(function () {
                    draw(newVal);
                }, 50);
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);
            }
        },
        iframe: function (el, srcArr, refreshInterval) {
            var $this = $(el).parent().find('iframe');
            var oid   = $this.attr('data-oid');
            refreshInterval = parseInt(refreshInterval, 10) || 0;

            function onChange (e, newVal) {
                if (newVal === 'true'  || newVal === true)  newVal = 1;
                if (newVal === 'false' || newVal === false) newVal = 0;
                $this.attr('src', srcArr[newVal]);
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                if (vis.states[oid + '.val'] !== undefined) {
                    var val = vis.states[oid + '.val'];
                    if (val === 'true'  || val === true)  val = 1;
                    if (val === 'false' || val === false) val = 0;
                    $this.attr('src', srcArr[val]);
                }

                if (refreshInterval > 0) {
                    setInterval(function () {
                        var val = vis.states[oid + '.val'] || 0;
                        if (val === 'true'  || val === true)  val = 1;
                        if (val === 'false' || val === false) val = 0;
                        var src = srcArr[val];
                        $this.attr('src', src + (src.match(/\?/) ? '&' : '?') + '_vis_refts=' + Date.now());
                    }, refreshInterval);
                }
            }
        },
        image: function (el, srcArr, refreshInterval) {
            var $this = $(el).parent().find('img');
            var oid = $this.attr('data-oid');
            refreshInterval = parseInt(refreshInterval, 10) || 0;

            function onChange (e, newVal) {
                if (newVal === 'true'  || newVal === true)  newVal = 1;
                if (newVal === 'false' || newVal === false) newVal = 0;
                $this.attr('src', srcArr[newVal]);
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                if (vis.states[oid + '.val'] !== undefined) {
                    var val = vis.states[oid + '.val'];
                    if (val === 'true'  || val === true)  val = 1;
                    if (val === 'false' || val === false) val = 0;
                    $this.attr('src', srcArr[val]);
                }

                if (refreshInterval > 0) {
                    setInterval(function () {
                        var val = vis.states[oid + '.val'] || 0;
                        if (val === 'true'  || val === true)  val = 1;
                        if (val === 'false' || val === false) val = 0;

                        var src = srcArr[val];
                        if (src) $this.attr('src', src + ((src.indexOf('?') !== -1) ? '&' : '?') + '_vis_refts=' + Date.now());
                    }, refreshInterval);
                }
            }

        },
        value: function (values, oid) {
            if (oid !== 'nothing_selected' && vis.states.attr(oid + '.val') !== undefined) {
                var val = vis.states.attr(oid + '.val');
                if (val === 'true'  || val === true)  val = 1;
                if (val === 'false' || val === false) val = 0;
                return values[val];
            } else {
                return values[0];
            }
        }
    };
    vis.binds.container = function (el, view) {
        var $this = $(el);
        if (vis.views[view]) {
            vis.renderView(view, view, true, function (_view) {
                $('#visview_' + _view).appendTo($this).show();
            });
        }
    };
    vis.binds.basic = {
        isFullScreen: false,
        filterDropdown: function (el, filters, hideEffect, hideDuration, showEffect, showDuration) {
            var $this = $(el);
            if (filters) {
                filters = filters.split(';');
                for (var i = 0; i < filters.length; i++) {
                    $this.find('select').append('<option value="' + filters[i] + '">' + filters[i] + '</option>');
                }
            }

            if (vis.viewsActiveFilter[vis.activeView]) {
                $this.find('select option[value="' + vis.viewsActiveFilter[vis.activeView] + '"]').attr('selected', true);
            }

            $this.find('select').change(function () {
                vis.changeFilter(null, $this.find('select option:selected').val(), hideEffect, hideDuration, showEffect, showDuration);
            });
        },
        state: function (el, oid) {
            var $this = $(el);
            oid = oid ? oid : $this.attr('data-oid');
            var val = $this.attr('data-val');

            if (oid) {
                $this.attr('data-ctrl-oid', oid);
            }

            if (val === 'true')  val = true;
            if (val === 'false') val = false;

            if (!vis.editMode) {
                var moved = false;
                $this.on('click touchend', function (e) {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    if (moved) return;

                    var oid = $(this).attr('data-ctrl-oid');

                    if ($(this).attr('url-value')) {
                        vis.conn.httpGet($(this).attr('url-value'));
                    }

                    if (oid) {
                        var val = $(this).attr('data-val');
                        if (val === undefined || val === null) val = false;
                        if (val === 'true')  val = true;
                        if (val === 'false') val = false;
                        if (parseFloat(val).toString() == val) val = parseFloat(val);

                        if (oid) vis.setValue(oid, val);
                    }
                }).on('touchmove', function () {
                    moved = true;
                }).on('touchstart', function () {
                    moved = false;
                });
            }
        },
        pressed: null,
        pressedNext: null,
        increment: function (el, minmax, delay, interval) {

            function fInterval($that) {
                vis.binds.basic.pressedNext = true;
                vis.binds.basic.pressed = null;
                var oid = $that.attr('data-oid');
                if (!vis.editMode) {
                    var step = parseFloat($that.attr('data-vis-step'));
                    var tmp  = parseFloat(vis.states[oid + '.val']) + step;
                    if (step < 0) {
                        if (tmp >= minmax) {
                            vis.setValue($that.attr('data-oid'), tmp);
                            vis.binds.basic.pressed = _setTimeout(fInterval, interval, $that);
                        }
                    } else {
                        if (tmp <= minmax) {
                            vis.setValue($that.attr('data-oid'), tmp);
                            vis.binds.basic.pressed = _setTimeout(fInterval, interval, $that);
                        }
                    }
                }
            }

            function intervalStart(e) {
                vis.binds.basic.pressedNext = false;
                var $this = $(this);
                var oid = $this.attr('data-oid');

                if (vis.binds.basic.pressed) {
                    clearInterval(vis.binds.basic.pressed);
                    vis.binds.basic.pressed = null;
                }

                vis.binds.basic.pressed = setTimeout(fInterval, delay, $this);
            }

            if (!vis.editMode) {
                var moved = false;
                $(el).on('click touchend', function (e) {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    if (moved) return;

                    if (vis.binds.basic.pressed) {
                        clearInterval(vis.binds.basic.pressed);
                        vis.binds.basic.pressed = null;
                    }

                    if (vis.binds.basic.pressedNext) {
                        vis.binds.basic.pressedNext = false;
                        return;
                    }
                    var $this = $(this);
                    var oid = $this.attr('data-oid');
                    var step = parseFloat($this.attr('data-vis-step'));
                    var tmp  = parseFloat(vis.states[oid + '.val']) + step;
                    if (step < 0) {
                        if (minmax === undefined || tmp >= minmax) {
                            vis.setValue($this.attr('data-oid'), tmp);
                        }
                    } else {
                        if (minmax === undefined || tmp <= minmax) {
                            vis.setValue($this.attr('data-oid'), tmp);
                        }
                    }
                }).on('touchmove', function () {
                    moved = true;
                }).on('touchstart', function () {
                    moved = false;
                });
            }

            if (interval) {
                $(el).on('mousedown', intervalStart)
                    .on('touchstart', intervalStart)
                    .on('touchend', function () {
                        if (vis.binds.basic.pressed) {
                            clearInterval(vis.binds.basic.pressed);
                            vis.binds.basic.pressed = null;
                        }
                    })
                    .on('mouseup', function () {
                        if (vis.binds.basic.pressed) {
                            clearInterval(vis.binds.basic.pressed);
                            vis.binds.basic.pressed = null;
                        }
                    }).data('destroy', function (id, $widget) {
                        $widget && $widget.off('mousedown').off('touchstart').off('touchend').off('mouseup');
                    });
            }
        },
        navigation: function (el, options) {
            if (!vis.editMode && options.nav_view) {
                var $this = $(el);
                var moved = false;
                $this.on('click touchend', function (e) {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    if (moved) return;

                    if (options.background) $('body').css({background: options.background});

                    vis.changeView(options.nav_view, options.nav_view, options.hideOptions, options.showOptions, options.sync);
                    //e.preventDefault();
                    //return false;
                }).on('touchmove', function () {
                    moved = true;
                }).on('touchstart', function () {
                    moved = false;
                });
            }
        },
        hideOnFalse: function (el) {
            var $this = $(el);
            var oid   = $this.attr('data-oid');

            function onChange (e, newVal) {
                if (newVal === null || newVal === false || newVal === 0 || newVal === 'false' || !parseInt(newVal, 10)) {
                    if (!vis.editMode) {
                        $this.hide();
                    }
                } else {
                    $this.show();
                }
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $this.data('bound', [oid + '.val'])
                // remember bind handler
                    .data('bindHandler', onChange);

                if (!vis.editMode) {
                    var newVal = vis.states.attr(oid + '.val');
                    if (newVal === null || newVal === false || newVal === 0 || newVal === 'false' || parseInt(newVal, 10) === 0) {
                        $this.hide();
                    }
                }
            }

        },
        /*hideOnTrue: function (el) {
            var $this = $(el);
            var oid = $this.attr('data-oid');
            vis.states.bind(oid + '.val', function (e, newVal, oldVal) {
                if (newVal === true || parseFloat(newVal) > 0) {
                    if (!vis.editMode) {
                        $this.hide();
                    }
                } else {
                    $this.show();
                }
            });
            if (!vis.editMode) {
                if (parseFloat(vis.states.attr(oid + '.val')) !== 0 && vis.states.attr(oid + '.val') !== false) {
                    $this.hide();
                }
            }
        },
        showOnValue: function (el, val) {
            var $this = $(el);
            var oid = $this.attr('data-oid');
            vis.states.bind(oid + '.val', function (e, newVal, oldVal) {
                if (newVal != val) {
                    if (!vis.editMode) {
                        $this.hide();
                    }
                } else {
                    $this.show();
                }
            });
            if (!vis.editMode) {
                if (vis.states.attr(oid + '.val') != val) {
                    $this.hide();
                }
            }
        },*/
        _onChange: function (el, oid, wid) {
            var $this = $(el);
            // If still working
            //console.log(oid + ' ' + vis.states.attr(oid + '.val') + ' (' + vis.states.attr(oid + '.ack') + ') - ' + wid + ' ' + vis.states.attr(wid + '.val') + ' (' + vis.states.attr(wid + '.ack') + ')');

            if (wid && (vis.states.attr(wid + '.val') === true)) return;

            var val = vis.states.attr(oid + '.val');

            if (val === 'false') {
                val = false;
            } else if (val === 'true') {
                val = true;
            } else if (typeof val === 'string') {
                var f = parseFloat(val);
                if (f == val) {
                    val = f;
                } else if (val !== '') {
                    val = true;
                } else {
                    val = false;
                }
            }

            if ($this.data('data-numeric')) {
                $this.prop('checked', (val > (($this.data('data-max') - $this.data('data-min')) / 2)));
            } else {
                $this.prop('checked', val);
            }
        },
        checkbox: function (el, numeric, min, max) {
            var $this = $(el);
            var oid   = $this.data('oid'); // Object ID
            var wid   = $this.data('oid-working'); // Work ID

            function onChange() {
                vis.binds.basic._onChange(el, oid, wid);
            }
            if (oid) {
                var bound = [];
                vis.states.bind(oid + '.val', onChange);
                bound.push(oid + '.val');
                if (wid) {
                    vis.states.bind(wid + '.val', onChange);
                    bound.push(wid + '.val');
                }

                // remember all ids, that bound
                $this.closest('.vis-widget')
                    .data('bound', bound)
                    // remember bind handler
                    .data('bindHandler', onChange);
            }

            if (numeric) {
                if (min !== undefined && min !== null && min !== '') {
                    min = parseFloat(min);
                } else {
                    min = 0;
                }

                if (max !== undefined && max !== null && max !== '') {
                    max = parseFloat(max);
                } else {
                    max = 1;
                }
            } else {
                min = false;
                max = true;
            }

            $this.data('min',     min);
            $this.data('max',     max);
            $this.data('numeric', numeric);

            vis.binds.basic._onChange(el, oid, wid);

            if (!vis.editMode) {
                $this.change(function () {
                    var $this_ = $(this);
                    if ($this_.prop('checked')) {
                        vis.setValue($this_.data('oid'), $this_.data('max'));
                    } else {
                        vis.setValue($this_.data('oid'), $this_.data('min'));
                    }
                });
            }
        },
        input: function (el, data) {
            var $this = $(el);
            var oid   = $this.data('oid'); // Object ID
            var wid   = $this.data('oid-working'); // Work ID

            function onChange(e, val) {
                $this.val(val);
            }

            if (oid) {
                var bound = [oid + '.val'];
                vis.states.bind(oid + '.val', onChange);
                if (wid) {
                    bound.push(wid + '.val');
                    vis.states.bind(wid + '.val', onChange);
                }
                // remember all ids, that bound
                $this.closest('.vis-widget')
                    .data('bound', bound)
                    // remember bind handler
                    .data('bindHandler', onChange);
            }

            if (data.numeric) {
                $this.attr('type', 'number');
                if (data.min !== undefined && data.min !== null && data.min !== '') {
                    data.min = parseFloat(data.min);
                } else {
                    data.min = null;
                }

                if (data.max !== undefined && data.max !== null && data.max !== '') {
                    data.max = parseFloat(data.max);
                } else {
                    data.max = null;
                }
            }

            $this.val(vis.states[oid + '.val'] === undefined ? '' : vis.states[oid + '.val']);

            setTimeout(function () {
                $this.css('text-align', $this.parent().parent().css('text-align'));
                $this.css('color', $this.parent().parent().css('color'));
                $this.css('background', $this.parent().parent().css('background'));
                $this.css('border', '0');
                $this.css('text-font', $this.parent().parent().css('text-font'));
            }, 0);

            if (!vis.editMode) {
                $this.change(function () {
                    var $this_ = $(this);
                    if (data.numeric) {
                        var value = parseFloat($this_.val());
                        if (data.min !== null && value < data.min) {
                            value = data.min;
                            $this_.val(value);
                        } else if (data.max !== null && value > data.max) {
                            value = data.max;
                            $this_.val(value);
                        }
                        vis.setValue($this_.data('oid'), value);
                    } else {
                        vis.setValue($this_.data('oid'), $this_.val());
                    }
                });
                if (data.autoSet) {
                    $this.keyup(function(e) {
                        var timer = $this.data('timer');
                        if (timer) clearTimeout(timer);
                        $this.data('timer', setTimeout(function () {
                            $this.trigger('change');
                        }), 1000);
                    });
                }
            }
        },
        select: function (el, invert) {
            var $this = $(el).prev();
            var oid   = $this.attr('data-oid');
            var val   = vis.states[oid + '.val'];

            if (val === 'false') {
                val = false;
            } else if (val === 'true') {
                val = true;
            } else if (typeof val === 'string') {
                var f = parseFloat(val);
                if (f == val) {
                    val = f;
                } else if (val !== '') {
                    val = true;
                } else {
                    val = false;
                }
            }

            if (invert) val = !val;

            $this.val(val ? 1 : 0);

            if (!vis.editMode) {
                if (oid !== 'nothing_selected') {
                    $this.change(function () {
                        var val = $this.find('option:selected').val();
                        if (invert) val = !val;
                        vis.setValue(oid, val);
                    });
                }
            }
            if (oid !== 'nothing_selected') {

            }
            function onChange(e, newVal, oldVal) {
                if (newVal === 'false') {
                    newVal = false;
                } else if (newVal === 'true') {
                    newVal = true;
                } else if (typeof newVal === 'string') {
                    var f = parseFloat(newVal);
                    if (f == newVal) {
                        newVal = f;
                    } else if (newVal !== '') {
                        newVal = true;
                    } else {
                        newVal = false;
                    }
                }
                if (oldVal === 'false') {
                    oldVal = false;
                } else if (oldVal === 'true') {
                    oldVal = true;
                } else if (typeof oldVal === 'string') {
                    var f = parseFloat(oldVal);
                    if (f == oldVal) {
                        oldVal = f;
                    } else if (oldVal !== '') {
                        oldVal = true;
                    } else {
                        oldVal = false;
                    }
                }

                if (newVal == oldVal) return;

                if (newVal === 'false' || newVal === false || parseFloat(newVal) === 0) {
                    if ($this.find('option[value="1"]').prop('selected')) {
                        $this.find('option[value="1"]').prop('selected', false);
                        $this.find('option[value="0"]').prop('selected', true);
                        $this.trigger('change');
                    }
                } else {
                    if ($this.find('option[value="0"]').prop('selected')) {
                        $this.find('option[value="0"]').prop('selected', false);
                        $this.find('option[value="1"]').prop('selected', true);
                        $this.trigger('change');
                    }
                }
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);
                // remember all ids, that bound
                $this.closest('.vis-widget')
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);
            }
        },
        pushbutton: function(el, oid) {
            if (!vis.editMode) {
                var $this = $(el);
                oid = oid || $this.data('oid');

                $this.on('mousedown touchstart', function (e) {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    vis.setValue(oid, true);
                });
                $this.on('mouseup touchend touchcancel', function (e) {
                    // Protect against two events
                    if (vis.detectBounce(this, true)) return;

                    vis.setValue(oid, false);
                });
            }
        },
        toggle: function (el, oid) {
            var $this = $(el);
            oid = oid || $this.data('oid');
            var min = $this.data('min');
            var max = $this.data('max');

            var urlTrue     = $this.data('url-true');
            var urlFalse    = $this.data('url-false');
            var oidTrue     = $this.data('oid-true');
            var oidFalse    = $this.data('oid-false');
            var oidTrueVal  = $this.data('oid-true-value');
            var oidFalseVal = $this.data('oid-false-value');
            var readOnly    = $this.data('read-only');

            if (min === '') min = undefined;
            if (max === '') max = undefined;

            if ((oid || oidTrue || urlTrue) && !vis.editMode && !readOnly) {
                var moved = false;
                $this.on('click touchend', function () {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    if (moved) return;

                    var val;

                    if (oidTrue || urlTrue) {
                        if (!oidFalse && oidTrue) oidFalse = oidTrue;
                        if (!urlFalse && urlTrue) urlFalse = urlTrue;

                        if (!oid || oid === 'nothing_selected') {
                            val = !$(this).data('state');
                            // remember state
                            $(this).data('state', val);
                        } else {
                            val = vis.states[oid + '.val'];
                            if (max !== undefined) {
                                if (max === 'true')  max = true;
                                if (max === 'false') max = false;
                                if (val === 'true')  val = true;
                                if (val === 'false') val = false;
                                val = (val == max);
                            } else {
                                val = (val === 1 || val === '1' || val === true || val === 'true');
                            }
                            val = !val; // invert
                        }
                        if (min === undefined || min === 'false' || min === null) min = false;
                        if (max === undefined || max === 'true'  || max === null) max = true;

                        if (oidTrue) {
                            if (val) {
                                if (oidTrueVal === undefined || oidTrueVal === null) oidTrueVal = max;
                                if (oidTrueVal === 'false') oidTrueVal = false;
                                if (oidTrueVal === 'true')  oidTrueVal = true;
                                var f = parseFloat(oidTrueVal);
                                if (f.toString() == oidTrueVal) oidTrueVal = f;
                                vis.setValue(oidTrue,  oidTrueVal);
                            } else {
                                if (oidFalseVal === undefined || oidFalseVal === null) oidFalseVal = min;
                                if (oidFalseVal === 'false') oidFalseVal = false;
                                if (oidFalseVal === 'true')  oidFalseVal = true;
                                var f = parseFloat(oidFalseVal);
                                if (f.toString() == oidFalseVal) oidFalseVal = f;
                                vis.setValue(oidFalse, oidFalseVal);
                            }
                        }

                        if (urlTrue) {
                            if (val) {
                                vis.conn.httpGet(urlTrue)
                            } else {
                                vis.conn.httpGet(urlFalse);
                            }
                        }

                        // show new state
                        if (!oid || oid === 'nothing_selected') {
                            var img = $(this).data('img-class');
                            if (val) {
                                if ($(this).data('as-button')) $(this).addClass('ui-state-active');
                                val = $(this).data('img-true');
                            } else {
                                val = $(this).data('img-false');
                                if ($(this).data('as-button')) $(this).removeClass('ui-state-active');
                            }
                            $(this).find('.' + img).attr('src', val);
                        }
                    } else {
                        var val = vis.states[oid + '.val'];
                        if ((min === undefined && (val === null || val === '' || val === undefined || val === false || val === 'false')) ||
                            (min !== undefined && min == val)) {
                            vis.setValue(oid, max !== undefined ? max : true);
                        } else
                        if ((max === undefined && (val === true || val === 'true')) ||
                            (max !== undefined && val == max))
                        {
                            vis.setValue(oid, min !== undefined ? min : false);
                        } else {
                            val = parseFloat(val);
                            if (min !== undefined && max !== undefined) {
                                if (val >= (max - min) / 2) {
                                    val = min;
                                } else {
                                    val = max;
                                }
                            } else {
                                if (val >= 0.5) {
                                    val = 0;
                                } else {
                                    val = 1;
                                }
                            }
                            vis.setValue(oid, val);
                        }
                    }
                }).on('touchmove', function () {
                    moved = true;
                }).on('touchstart', function () {
                    moved = false;
                }).data('destroy', function (id, $widget) {
                    $widget.off('click touchend').off('touchmove').off('touchstart');
                });
            }
        },
        iframeRefresh: function (el, src, refreshInterval, refreshOnWakeUp, refreshOnViewChange, refreshWithNoQuery) {
            var widgetView;
            if (src && typeof src === 'object') {
                widgetView = refreshInterval;
                refreshInterval     = src.refreshInterval;
                refreshOnWakeUp     = src.refreshOnWakeUp;
                refreshOnViewChange = src.refreshOnViewChange;
                refreshWithNoQuery  = src.refreshWithNoQuery;
                src                 = src.src;
            } else if (refreshInterval && typeof refreshInterval === 'object') {
                widgetView = refreshOnWakeUp;
                refreshInterval     = refreshInterval.refreshInterval;
                refreshOnWakeUp     = refreshInterval.refreshOnWakeUp;
                refreshOnViewChange = refreshInterval.refreshOnViewChange;
                refreshWithNoQuery  = refreshInterval.refreshWithNoQuery;
            }
            refreshOnViewChange = refreshOnViewChange === true || refreshOnViewChange === 'true';
            refreshOnWakeUp     = refreshOnWakeUp     === true || refreshOnWakeUp     === 'true';
            refreshWithNoQuery  = refreshWithNoQuery  === true || refreshWithNoQuery  === 'true';

            if (!vis.editMode && src) {
                var $this = $(el).parent().find('iframe');
                var wid = $this.attr('id');
                refreshInterval = parseInt(refreshInterval, 10) || 0;

                if (refreshOnViewChange) {
                    widgetView = widgetView || vis.activeView;
                    vis.navChangeCallbacks.push({cb: function (view) {
                        if (view === widgetView) {
                            $this.attr('src', src + (refreshWithNoQuery ? '' : ((src.indexOf('?') !== -1) ? '&' : '?') + '_refts=' + Date.now()));
                        }
                    }, id: wid});
                }
                if (refreshInterval > 0) {
                    setInterval(function () {
                        if ($this.is(':visible')) {
                            var p = $this.parents(':hidden');
                            if (!p.length || p[0].tagName === 'BODY' || p[0].id === 'materialdesign-vuetify-container') {
                                $this.attr('src', src + (refreshWithNoQuery ? '' : ((src.indexOf('?') !== -1) ? '&' : '?') + '_refts=' + Date.now()));
                            }
                        }
                    }, refreshInterval);
                }
                if (refreshOnWakeUp) {
                    vis.onWakeUp(function () {
                        // TODO this does not work. :(
                        $this.attr('src', src + (refreshWithNoQuery ? '' : ((src.indexOf('?') !== -1) ? '&' : '?') + '_refts=' + Date.now()));
                    }, wid);
                }
            }
        },
        htmlRefresh: function (el, html, refreshInterval) {
            refreshInterval = parseInt(refreshInterval, 10) || 0;
            if (html && !vis.editMode && refreshInterval > 0) {
                var $this = $(el);
                setInterval(function () {
                    if ($this.is(':visible')) {
                        var p = $this.parents(':hidden');
                        if (!p.length || p[0].tagName === 'BODY' || p[0].id === 'materialdesign-vuetify-container') {
                            $this.html(html);
                        }
                    }
                }, refreshInterval);
            }
        },
        imgRefresh: function (el, src, refreshInterval, refreshOnWakeUp, refreshOnViewChange, refreshWithNoQuery) {
            var widgetView;
            if (src && typeof src === 'object') {
                widgetView = refreshInterval;
                refreshInterval     = src.refreshInterval;
                refreshOnWakeUp     = src.refreshOnWakeUp;
                refreshOnViewChange = src.refreshOnViewChange;
                refreshWithNoQuery  = src.refreshWithNoQuery;
                src                 = src.src;
            } else if (refreshInterval && typeof refreshInterval === 'object') {
                widgetView = refreshOnWakeUp;
                refreshInterval     = refreshInterval.refreshInterval;
                refreshOnWakeUp     = refreshInterval.refreshOnWakeUp;
                refreshOnViewChange = refreshInterval.refreshOnViewChange;
                refreshWithNoQuery  = refreshInterval.refreshWithNoQuery;
            }
            refreshOnViewChange = refreshOnViewChange === true || refreshOnViewChange === 'true';
            refreshOnWakeUp     = refreshOnWakeUp     === true || refreshOnWakeUp     === 'true';
            refreshWithNoQuery  = refreshWithNoQuery  === true || refreshWithNoQuery  === 'true';

            if (!vis.editMode && src) {
                var $this = $(el).parent().find('img');
                var wid = $this.attr('id');
                refreshInterval = parseInt(refreshInterval, 10) || 0;

                if (refreshOnViewChange) {
                    widgetView = widgetView || vis.activeView;
                    vis.navChangeCallbacks.push({cb: function (view) {
                        if (view === widgetView) {
                            $this.attr('src', src + (refreshWithNoQuery ? '' : (src.indexOf('?') !== -1 ? '&' : '?') + '_refts=' + Date.now()));
                        }
                    }, id: wid});
                }
                if (refreshInterval > 0) {
                    setInterval(function () {
                        if ($this.is(':visible')) {
                            var p = $this.parents(':hidden');
                            if (!p.length || p[0].tagName === 'BODY' || p[0].id === 'materialdesign-vuetify-container') {
                                $this[0].src = src + (refreshWithNoQuery ? '' : (src.indexOf('?') !== -1 ? '&' : '?') + '_refts=' + Date.now());
                            }
                        }
                    }, refreshInterval);
                }
                if (refreshOnWakeUp) {
                    //console.log("refreshOnWakeUp!");
                    vis.onWakeUp(function () {
                        // TODO this does not work. :(
                        //console.log("wakeup refresh!");
                        $this[0].src = src + (refreshWithNoQuery ? '' : ((src.indexOf('?') !== -1) ? '&' : '?') + '_refts=' + Date.now());
                        //console.log($this.attr('src'));
                    }, wid);
                }
            }
        },
        showSvg: function (myClass, view, wid, oid, opacity, svg_false, svg_true, style, no_control) {
            var $wid = $('#' + wid);

            var id = $wid.attr('id');
            if (id && id.match(/_removed$/)) return;

            if (!$wid.length) {
                return setTimeout(function () {
                    vis.binds.basic.showSvg(myClass, view, wid, oid, opacity, svg_false, svg_true, style, no_control);
                }, 100);
            }

            $wid.find('svg').remove();
            var str = vis.states.attr(oid + '.val');
            if (typeof str === 'string') str = str.toLowerCase();
            var val = parseFloat(str);
            var sText = '<svg version="1.1" style="width:100%;height:100%" xmlns="http://www.w3.org/2000/svg" data-oid="' + oid + '">';
            if (vis.editMode) {
                if (opacity === undefined || opacity === null || opacity === '') opacity = 1;

                if (parseFloat(opacity) < 0.2) opacity = 0.2;
            }
            if (val === 0 || str === 'false' || str === '0' || str === 'off' || str === false || str === null || str === undefined) {
                // try to analyse
                sText += svg_false;
            } else {
                sText += svg_true;
            }
            sText += '</svg>';
            $wid.find('.vis-widget-body').append(sText);

            if (style) $wid.css(style);

            var moved = false;

            function onSvgClick() {
                // Protect against two events
                if (vis.detectBounce(this)) return;

                if (moved) return;

                var val = vis.states[oid + '.val'];
                if (val === null || val === '' || val === undefined || val === false || val === "false") {
                    vis.setValue(oid, true);
                } else if (val === true || val === "true") {
                    vis.setValue(oid, false);
                } else {
                    val = parseFloat(val);
                    if (val >= 0.5) {
                        val = 1;
                    } else {
                        val = 0;
                    }
                    vis.setValue(oid, 1 - val);
                }
            }

            function onChange (e, newVal) {
                if (newVal === 'true'  || newVal === true)  newVal = 1;
                if (newVal === 'false' || newVal === false || newVal === '0') newVal = 0;
                var $svg = $('#' + wid).find('svg');

                $svg.html(newVal ? svg_true : svg_false);

                if (!vis.editMode && !no_control) {
                    $svg.children().unbind('click touchend touchmove touchstart').on('click touchend', onSvgClick)
                        .on('touchmove', function () {
                            moved = true;
                        }).on('touchstart', function () {
                        moved = false;
                    });
                } else if (vis.editMode){
                    $svg.children().unbind('click touchstart').on('click touchstart', function () {
                        vis.inspectWidgets([wid]);
                    });
                }
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);
                // remember all ids, that bound
                $wid.data('bound', [oid + '.val'])
                // remember bind handler
                    .data('bindHandler', onChange);
            }
            var $svg = $wid.find('svg');
            if (!vis.editMode && !no_control) {
                $svg.children().off('click touchend').on('click touchend', onSvgClick).off('touchmove').on('touchmove', function () {
                    moved = true;
                }).on('touchstart', function () {
                    moved = false;
                });
            } else if (vis.editMode){
                $svg.children().off('click touchstart').on('click touchstart', function () {
                    vis.inspectWidgets([wid]);
                });
            }
            $wid.data('destroy', function (id, $widget) {
                $widget.find('svg').children().off('click touchend').off('touchmove').off('click touchstart');
            });
        },
        editNote: function (wid, max_width, min_width, min_height, oid) {
            if (vis.editMode) return;

            max_width  = max_width  ? parseInt(max_width,  10) : 400;
            min_width  = min_width  ? parseInt(min_width,  10) : 40;
            min_height = min_height ? parseInt(min_height, 10) : 15;

            var $this = $('#div_' + wid);
            $('body').append('<div id="dlg_' + wid + '" title="' + _('Edit note') + '">' +
                '<textarea style="resize: none; width:95%; height:92%" id="text_' + wid + '">' + $this.text().trim() + '</textarea></div>');

            var buttons = {};
            buttons[_('Clear')] = function () {
                $('#text_' + $(this).attr('data-wid')).val("");
            };

            buttons[_('Ok')] = function () {
                var dlg  = $(this);
                var oid  = dlg.attr('data-oid');
                var wid  = dlg.attr('data-wid');
                var text = $('#text_' + wid).val();
                text = text.replace('\n', '<br>\n');

                if (!oid) $('#div_' + wid).html(text);
                /*if (!text) {
                 $('#' + wid).css({width: min_width, height: min_height});
                 }
                 else {
                 $('#' + wid).css({width: max_width, height: 'auto'});
                 }*/

                if (oid) vis.setValue(oid, text);

                dlg.dialog('close');
                dlg.remove();
            };

            buttons[_('Cancel')] = function () {
                $(this).dialog('close');
                $(this).remove();
            };

            $('#dlg_' + wid).attr('data-oid', oid).attr('data-wid', wid).dialog({
                width:   500,
                height:  300,
                modal:   true,
                buttons: buttons
            });
        },
        formatFloat: function (data, val) {
            if (vis.editMode && data.attr('test_html') !== undefined && data.attr('test_html') !== '') {
                val = parseFloat(data.attr('test_html'));
            } else if (val === undefined || val === null) {
                val = parseFloat(vis.states.attr(data.oid + '.val'));
            }else {
                val = parseFloat(val);
            }
            if (data.factor !== undefined && data.factor !== '') val = val * parseFloat(data.factor);
            if (data.digits !== undefined && data.digits !== '') val = val.toFixed(parseFloat(data.digits, 10));

            if (data.attr('is_tdp')) {
                val = this.formatValue(val, data.digits ? parseInt(data.digits) : 2, data.attr('is_comma') ? '.,' : ',.');
            } else if (data.attr('is_comma')) {
                val = '' + val;
                val = val.replace('.', ',');
            }

            return val;
        },
        extractWidth: function (css, multiplier) {
            // extract from "2px solid #aabbcc" => 2px
            var m = css.match(/([0-9])+(px|em)?/);
            if (m) {
                if (m[1] && m[2]) {
                    return parseInt(m[1], 10) * (multiplier || 1) + m[2];
                } else {
                    return parseInt(m[1], 10) * (multiplier || 1);
                }
            }
        },
        getCalc: function (data, val) {
            var min = (data.min || data.min === 0) ? parseFloat(data.min) : 0;
            var max = (data.max || data.max === 0) ? parseFloat(data.max) : 100;
            val = parseFloat(vis.states.attr(data.oid + '.val')) || 0;
            val = (val - min) / (max - min);
            return (data.border) ? ('calc(' + Math.round(val * 100) + '% - ' + vis.binds.basic.extractWidth(data.border, 2) + ')') : (Math.round(val * 100) + '%');
        },

        formatValue: function formatValue(value, decimals, _format) {
            if (typeof decimals !== 'number') {
                decimals = 2;
                _format = decimals;
            }
            var format = (_format === undefined) ? '.,' : _format;
            if (typeof value !== 'number') value = parseFloat(value);
            return isNaN(value) ? '' : value.toFixed(decimals || 0).replace(format[0], format[1]).replace(/\B(?=(\d{3})+(?!\d))/g, format[0]);
        },

        formatIntervalHelper: function (value, type) {
            var singular;
            var plural;
            var special24;
            if (vis.language === 'de') {
                if (type === 'seconds') {
                    singular = 'Sekunde';
                    plural   = 'Sekunden';
                } else if (type === 'minutes') {
                    singular = 'Minute';
                    plural   = 'Minuten';
                } else if (type === 'hours') {
                    singular = 'Stunde';
                    plural   = 'Stunden';
                } else if (type === 'days') {
                    singular = 'Tag';
                    plural   = 'Tagen';
                }
            } else
            if (vis.language === 'ru') {
                if (type === 'seconds') {
                    singular  = 'секунду';
                    plural    = 'секунд';
                    special24 = 'секунды';
                } else if (type === 'minutes') {
                    singular  = 'минуту';
                    plural    = 'минут';
                    special24 = 'минуты';
                } else if (type === 'hours') {
                    singular  = 'час';
                    plural    = 'часов';
                    special24 = 'часа';
                } else if (type === 'days') {
                    singular  = 'день';
                    plural    = 'дней';
                    special24 = 'дня';
                }
            } else {
                if (type === 'seconds') {
                    singular = 'second';
                    plural   = 'seconds';
                } else if (type === 'minutes') {
                    singular = 'minute';
                    plural   = 'minutes';
                } else if (type === 'hours') {
                    singular = 'hour';
                    plural   = 'hours';
                } else if (type === 'days') {
                    singular = 'day';
                    plural   = 'days';
                }
            }

            if (value === 1) {
                if (vis.language === 'de') {
                    if (type === 'days') {
                        return 'einem ' + singular;
                    } else {
                        return 'einer ' + singular;
                    }
                } else if (vis.language === 'ru') {
                    if (type === 'days' || type === 'hours') {
                        return 'один ' + singular;
                    } else {
                        return 'одну ' + singular;
                    }
                } else {
                    return 'one ' + singular;
                }
            } else {
                if (vis.language === 'de') {
                    return value + ' ' + plural;
                } else if (vis.language === 'ru') {
                    var d = value % 10;
                    if (d === 1 && value !== 11) {
                        return value + ' ' + singular;
                    } else
                    if (d >= 2 && d <= 4 && (value > 20 || value < 10)) {
                        return value + ' ' + special24;
                    } else {
                        return value + ' ' + plural;
                    }
                } else {
                    return value + ' ' + plural;
                }
            }
        },
        formatInterval: function (timestamp, isMomentJs) {
            if (isMomentJs && typeof moment !== 'undefined') {
                return moment(new Date(timestamp)).fromNow();
            }
            var diff = Date.now() - timestamp;
            diff = Math.round(diff / 1000);
            var text;
            if (diff <= 60) {
                if (vis.language === 'de') {
                    text = 'vor ' + vis.binds.basic.formatIntervalHelper(diff, 'seconds');
                } else if (vis.language === 'ru') {
                    text = vis.binds.basic.formatIntervalHelper(diff, 'seconds') + ' назад';
                } else {
                    text = vis.binds.basic.formatIntervalHelper(diff, 'seconds') + ' ago';
                }
            } else if (diff < 3600) {
                var m = Math.floor(diff / 60);
                var s = diff - m * 60;
                text = '';
                if (vis.language === 'de') {
                    text = 'vor ' + vis.binds.basic.formatIntervalHelper(m, 'minutes');
                } else if (vis.language === 'ru') {
                    text = vis.binds.basic.formatIntervalHelper(m, 'minutes');
                } else {
                    text = vis.binds.basic.formatIntervalHelper(m, 'minutes');
                }

                if (m < 5) {
                    // add seconds
                    if (vis.language === 'de') {
                        text += ' und ' + vis.binds.basic.formatIntervalHelper(s, 'seconds');
                    } else if (vis.language === 'ru') {
                        text += ' и ' + vis.binds.basic.formatIntervalHelper(s, 'seconds');
                    } else {
                        text += ' and ' + vis.binds.basic.formatIntervalHelper(s, 'seconds');
                    }
                }

                if (vis.language === 'de') {
                    // nothing
                } else if (vis.language === 'ru') {
                    text += ' назад';
                } else {
                    text += ' ago';
                }
            } else if (diff < 3600 * 24) {
                var h = Math.floor(diff / 3600);
                var m = Math.floor((diff - h * 3600) / 60);
                text = '';
                if (vis.language === 'de') {
                    text = 'vor ' + vis.binds.basic.formatIntervalHelper(h, 'hours');
                } else if (vis.language === 'ru') {
                    text = vis.binds.basic.formatIntervalHelper(h, 'hours');
                } else {
                    text = vis.binds.basic.formatIntervalHelper(h, 'hours');
                }

                if (h < 10) {
                    // add seconds
                    if (vis.language === 'de') {
                        text += ' und ' + vis.binds.basic.formatIntervalHelper(m, 'minutes');
                    } else if (vis.language === 'ru') {
                        text += ' и ' + vis.binds.basic.formatIntervalHelper(m, 'minutes');
                    } else {
                        text += ' and ' + vis.binds.basic.formatIntervalHelper(m, 'minutes');
                    }
                }

                if (vis.language === 'de') {
                    // nothing
                } else if (vis.language === 'ru') {
                    text += ' назад';
                } else {
                    text += ' ago';
                }
            } else {
                var d = Math.floor(diff / (3600 * 24));
                var h = Math.floor((diff - d * (3600 * 24)) / 3600);
                text = '';
                if (vis.language === 'de') {
                    text = 'vor ' + vis.binds.basic.formatIntervalHelper(d, 'days');
                } else if (vis.language === 'ru') {
                    text = vis.binds.basic.formatIntervalHelper(d, 'days');
                } else {
                    text = vis.binds.basic.formatIntervalHelper(d, 'days');
                }

                if (d < 3) {
                    // add seconds
                    if (vis.language === 'de') {
                        text += ' und ' + vis.binds.basic.formatIntervalHelper(h, 'hours');
                    } else if (vis.language === 'ru') {
                        text += ' и ' + vis.binds.basic.formatIntervalHelper(h, 'hours');
                    } else {
                        text += ' and ' + vis.binds.basic.formatIntervalHelper(h, 'hours');
                    }
                }

                if (vis.language === 'de') {
                    // nothing
                } else if (vis.language === 'ru') {
                    text += ' назад';
                } else {
                    text += ' ago';
                }
            }
            return text;
        },
        startUpdateInterval: function () {
            if (vis.binds.basic.updateInterval) return;
            vis.binds.basic.updateInterval = setInterval(function () {
                $('.time-interval').each(function () {
                    $(this).html(vis.binds.basic.formatInterval($(this).data('time'), $(this).data('moment')))
                });
            }, 15000);
        },
        formatDate: function (dateObj, format, interval, isMomentJs) {
            if (typeof format === 'boolean') {
                interval = format;
                format = 'auto';
            }

            if (format === 'auto') format = (vis.dateFormat || 'DD.MM.YYYY') + ' hh:mm:ss';

            format = format || vis.dateFormat || 'DD.MM.YYYY';

            if (!dateObj) return '';
            var text = typeof dateObj;
            if (text === 'string') {
		dateObj = new Date(dateObj);
            }
            if (text !== 'object') {
                var i = parseInt(dateObj, 10);
                if (i == dateObj) {
                    i = dateObj;
                    // if greater than 2000.01.01 00:00:00
                    if (i > 946681200000) {
                        dateObj = new Date(dateObj);
                    } else {
                        dateObj = new Date(dateObj * 1000);
                    }
                } else {
                    dateObj = new Date(dateObj);
                }
            }
            if (interval) {
                vis.binds.basic.startUpdateInterval();
                return '<span class="time-interval" data-time="' + dateObj.getTime() + '" data-moment="' + (isMomentJs || false) + '">' + vis.binds.basic.formatInterval(dateObj.getTime(), isMomentJs) + '</span>';
            }

            var v;

            // Year
            if (format.indexOf('YYYY') !== -1 || format.indexOf('JJJJ') !== -1 || format.indexOf('ГГГГ') !== -1) {
                v = dateObj.getFullYear();
                format = format.replace('YYYY', v);
                format = format.replace('JJJJ', v);
                format = format.replace('ГГГГ', v);
            } else if (format.indexOf('YY') !== -1 || format.indexOf('JJ') !== -1 || format.indexOf('ГГ') !== -1) {
                v = dateObj.getFullYear() % 100;
                format = format.replace('YY', v);
                format = format.replace('JJ', v);
                format = format.replace('ГГ', v);
            }
            // Month
            if (format.indexOf('MM') !== -1 || format.indexOf('ММ') !== -1) {
                v =  dateObj.getMonth() + 1;
                if (v < 10) v = '0' + v;
                format = format.replace('MM', v);
                format = format.replace('ММ', v);
            } else if (format.indexOf('M') !== -1 || format.indexOf('М') !== -1) {
                v =  dateObj.getMonth() + 1;
                format = format.replace('M', v);
                format = format.replace('М', v);
            }

            // Day
            if (format.indexOf('DD') !== -1 || format.indexOf('TT') !== -1 || format.indexOf('ДД') !== -1) {
                v =  dateObj.getDate();
                if (v < 10) v = '0' + v;
                format = format.replace('DD', v);
                format = format.replace('TT', v);
                format = format.replace('ДД', v);
            } else if (format.indexOf('D') !== -1 || format.indexOf('TT') !== -1 || format.indexOf('Д') !== -1) {
                v =  dateObj.getDate();
                format = format.replace('D', v);
                format = format.replace('T', v);
                format = format.replace('Д', v);
            }

            // hours
            if (format.indexOf('hh') !== -1 || format.indexOf('SS') !== -1 || format.indexOf('чч') !== -1) {
                v =  dateObj.getHours();
                if (v < 10) v = '0' + v;
                format = format.replace('hh', v);
                format = format.replace('SS', v);
                format = format.replace('чч', v);
            } else if (format.indexOf('h') !== -1 || format.indexOf('S') !== -1 || format.indexOf('ч') !== -1) {
                v =  dateObj.getHours();
                format = format.replace('h', v);
                format = format.replace('S', v);
                format = format.replace('ч', v);
            }

            // minutes
            if (format.indexOf('mm') !== -1 || format.indexOf('мм') !== -1) {
                v =  dateObj.getMinutes();
                if (v < 10) v = '0' + v;
                format = format.replace('mm', v);
                format = format.replace('мм', v);
            } else if (format.indexOf('m') !== -1 ||  format.indexOf('м') !== -1) {
                v =  dateObj.getMinutes();
                format = format.replace('m', v);
                format = format.replace('v', v);
            }

            // milliseconds
            if (format.indexOf('sss') !== -1 || format.indexOf('ссс') !== -1) {
                v =  dateObj.getMilliseconds();
                if (v < 10) {
                    v = '00' + v;
                } else if (v < 100) {
                    v = '0' + v;
                }
                format = format.replace('sss', v);
                format = format.replace('ссс', v);
            }

            // seconds
            if (format.indexOf('ss') !== -1 || format.indexOf('сс') !== -1) {
                v =  dateObj.getSeconds();
                if (v < 10) v = '0' + v;
                format = format.replace('ss', v);
                format = format.replace('cc', v);
            } else if (format.indexOf('s') !== -1 || format.indexOf('с') !== -1) {
                v =  dateObj.getHours();
                format = format.replace('s', v);
                format = format.replace('с', v);
            }

            return format;
        },
        detectScreen: function (wid) {
            if (!vis.navChangeCallbacks.find(item => typeof item === 'object' && item.cb === vis.binds.basic.detectScreen)) {
                vis.navChangeCallbacks.push({ cb: vis.binds.basic.detectScreen, id: wid });
            }

            function onResize () {
                if (vis.editMode) {
                    $('.vis-resolution-width').html(vis.views[vis.activeView].settings.sizex  || $(window).width());
                    $('.vis-resolution-height').html(vis.views[vis.activeView].settings.sizey || $(window).height());
                    $('.vis-resolution-default-view').html(vis.findNearestResolution(vis.views[vis.activeView].settings.sizex || $(window).width(), vis.views[vis.activeView].settings.sizey || $(window).height()));
                } else {
                    $('.vis-resolution-width').html($(window).width());
                    $('.vis-resolution-height').html($(window).height());
                    $('.vis-resolution-default-view').html(vis.findNearestResolution());
                }
            }

            setTimeout(function () {
                $(window).bind('resize', onResize);
                if (vis.editMode) {
                    $('.vis-resolution-width').html(vis.views[vis.activeView].settings.sizex  || $(window).width());
                    $('.vis-resolution-height').html(vis.views[vis.activeView].settings.sizey || $(window).height());
                    $('.vis-resolution-default-view').html(vis.findNearestResolution(vis.views[vis.activeView].settings.sizex || $(window).width(), vis.views[vis.activeView].settings.sizey || $(window).height()));
                } else {
                    $('.vis-resolution-width').html($(window).width());
                    $('.vis-resolution-height').html($(window).height());
                    $('.vis-resolution-default-view').html(vis.findNearestResolution());
                }
            }, 100);

            if (vis.editMode) {
                $('#' + wid).data('destroy', function () {
                    $(window).unbind('resize', onResize);
                });
            }
        },
        createScreenText: function () {
            setTimeout(function () {
                $('.basic-click-create-instance').unbind('click').click(function () {
                    if (!vis.instance) {
                        vis.generateInstance();
                        if (vis.instance) {
                            $(this).html(vis.instance).removeClass('basic-click-create-instance').css({
                                'font-weight': 'inherit',
                                cursor: 'inherit'
                            });
                        } else {
                            window.alert('Cannot generate!');
                        }
                    }
                });
            }, 500);
            return '<span class="basic-click-create-instance" style="font-weight: bold; cursor: pointer">' + _('click to create') + '</span>';
        },
        isFalse: function (val, min, max) {
            if (min !== undefined && min !== null && min !== '') {
                if (val === 'true') {
                    val = true;
                }
                if (val === 'false') {
                    val = false;
                }
                if (max !== undefined && max !== null && max !== '') {
                    if (max === 'false') {
                        max = false;
                    }
                    if (max === 'true') {
                        max = true;
                    }
                    return val != max;
                } else {
                    if (min === 'false') {
                        min = false;
                    }
                    if (min === 'true') {
                        min = true;
                    }
                    return val == min;
                }
            }
            if (val === undefined || val === null || val === false || val === 'false' || val === 'FALSE' || val === 'False' || val === 'OFF' || val === 'Off' || val === 'off' || val === '') return true;
            if (val === '0' || val === 0) return true;
            var f = parseFloat(val);
            if (f.toString() !== 'NaN') return !f;
            return false;
        },
        circlePoints: function (radius, num, step) {
            var isArray = false;
            if (step === true) {
                isArray = true;
                step = 0;
            }
            step = step || 360 / num;
            var points = [];
            var text = '';
            for (var i = 0; i < num; i++) {
                var point = {x:Math.sin(Math.PI / 180 * (i * step - 180)) * radius, y:Math.cos(Math.PI / 180 * (i * step - 180)) * radius};
                points.push(point);
                text += point.x + ', ' + point.y + ' ';
            }
            if (isArray) return points;
            return text;
        },
        createValueGesture: function (widgetID, view, data, style) {
            var $div = $('#' + widgetID);
            // if nothing found => wait
            if (!$div.length) {
                return setTimeout(function () {
                    vis.binds.basic.createValueGesture(widgetID, view, data, style);
                }, 100);
            }
            var $content = $('#' + widgetID + ' .vis-widget-body');
            function refresh(val, x, y) {
                var text;
                if (val === null){
                    $div.hide();
                    return;
                }
                text = data.html_prepend || '';
                text += vis.binds.basic.formatFloat(data,val);
                text += parseFloat(vis.binds.basic.formatFloat(data,val)) === 1 ? data.html_append_singular || '' : data.html_append_plural || '';
                $content.html(text);
                $div.css({left: parseInt(x)  -$div.width() / 2 + 'px', top: parseInt(y) - $div.height() / 2 + 'px'}).show();
            }
            if (vis.editMode){
                refresh(data.test_html || 0, $div.position().left + $div.width() / 2, $div.position().top + $div.height() / 2);
            } else {
                refresh(null, 0, 0);
            }

            // subscribe top value updates
            $div.on('gestureUpdate', function(event, evData){
                refresh(evData.val, evData.x, evData.y);
            });
        },
        speech2text: function (wid, view, data, style) {
            var $div = $('#' + wid);
            // if nothing found => wait
            if (!$div.length) {
                return setTimeout(function () {
                    vis.binds.basic.speech2text(wid, view, data, style);
                }, 100);
            }

            if (typeof webkitSpeechRecognition === 'undefined') {
                console.error('Browser does not support speech 2 text');
                $div.find('.mic-info-text').html(_('info_upgrade'));
                return;
            }

            var _data ={
                continuous:     data.speechMode === 'continuous' || data.speechMode === 'startstop',
                speechMode:     data.speechMode,
                oid:            data.oid,
                language:       data.language,
                finalTranscript: '',
                lastText:       '',
                recognition:    null,
                ignoreOnEnd:    false,
                timer:          null,
                words:          data.keywords ? data.keywords.toLowerCase().split(/[\s,;]+/g) : null,
                textSentColor:  data.textSentColor,
                keyWordColor:   data.keyWordColor,
                imageInactive:  data.imageInactive,
                imageActive:    data.imageActive    || data.imageInactive,
                imageStarted:   data.imageStarted   || data.imageInactive,
                imageDetected:  data.imageDetected  || data.imageInactive,
                imageSent:      data.imageSent      || data.imageInactive,
                $text:          $div.find('.mic-info-text'),
                $result:        $div.find('.mic-results'),
                $image:         $div.find('.mic-image')
            };
            data = null;

            function findKeyWord(text) {
                var found = false;
                if (_data.words) {
                    found = false;
                    var wwords = text.toLowerCase().split(' ');
                    for (var w = 0; w < _data.words.length; w++) {
                        var pos = wwords.indexOf(_data.words[w]);
                        if (pos !== -1) {
                            var offset = 0;
                            for (var p = 0; p < pos; p++) {
                                offset += wwords[p].length + 1;
                            }
                            text = text.substring(0, offset) + '<b>' + text.substring(offset, offset + wwords[pos].length) + '</b>' + text.substring(offset + wwords[pos].length);
                            found = true;
                            break;
                        }
                    }
                } else {
                    return true;
                }
                return found ? text : false;
            }

            function startRecognition() {
                if (_data.recognition) {
                    if (_data.speechMode === 'startstop') {
                        _data.recognition.onend = null;
                        _data.recognition.stop();
                        _data.recognition = null;
                        _data.$text.html(_('info_start')).show();
                        _data.$image.attr('src', _data.imageInactive);
                        _data.$result.hide();
                    }
                    return;
                }

                _data.recognition                 = new webkitSpeechRecognition();
                _data.recognition.continuous      = _data.continuous;
                _data.recognition.interimResults  = true;
                _data.recognition.maxAlternatives = 1;
                var startTimestamp = new Date();


                _data.recognition.onstart = function() {
                    _data.$text.html(_('info_speak_now')).show();
                    _data.$image.attr('src', _data.imageActive);
                    _data.$result.hide();
                };

                _data.recognition.onerror  = function(event) {
                    _data.$result.hide();
                    _data.$text.show();
                    _data.$image.attr('src', _data.imageInactive);
                    if (event.error === 'no-speech') {
                        _data.$text.html(_('info_no_speech'));
                        //_data.ignoreOnEnd = true;
                    }
                    if (event.error === 'audio-capture') {
                        _data.$text.html(_('info_no_microphone'));
                        _data.ignoreOnEnd = true;
                    }
                    if (event.error === 'not-allowed') {
                        if (event.timeStamp - startTimestamp < 100) {
                            _data.$text.html(_('info_blocked'));
                        } else {
                            _data.$text.html(_('info_denied'));
                        }
                        _data.ignoreOnEnd = true;
                    }
                };

                _data.recognition.onend    = function() {
                    // console.log('onend');
                    _data.recognition.stop();
                    _data.recognition = null;
                    if (!_data.ignoreOnEnd) {
                        setTimeout(function () {
                            _data.$image.attr('src', _data.imageInactive);
                            if (_data.continuous) {
                                _data.$result.hide();
                                _data.$text.html(_('info_speak_now')).show();
                                startRecognition();
                            } else {
                                _data.$result.hide();
                                _data.$text.html(_('info_start')).show();
                            }
                        }, 1000);
                    }
                };

                _data.recognition.onresult = function(event) {
                    var interimTranscript = '';

                    if (typeof event.results === 'undefined') {
                        _data.recognition.onend = null;
                        _data.recognition.stop();
                        return;
                    }

                    for (var i = event.resultIndex; i < event.results.length; ++i) {
                        if (event.results[i].isFinal) {
                            _data.finalTranscript += event.results[i][0].transcript;
                        } else {
                            interimTranscript += event.results[i][0].transcript;
                        }
                    }

                    if (_data.$image.attr('src') === _data.imageActive) _data.$image.attr('src', _data.imageStarted);

                    //final_transcript = capitalize(final_transcript);
                    _data.$text.hide();
                    var text = _data.finalTranscript || interimTranscript;
                    var found = findKeyWord(text);

                    if (!_data.originalColor) _data.originalColor = _data.$result.css('color');

                    if (found) {
                        text = found;
                        if (_data.$image.attr('src') === _data.imageStarted) _data.$image.attr('src', _data.imageDetected);
                        _data.$result.addClass('mic-keyword-found');
                        if (_data.keyWordColor) _data.$result.css({color: _data.keyWordColor});
                    }

                    _data.$result.html(text).show();

                    if (_data.finalTranscript) {
                        if (_data.timer) clearTimeout(_data.timer);

                        if (found) {
                            _data.$image.attr('src', _data.imageSent);
                            if (_data.textSentColor) _data.$result.css({color: _data.textSentColor});
                            _data.$result.addClass('mic-text-sent');
                            vis.setValue(_data.oid, _data.finalTranscript);
                        }

                        _data.finalTranscript = '';
                        _data.lastText = '';

                        setTimeout(function () {
                            _data.$image.attr('src', _data.imageActive);
                            _data.$result.css({color: _data.originalColor});
                            _data.$result.hide().removeClass('mic-keyword-found mic-text-sent');
                            _data.$text.html(_('info_speak_now')).show();
                        }, 1000);
                    } else {
                        _data.lastText = interimTranscript;

                        if (_data.timer) clearTimeout(_data.timer);
                        _data.timer = setTimeout(function () {
                            _data.timer = null;
                            _data.recognition.onend = null;
                            _data.recognition.stop();
                            _data.recognition = null;

                            var found = findKeyWord(_data.lastText);
                            if (found) {
                                _data.$image.attr('src', _data.imageSent);
                                if (_data.textSentColor) _data.$result.css({color: _data.textSentColor});
                                _data.$result.addClass('mic-text-sent');
                                vis.setValue(_data.oid, _data.finalTranscript);
                            }

                            _data.finalTranscript = '';
                            _data.lastText = '';

                            setTimeout(function () {
                                _data.$image.attr('src', _data.imageActive);
                                _data.$result.css({color: _data.originalColor});
                                _data.$result.hide().removeClass('mic-keyword-found mic-text-sent');
                                _data.$text.html(_('info_speak_now')).show();
                                startRecognition();
                            }, 1000);
                        }, 3000);
                    }
                };

                _data.recognition.lang     = _data.language;

                _data.recognition.start();
            }

            if (_data.speechMode === 'continuous') {
                if (!vis.editMode) {
                    startRecognition();
                } else {
                    $div.find('.mic-info-text').html(_('info_start'));
                }
            } else {
                $div.find('.mic-info-text').html(_('info_start'));
                if (!vis.editMode) {
                    $div.click(function () {
                        startRecognition();
                    });
                }
            }
        },
        getTimeInterval: function (oldTime, hoursToShow) {
            var result = '';

            var newTime = new Date ();

            if (!oldTime) return '';
            if (typeof oldTime === 'string') {
                oldTime = new Date(oldTime);
            } else {// 2000.01.01 00:00:00 = 946681200000
                if (typeof oldTime === 'number') oldTime = oldTime > 946681200000 ? new Date(oldTime) : new Date(oldTime * 1000);
            }

            var seconds = (newTime.getTime() - oldTime.getTime()) / 1000;

            if (hoursToShow && (seconds / 3600) > hoursToShow) return '';

            if (seconds < 60) {
                result = _('just&nbsp;now');
            } else
            if (seconds <= 3600)
                result = _('for&nbsp;%s&nbsp;min.', Math.floor (seconds / 60));
            else
            if (seconds <= 3600 * 24)
                result = _('for&nbsp;%s&nbsp;hr.&nbsp;and&nbsp;%s&nbsp;min.', Math.floor (seconds / 3600), (Math.floor (seconds / 60) % 60));
            else
            if (seconds > 3600 * 24 && seconds <= 3600 * 48)
                result = _('yesterday');
            else
            if (seconds > 3600*48) {
                result = _('for&nbsp;%s&nbsp;hours', Math.floor (seconds / 3600));
            }

            return result;
        },
        logout: function (el, data) {
            if (vis.editMode) return;
            var $el = $(el);
            $el.data('redirect', data.redirect_url);
            $el.data('app', data.in_app_close);

            $el.click(function () {
                if ($(this).data('app')) {
                    if (typeof logout === 'function') {
                        logout();
                    } else {
                        vis.showMessage(_('This option works only in APP'));
                    }
                } else if ($(this).data('redirect')) {
                    var redirect = $(this).data('redirect');
                    vis.conn.logout(function() {
                        window.location = redirect;
                    });
                } else {
                    vis.conn.logout(function(){
                        window.location.reload();
                    });
                }
            });
        },
        toggleFullScreen: function (wid, view, data, style) {
            var $div = $('#' + wid);

            var id = $div.attr('id');
            if (id && id.match(/_removed$/)) return;

            // if nothing found => wait
            if (!$div.length) {
                setTimeout(function () {
                    vis.binds.basic.toggleFullScreen(wid, view, data, style);
                }, 100);
                return;
            }

            var svgOn  = '<svg viewBox="0 0 24 24" style="display: inline-block; color: rgba(0, 0, 0, 0.87); fill: currentcolor; height: 24px; width: 24px; user-select: none; transition: all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"></path></svg>';
            var svgOff = '<svg viewBox="0 0 24 24" style="display: inline-block; color: rgba(0, 0, 0, 0.87); fill: currentcolor; height: 24px; width: 24px; user-select: none; transition: all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"></path></svg>';

            if (!vis.editMode) {
                $div.unbind('click').click(function () {
                    if (vis.binds.basic.isFullScreen) {
                        vis.binds.basic.isFullScreen = false;
                        if (document.exitFullscreen) {
                            document.exitFullscreen();
                        } else if (document.mozCancelFullScreen) {
                            document.mozCancelFullScreen();
                        } else if (document.webkitExitFullscreen) {
                            document.webkitExitFullscreen();
                        }
                        $('#' + wid).find('.vis-fullscreen-icon').html(svgOn);
                    } else {
                        vis.binds.basic.isFullScreen = true;
                        var element = $('#vis_container')[0];
                        if (element.requestFullscreen) {
                            element.requestFullscreen();
                        } else if (element.mozRequestFullScreen) {
                            element.mozRequestFullScreen();
                        } else if (element.webkitRequestFullscreen) {
                            element.webkitRequestFullscreen();
                        } else if (element.msRequestFullscreen) {
                            element.msRequestFullscreen();
                        }
                        $('#' + wid).find('.vis-fullscreen-icon').html(svgOff);
                    }
                });
            }

            $div.find('.vis-fullscreen-icon').html(svgOn);
        }
    };

    $(document).mouseup(function () {
        if (vis.binds.basic.pressed) {
            clearInterval(vis.binds.basic.pressed);
            vis.binds.basic.pressed = null;
        }
    });

    if (vis.editMode) {
        vis.binds.basic.onOrientation = function (widgetID, view, newId, attr, isCss) {
            var data  = vis.views[view].widgets[widgetID].data;
            var style = vis.views[view].widgets[widgetID].style;
            var h = parseInt(style.height, 10);
            var w = parseInt(style.width, 10);

            if (data[attr] === 'vertical') {
                if (h < w) {
                    var t = style.height;
                    style.height = style.width;
                    style.width = t;
                    setTimeout(function () {
                        vis.showWidgetHelper(widgetID, true);
                    }, 0);
                    return ['width', 'height'];
                }
            } else {
                if (w < h) {
                    var t = style.height;
                    style.height = style.width;
                    style.width = t;
                    setTimeout(function () {
                        vis.showWidgetHelper(widgetID, true);
                    }, 0);
                    return ['width', 'height'];
                }
            }
        };
        vis.binds.basic.onAttrChanged = function (widgetID, view, newId, attr, isCss) {
            if (vis.binds.basic.groupTimer) clearTimeout(vis.binds.basic.groupTimer);
            vis.binds.basic.groupTimer = setTimeout(function () {
                vis.inspectWidgets(vis.activeViewDiv, vis.activeView, this.activeWidgets);
            }, 2000);
        };
    }
</script>

<!-- Basic Widgets -->


<script id="tplHtml"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="static"
        data-vis-prev='<img src="widgets/basic/img/Prev_HTML.png"></img>'
        data-vis-prev1='<div id="prev_tplFrame" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 80px; height: 80px; border: 3px solid rgb(73, 185, 255); border-radius: 20px;"><div style="top: 30px; color: rgb(73, 185, 255); font-size: 20px; text-align: center; padding-top: 32px;">HTML</div></div>'
        data-vis-name="HTML"
        data-vis-attrs="html/text;refreshInterval[0]/slider,0,180000,100">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.basic.htmlRefresh(el, this.data.attr('html'), data.attr("refreshInterval")) %>>
            <%== this.data.attr('html') %>
        </div>
    </div>
</script>

<script id="tplShapes"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="static"
        data-vis-name="Svg shape"
        data-vis-prev='<div id="prev_tplShapes" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 90px; height: 90px; left: 502px; top: 174px; position: absolute;"> <div class="vis-widget-prev-body"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" style="display: block;width: 100%;height: 100%;fill: rgb(255, 255, 255);stroke: rgb(60, 152, 211); stroke-width: 4px;"> <circle cx="50" cy="50" r="47"></circle></svg></div> </div></div>'
        data-vis-attrs="svgType[circle]/select,line,triangle,square,pentagone,hexagone,octagone,circle,star,arrow;strokeColor[#009cb3]/color;fill[#00b3ac]/color;strokeWidth[5]/slider,0,100,1;rotate/slider,0,360,1;scaleWidth[1]/slider,0,1,0.1;scaleHeight[1]/slider,0,1,0.1">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 100px; height: 100px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="-50 -50 100 100" style="display: block;width:100%; height:100%;fill:<%== this.data.attr('fill') %>;stroke:<%== this.data.attr('strokeColor')%>;stroke-width: <%== this.data.attr('strokeWidth') %>">
                <%
                var svg = '';
                var rotate      = parseFloat(this.data.attr('rotate')) || 0;
                var scaleWidth  = parseFloat(this.data.attr('scaleWidth')) || 1;
                var scaleHeight = parseFloat(this.data.attr('scaleHeight')) || 1;
                var strokeWidth = parseInt(this.data.attr('strokeWidth'), 10) || 0;

                if (this.data.svgType === 'triangle') {
                    svg = '<polygon transform="rotate(' + rotate + ')  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="' + vis.binds.basic.circlePoints(50 - strokeWidth, 3) + '"/>';
                } else if (this.data.svgType === 'line') {
                    svg = '<line  vector-effect="non-scaling-stroke"  transform="rotate(' + rotate + ')" x1="-50" y1="0" x2="50" y2="0"/>';
                } else if (this.data.svgType === 'circle') {
                    svg = '<circle transform="scale(' + scaleWidth + ', ' + scaleHeight + ') rotate(' + rotate + ')" cx="0" cy="0" r="' + (50 - parseInt(strokeWidth, 10) / 2) + '" />';
                } else if (this.data.svgType === 'pentagone') {
                    svg = '<polygon transform="rotate(' + rotate + ')  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="' + vis.binds.basic.circlePoints(50 - strokeWidth, 5) + '"/>';
                } else if (this.data.svgType === 'square') {
                    svg = '<polygon transform="rotate(' + rotate + ')  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="' + vis.binds.basic.circlePoints(50 - strokeWidth, 4) + '"/>';
                } else if (this.data.svgType === 'hexagone') {
                    svg = '<polygon transform="rotate(' + rotate + ')  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="' + vis.binds.basic.circlePoints(50 - strokeWidth, 6) + '"/>';
                } else if (this.data.svgType === 'octagone') {
                    svg = '<polygon transform="rotate(' + rotate + ')  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="' + vis.binds.basic.circlePoints(50 - strokeWidth, 8) + '"/>';
                } else if (this.data.svgType === 'star') {
                    svg = '<polygon transform="rotate(' + rotate + ')  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="' + vis.binds.basic.circlePoints(50 - strokeWidth, 5, 144) + '"/>';
                } else if (this.data.svgType === 'arrow') {
                    var points = vis.binds.basic.circlePoints(50 - strokeWidth * 4, 3, true);
                    var text = '';
                    for (var p = 0; p < points.length; p++) {
                        text += points.x + ',' + points.y;
                        if (points.length === p - 2) {
                            text += '0,0';
                        }
                    }
                    svg = '<polygon transform="rotate(' + rotate + ') translate(0,10)  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="0, -50 -43.3, 25 0,0 43.3, 25"/>';
                }
                %>
                <%== svg %>
                </g>
            </svg>
        </div>
    </div>
</script>

<script id="tplIFrame"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="static"
        data-vis-prev='<img src="widgets/basic/img/Prev_iFrame.png"></img>'
        data-vis-name="iFrame"
        data-vis-attrs="src;refreshInterval[0]/slider,0,180000,100;noSandbox/checkbox;refreshOnWakeUp/checkbox;refreshOnViewChange/checkbox;refreshWithNoQuery/checkbox;scrollX/checkbox;scrollY/checkbox;seamless[true]/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top: 0; left: 0; width: 600px; height: 320px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <% if (vis.editMode) { %>
            <div class="editmode-helper" />
            <% } %>
            <iframe src="<%= this.data.attr('src') %>" <%= this.data.attr('noSandbox') ? '' : 'sandbox="allow-modals allow-forms allow-pointer-lock allow-popups allow-same-origin allow-scripts"' %> style="position: absolute; border: 0; padding: 0; margin: 0; width: 100%; height: 100%;<%= this.data.attr('scrollX') == true ? 'overflow-x: scroll;' : 'overflow-x: hidden;' %><%= this.data.attr('scrollY') == true ? 'overflow-y: scroll;' : 'overflow-y: hidden;' %>" <%= this.data.attr('seamless') == true ? 'seamless' : '' %>></iframe>
            <div <%= (el) -> vis.binds.basic.iframeRefresh(el, data, this.view) %>></div>
        </div>
    </div>
</script>

<script id="tplImage"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="static"
        data-vis-prev='<img src="widgets/basic/img/Prev_Image.png"></img>'
        data-vis-name="Image"
        data-vis-attrs="src/image;stretch/checkbox;refreshInterval[0]/slider,0,180000,100;"
        data-vis-attrs0="refreshOnWakeUp/checkbox;refreshOnViewChange/checkbox;refreshWithNoQuery/checkbox;allowUserInteractions/checkbox;">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <% if (vis.editMode) { %>
                <div class="editmode-helper" />
            <% } %>
            <img class="<%= this.data.attr('stretch') ? 'vis-image' : '' %> <%= this.data.attr('allowUserInteractions') ? '' : 'vis-no-user-select vis-no-pointer-events' %>" style="top:0; left: 0; position: absolute; width: 100%; <%= this.data.attr('stretch') ? 'height: 100%;' : '' %>" <%= this.data.attr('src') ? 'src="' + this.data.attr('src') + '"' : '' %> />
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, data, this.view) %> />
        </div>
    </div>
</script>

<script id="tplLink"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_tplLink.png"></img>'
        data-vis-set="basic"
        data-vis-type="static"
        data-vis-name="link"
        data-vis-attrs="html;href;target/auto,,_blank,_self,_parent,_top;alt">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px; " id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <a href="<%== this.data.attr('href') %>" target="<%== this.data.attr("target") %>" alt="<%== this.data.attr("alt") %>" style="text-decoration:none;width:100%;height:100%"><div style="width:100%;height:100%"><%== this.data.attr("html") %></div></a>
        </div>
    </div>
</script>

<script id="tplFrame"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplFrame" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 80px; height: 80px; border: 3px dashed rgb(60, 152, 211); border-radius: 20px;"><div style="top: 30px; color: rgb(60, 152, 211); font-size: 16px; text-align: center; padding-top: 31px;">BORDER</div></div>'
        data-vis-set="basic"
        data-vis-type="static"
        data-vis-name="Border"
        data-vis-attrs="title['Title'];title_font;title_color[black]/color;title_back/color;title_top[-10]/slider,-20,20,1;title_left[15]/slider,-20,30,1;header_height[0]/slider,0,100,1;header_color[black]/color">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible;width:50px;height:50px;border:1px solid #888" id="<%= this.data.attr('wid') %>" >
        <% if (this.data.attr('header_height')) { %>
	    <div style="width:100%;height:<%= this.data.attr('header_height') %>px;background-color:<%= this.data.attr('header_color') %>">
		<% } %>
        <div style="position: absolute;top:<%= this.data.attr('title_top') %>px;left:<%= this.data.attr('title_left') %>px;color:<%== this.data.attr('title_color') %>;background:<%== this.data.attr('title_back') %>;font:<%== this.data.attr('title_font') %>"><%== this.data.attr('title') %></div>
        <% if (this.data.attr('header_height')) { %>
        </div>
		<% } %>
    </div>
</script>

<script id="tplStatefulIFrame8"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_StatefulIFrame8.png"></img>'
        data-vis-type="stateful"
        data-vis-name="iFrame 8"
        data-vis-attrs="oid;refreshInterval[0]/slider,0,180000,100;count[1]/number;group.frames;src_(0-count);noSandbox/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0; left: 0; width: 600px; height: 320px;" id="<%= this.data.attr('wid') %>">
        <% if (vis.editMode) { %>
            <div class="editmode-helper"/>
        <% } %>
        <div class="vis-widget-body">
            <% if (vis.editMode) { %>
                <div class="editmode-helper"/>
            <% } %>
            <%
                var srcArr = [];
                var i = 0;
                while(data.attr('src_' + i) !== undefined) {
                    srcArr.push(data.attr('src_' + i));
                    i++;
                }
            %>
            <iframe class="vis-widget-element" <%= this.data.attr('noSandbox') ? '' : 'sandbox="allow-modals allow-forms allow-pointer-lock allow-popups allow-same-origin allow-scripts"' %> data-oid="<%= this.data.attr('oid') %>" src="<%== vis.binds.stateful.value(srcArr, data.attr('oid')) %>" style="position: absolute; border: 0; padding: 0; margin: 0; width: 100%; height: 100%;"></iframe>
            <div <%= (el) -> vis.binds.stateful.iframe(el, srcArr, data.attr('refreshInterval')) %> />
        </div>
    </div>
</script>

<!-- basic Container -->
<script id="tplContainerView"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ContainerView.png"></img>'
        data-vis-type="container"
        data-vis-name="view in widget"
        data-vis-attrs="contains_view/views">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:400px; height: 270px;" id="<%= this.data.attr('wid') %>">
        <% if (vis.editMode) { %>
            <div class="editmode-helper"></div>
        <% } %>
        <div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container">
        </div>
    </div>
</script>

<!-- Stateful Widgets -->
<script id="tplStatefulContainerView8"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_StatefulContainerView8.png"></img>'
        data-vis-type="stateful,container"
        data-vis-name="view in widget 8"
        data-vis-attrs="oid;persistent/checkbox;notIfInvisible/checkbox;count[1]/number;group.views;contains_view_(0-count)/views">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:400px; height: 270px;" id="<%= this.data.attr('wid') %>">
        <% if (vis.editMode) { %>
            <div class="editmode-helper" />
        <% } %>
        <%
            var viewArr = [];
            var i = 0;
            while (data.attr('contains_view_' + i) !== undefined) {
                viewArr.push(data.attr('contains_view_' + i));
                i++;
            }
        %>
        <div class="vis-widget-body">
            <div class="vis-view-container" data-oid="<%= data.attr('oid') %>" data-vis-contains="<%= vis.binds.stateful.value(viewArr, data.attr('oid')) %>" <%= (el) -> vis.binds.stateful.view(el, viewArr, data.attr('persistent'), data.attr('notIfInvisible')) %> />
        </div>
    </div>
</script>

<!-- TODO
<script type="text/ejs" id="tplStatefulIFrame8Persistent" class="vis-tpl" data-vis-set="basic" data-vis-name="stateful - iFrame 8 (persistent)" data-vis-attrs="oid;refreshInterval;src_(0-1)">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0; left: 0; width: 600px; height: 320px;" id="<%= this.data.attr('wid') %>">
            <% if (vis.editMode) { %>
                <div class="editmode-helper" />
            <% } %>
          <div class="vis-widget-body">
            <% if (vis.editMode) { %>
                <div class="editmode-helper" />
            <% } %>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_0') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_1') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_2') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_3') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_4') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_5') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_6') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_7') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <div <%= (el) -> vis.binds.stateful.iframe(el, [data.attr("src_0"), data.attr("src_1"), data.attr("src_2"), data.attr("src_3"), data.attr("src_4"), data.attr("src_5"), data.attr("src_6"), data.attr("src_7"]), data.attr("refreshInterval")) %> />
        </div>
    </div>
</script>
-->

<script id="tplStatefulImage8"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_StatefulImage.png"></img>'
        data-vis-type="stateful"
        data-vis-name="Image 8"
        data-vis-attrs="oid;refreshInterval[0]/slider,0,180000,100;count[1]/number;group.images;src_(0-count)/image">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px;" id="<%= this.data.attr('wid') %>">
        <% if (vis.editMode) { %>
            <div class="editmode-helper" />
        <% } %>
        <div class="vis-widget-body">
            <% if (vis.editMode) { %>
                <div class="editmode-helper" />
            <% } %>
            <%
                var srcArr = [];
                var i = 0;
                while(data.attr("src_" + i) !== undefined) {
                    srcArr.push(this.data.attr("src_" + i));
                    i++;
                }
            %>
            <img class="vis-widget-element" data-oid="<%= this.data.attr('oid') %>" style="position:absolute; width:100%;" src="<%== vis.binds.stateful.value(srcArr, this.data.attr('oid')) %>" />
            <div <%= (el) -> vis.binds.stateful.image(el, srcArr, data.attr('refreshInterval')) %> />
        </div>
    </div>
</script>

<script id="tplHtmlNav"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="static,navigation"
        data-vis-prev='<img src="widgets/basic/img/Prev_HTMLnavigation.png"></img>'
        data-vis-name="HTML navigation"
        data-vis-attrs="html;nav_view;sync/checkbox;body-background/color;group.effects;hide_effect/effect;hide_duration/slider,0,10000,100;hide_options/effect-options;show_effect/effect;show_duration/slider,0,10000,100;show_options/effect-options">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px; " id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.basic.navigation(el, {nav_view: data.attr('nav_view'), hideOptions: {effect: data.attr('hide_effect'), options: (data.attr('hide_options') ? data.attr('hide_options') : {}),duration:data.attr('hide_duration')}, showOptions: {effect:data.attr('show_effect'), options: (data.attr('show_options') ? data.attr('show_options') : {}), duration: data.attr('show_duration')}, sync: data.attr('sync'), background: data.attr('body-background')}) %>>
        <div class="vis-widget-body">
            <%== this.data.attr('html') %>
        </div>
    </div>
</script>

<script id="tplFilterDropdown"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_FilterDropdown.png"></img>'
        data-vis-set="basic"
        data-vis-type="filter"
        data-vis-name="filter - dropdown"
        data-vis-attrs="filters;group.effects;hide_effect/effect;hide_duration/slider,0,10000,100;show_effect/effect;show_duration/slider,0,10000,100;"
        data-vis-attrs0="autoFocus/checkbox;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0; left:0; width: 200px; height: 40px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.basic.filterDropdown(el, data.attr('filters'), data.attr('hide_effect'), data.attr('hide_duration'), data.attr('show_effect'), data.attr('show_duration')) %>>
        <div class="vis-widget-body">
            <select id="" name="" <%= this.data.attr('autoFocus') === true || this.data.attr('autoFocus') === 'true' ? 'autofocus' : '' %> >
                <option value=""><%= _('all') %></option>
            </select>
        </div>
    </div>
</script>

<script id="tplValueFloat"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueFloat.png"></img>'
        data-vis-name="Number"
        data-vis-attrs="oid;html_prepend;html_append_singular;html_append_plural;group.extended;digits;is_comma[true]/checkbox;is_tdp/checkbox;factor[1];oid-quality;class_true;class_false;test_html">
    <div class="vis-widget <%== (vis.states.attr(this.data['oid-quality'] + '.val') === 'true' ||  vis.states.attr(this.data['oid-quality'] + '.val') === true) ? this.data.attr('class_true') : this.data.attr('class_false') %> <%== this.data.attr('class') %>" style="top: 0; left: 0; width: 60px; height: 18px" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%= vis.binds.basic.formatFloat(this.data) %><%== (parseFloat(vis.binds.basic.formatFloat(this.data)) === 1 ? this.data.attr('html_append_singular') : this.data.attr('html_append_plural')) %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueString"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val"
        data-vis-name="String"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueString.png"></img>'
        data-vis-attrs="oid;html_prepend;html_append;test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0; left: 0; width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') ? ((this.data.attr('oid').indexOf('"') !== -1) ? '' : this.data.attr('oid')) : this.data.attr('oid') %>">
                <%== this.data.attr("html_prepend") %><%= (vis.editMode && this.data.attr('test_html')) ? this.data.attr('test_html') : this.data.attr('oid') ? ((this.data.attr('oid').indexOf('"') !== -1) ? this.data.oid.substring(1, this.data.oid.length - 1) : (vis.states.attr(this.data.oid + '.val'))) : (vis.states.attr(this.data.oid + '.val')) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueStringRaw"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueStringRaw.png"></img>'
        data-vis-name="String (unescaped)"
        data-vis-attrs="oid;html_prepend;html_append;test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0; left: 0; width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%== (vis.editMode && this.data.attr('test_html')) ? this.data.attr('test_html') : (typeof app !== 'undefined' ? app.replaceFilePathSrc(vis.states.attr(this.data.oid + '.val')) : vis.states.attr(this.data.oid + '.val')) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueStringImg"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueStringImg.png"></img>'
        data-vis-type="val"
        data-vis-name="String img src"
        data-vis-attrs="oid;html_prepend;html_append;refreshInterval[0]/slider,0,180000,100">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0; left:0; width:60px; height: 40px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %>
                <img src="<%= (typeof app !== 'undefined' ? app.replaceFilePathImg(vis.states.attr(this.data.oid + '.val')) : vis.states.attr(this.data.oid + '.val')) || '' %>" width="100%" />
                 <div <%= (el) -> vis.binds.basic.imgRefresh(el, vis.states.attr(data.oid + '.val' ), data, this.view) %> />
                <%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplTimeValue"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val,timestamp"
        data-vis-name="TimesValue"
        data-vis-prev='<img src="widgets/basic/img/Prev_TimeValue.png"></img>'
        data-vis-attrs="oid;show_interval/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY.MM.DD,DD.MM.YYYY,YYYY/MM/DD hh:mm:ss,YYYY/MM/DD,hh:mm:ss;html_prepend;html_append;test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top: 0; left: 0; width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%== (vis.editMode && this.data.attr('test_html')) ? this.data.attr('test_html') : vis.binds.basic.formatDate(vis.states.attr(this.data.oid + '.val'), this.data.attr('format_date'), this.data.attr('show_interval')) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueTimestampValue"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val,timestamp"
        data-vis-name="Timestamp Value"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueTimestamp.png"></img>'
        data-vis-attrs="oid;show_interval/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY.MM.DD,DD.MM.YYYY,YYYY/MM/DD hh:mm:ss,YYYY/MM/DD,hh:mm:ss;html_prepend;html_append;test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top: 0; left: 0; width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%== (vis.editMode && this.data.attr('test_html')) ? this.data.attr('test_html') : vis.binds.basic.formatDate(vis.states.attr(this.data.oid + '.val'), this.data.attr('format_date'), this.data.attr('show_interval')) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueTimestamp"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val,timestamp"
        data-vis-name="Timestamp"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueTimestamp.png"></img>'
        data-vis-attrs="oid;show_interval/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY.MM.DD,DD.MM.YYYY,YYYY/MM/DD hh:mm:ss,YYYY/MM/DD,hh:mm:ss;html_prepend;html_append;test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top: 0; left: 0; width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%== (vis.editMode && this.data.attr('test_html')) ? this.data.attr('test_html') : vis.binds.basic.formatDate(vis.states.attr(this.data.oid + '.ts'), this.data.attr('format_date'), this.data.attr('show_interval')) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueLastchange"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val,timestamp"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueLastchange.png"></img>'
        data-vis-name="Last change Timestamp"
        data-vis-attrs="oid;show_interval/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY.MM.DD,DD.MM.YYYY,YYYY/MM/DD hh:mm:ss,YYYY/MM/DD,hh:mm:ss;html_prepend;html_append;test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0; left: 0; width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%== (vis.editMode && this.data.attr('test_html')) ? this.data.attr('test_html') : vis.binds.basic.formatDate(vis.states.attr(this.data.oid + '.lc'), this.data.attr('format_date'), this.data.attr('show_interval')) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueList"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueList.png"></img>'
        data-vis-type="val"
        data-vis-name="ValueList Text"
        data-vis-attrs="oid;html_prepend;html_append;valuelist/text;test_list/nselect,,0,1,2,3,4,5,6,7,8,9,10,11,12">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0;left:0;width:60px;height:20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%= (function (that){var list = (that.data.valuelist ? that.data.valuelist.split(';') : []); var val = list[(vis.editMode && (that.data.attr('test_list') || that.data.attr('test_list') == '0')) ? parseInt(that.data.attr('test_list')) : parseInt(vis.states.attr(that.data.oid + '.val'), 10)]; if (val) val = val.replace('§§', ';'); return val;})(this) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueListHtml"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueListHtml.png"></img>'
        data-vis-type="val"
        data-vis-name="ValueList HTML"
        data-vis-attrs="oid;html_prepend;html_append;valuelist/text;test_list/nselect,,0,1,2,3,4,5,6,7,8,9,10,11,12">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0;left:0;width:60px;height:20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%== (function (that){var list = (that.data.valuelist ? that.data.valuelist.split(';') : []); var val = list[(vis.editMode && (that.data.attr('test_list') || that.data.attr('test_list') == '0')) ? parseInt(that.data.attr('test_list')) : parseInt(vis.states.attr(that.data.oid + '.val'), 10)]; if (val) val = val.replace('§§', ';'); return val;})(this) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueListHtml8"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueListHtml8.png"></img>'
        data-vis-type="val"
        data-vis-name="ValueList HTML Style"
        data-vis-attrs="oid;html_prepend;html_append;count[2]/number,0,10,1;value(0-count);style(0-count);test_list/nselect,,0,1,2,3,4,5,6,7,8,9,10,11,12">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 100px; height: 30px;" id="<%= this.data.attr('wid') %>">
        <%
            var slist = [];
            var i = 0;
            while (data['style' + i] !== undefined) {
                slist[i] = data['style' + i]; i++;
            }
        %>
        <div class="vis-widget-body" style="<%== slist[(vis.editMode && (this.data.attr('test_list') || this.data.attr('test_list') == '0')) ? parseInt(this.data.attr('test_list')) : (parseInt((vis.states.attr(this.data.oid + '.val') == true ? 1 : (vis.states.attr(this.data.oid + '.val') == false ? 0 : vis.states.attr(this.data.oid + '.val'))), 10))] %>">
            <div data-oid="<%= this.data.attr('oid') %>">
               <%== this.data.attr('html_prepend') %><%
                   var list = [];
                   var j = 0;
                   while (data['value' + j] !== undefined) {
                        list[j] = data['value' + j];
                        if (list[j]) list[j] = list[j].replace('§§', ';');
                        j++;
                   }
                   %><%== list[(vis.editMode && (this.data.attr('test_list') || this.data.attr('test_list') == '0')) ? parseInt(this.data.attr('test_list')) : (parseInt((vis.states.attr(this.data.oid + '.val') == true ? 1 : (vis.states.attr(this.data.oid + '.val') == false ? 0 : vis.states.attr(this.data.oid + '.val'))), 10))] %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueBool.png"></img>'
        data-vis-type="val"
        data-vis-name="Bool HTML"
        data-vis-attrs="oid;html_prepend;html_append;html_false;html_true">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:76px; height:76px;" id="<%= this.data.attr('wid') %>"  data-oid="<%= this.data.attr('oid') %>" >
        <div class="vis-widget-body">
            <%== this.data.attr('html_prepend') %>
            <% if (vis.binds.basic.isFalse(vis.states.attr(this.data.oid + '.val'), this.data.attr('min'), this.data.attr('max'))) { %>
                <%== this.data.attr("html_false") %>
            <% } else { %>
                <%== this.data.attr('html_true') %>
            <% } %>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplAckBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_AckBool.png"></img>'
        data-vis-type="val"
        data-vis-name="AckFlag HTML"
        data-vis-attrs="oid;html_prepend;html_append;html_false;html_true">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:76px; height:76px;" id="<%= this.data.attr('wid') %>"  data-oid="<%= this.data.attr('oid') %>" >
        <div class="vis-widget-body">
            <%== this.data.attr('html_prepend') %>
            <%
            var str = vis.states.attr(this.data.oid + ".ack");
            var val = parseFloat(str);
            var state;
            if (str === false || str === "false" || val == 0) {
            %>
            <%== this.data.attr('html_false') %>
            <% } else { %>
            <%== this.data.attr('html_true') %>
            <% } %>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplValueBoolCheckbox"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueBoolCheckbox.png"></img>'
        data-vis-set="basic"
        data-vis-type="ctrl"
        data-vis-name="Bool Checkbox"
        data-vis-attrs="oid;html_prepend;html_append;"
        data-vis-attrs0="autoFocus/checkbox;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="" id="<%= this.data.attr('wid') %>" >
        <div class="vis-widget-body">
			<%== this.data.attr('html_prepend') %>
			<input
			    type="checkbox"
			    name="<%= this.data.attr('wid') %>_checkbox"
			    <%= this.data.attr('autoFocus') === true || this.data.attr('autoFocus') === 'true' ? 'autofocus' : '' %>
			    id="<%= this.data.attr('wid') %>_checkbox"
			    data-oid="<%= this.data.attr('oid') %>"
			    <%= (el) -> vis.binds.basic.checkbox(el) %>
            />
			<%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplValueInput"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueInput.png"></img>'
        data-vis-type="ctrl"
        data-vis-update-style="true"
        data-vis-name="Input val"
        data-vis-attrs="oid;html_prepend;html_append;numeric/checkbox;min;max;autoSet/checkbox;readOnly/checkbox;"
        data-vis-attrs0="autoFocus/checkbox;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="background: white; color: black; border: 2px inset" id="<%= this.data.attr('wid') %>" >
        <div class="vis-widget-body">
			<%== this.data.attr('html_prepend') %>
			<input type="text"
			    <%= (this.data.attr('readOnly') === true || this.data.attr('readOnly') === 'true') ? 'readonly ' : '' %>
			    <%= this.data.attr('autoFocus') === true || this.data.attr('autoFocus') === 'true' ? 'autofocus ' : '' %>
			    data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.input(el, this.data) %> style="width: calc(100% - 5px);"
            />
			<%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplValueBoolSelect"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueBoolSelect.png"></img>'
        data-vis-type="ctrl"
        data-vis-name="Bool Select"
        data-vis-attrs="oid;html_prepend;html_append;text_true;text_false;"
        data-vis-attrs0="autoFocus/checkbox;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:false" id="<%= this.data.attr('wid') %>" >
        <div class="vis-widget-body"  style="overflow:false">
			<%== this.data.attr('html_prepend') %>
			<select id="<%= this.data.attr('wid') %>_select" data-oid="<%= this.data.attr('oid') %>" <%= this.data.attr('autoFocus') === true || this.data.attr('autoFocus') === 'true' ? 'autofocus' : '' %> >
				<option value="0" selected='selected'><%= this.data.attr('text_false') %></option>
				<option value="1"><%= this.data.attr('text_true') %></option>
			</select>
			<div <%= (el) -> vis.binds.basic.select(el) %>></div>
			<%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplValueBoolCtrl"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueBoolCtrl.png"></img>'
        data-vis-type="ctrl"
        data-vis-name="Bool HTML"
        data-vis-attrs="oid;min;max;html_prepend;html_append;html_false;html_true;"
        data-vis-attrs1="group.ccontrol;urlTrue;urlFalse;oidTrue/id;oidFalse/id;">
    <div
        class="vis-widget <%== this.data.attr('class') %>"
        style="width:76px; height:76px;"
        id="<%= this.data.attr('wid') %>"
        data-oid="<%= this.data.attr('oid') %>"
        data-min="<%= this.data.attr('min') %>"
        data-max="<%= this.data.attr('max') %>"
        data-as-button="<%= this.data.attr('asButton') %>"
        data-url-true="<%=  this.data.attr('urlTrue') %>"
        data-url-false="<%= this.data.attr('urlFalse') %>"
        data-oid-true="<%=  this.data.attr('oidTrue') %>"
        data-oid-false="<%= this.data.attr('oidFalse') %>"
        <%= (el) -> vis.binds.basic.toggle(el) %>>
        <div class="vis-widget-body">
			<%== this.data.attr('html_prepend') %>
			<% if (vis.binds.basic.isFalse(vis.states.attr(this.data.oid + '.val'), this.data.attr('min'), this.data.attr('max'))) { %>
			    <%== this.data.attr('html_false') %>
			<% } else { %>
			    <%== this.data.attr('html_true') %>
			<% } %>
			<%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplValueBoolCtrlSvg"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueBoolCtrlSvg.png"></img>'
        data-vis-type="ctrl,state"
        data-vis-name="Bool SVG"
        data-vis-attrs="oid;no_control/checkbox;"
        data-vis-attrs0="svg_false[<polygon points='100,10 40,198 190,78 10,78 160,198' style='fill:lime§ stroke:purple§ stroke-width:5§ fill-rule:nonzero' transform='scale(0.4)'/>]/text;"
        data-vis-attrs1="svg_true[<polygon points='100,10 40,198 190,78 10,78 160,198' style='fill:yellow§ stroke:red§ stroke-width:5§ fill-rule:nonzero' transform='scale(0.4)'/>]/text;"
        data-vis-attrs2="svg_opacity/slider,0,1,0.05">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:76px; height:76px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>">
        <div class="vis-widget-body">
            <% vis.binds.basic.showSvg(this.data.attr('class'), this.view, this.data.attr('wid'), this.data.attr('oid'), this.data.attr('svg_opacity'), this.data.attr('svg_false'), this.data.attr('svg_true'), null, this.data.attr('no_control')) %>
        </div>
    </div>
</script>

<script id="tplBasicState"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_BasicState.png"></img>'
        data-vis-set="basic"
        data-vis-type="ctrl"
        data-vis-name="HTML State"
        data-vis-attrs="oid;html;value;urlValue">
    <div
        class="vis-widget <%== this.data.attr('class') %>"
        style="width:76px; height:76px;"
        id="<%= this.data.attr('wid') %>"
        data-oid="<%= this.data.attr('oid') %>"
        data-url-value="<%= this.data.attr('urlValue') %>"
        data-val="<%= this.data.attr('value') %>"
        <%= (el) -> vis.binds.basic.state(el) %>
        >
        <div class="vis-widget-body">
			<%== this.data.attr("html") %>
        </div>
    </div>
</script>

<script id="tplRedNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val"
        data-vis-name="Red Number"
        data-vis-prev='<img src="widgets/basic/img/Prev_RedNumber.png"></img>'
        data-vis-attrs="oid;type[circle]/select,circle,pin;html_prepend;html_append_singular;html_append_plural">
    <% if (this.data.attr('type') === 'pin') { %>
        <div class="vis-widget <%== this.data.attr('class') %>" style="width: 33px; height: 61px; padding-left: 4px" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.hideOnFalse(el) %>>
            <div class="vis-widget-body" >
                <img src="widgets/basic/img/pin_red5.svg" style="width: 100%; height: 100%">
                <div style="position:absolute; top: 22%; width: 95%; text-align: center">
                    <%== this.data.attr('html_prepend') %><%= parseInt(vis.states.attr(this.data.oid + '.val'), 10) %><%== (parseInt(vis.states.attr(this.data.oid + '.val'), 10) === 1 ? this.data.attr("html_append_singular") : this.data.attr("html_append_plural")) %>
                </div>
            </div>
        </div>
    <% } else { %>
        <div class="vis-widget <%== this.data.attr('class') %>" style="padding: 3px; width: auto; min-width: 21px; height: 21px; border-radius:16px; border: 3px solid white; background-color: rgb(214, 69, 69); color:white; font:normal normal normal 20px/normal Helvetica; text-align: center;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.hideOnFalse(el) %>>
            <div class="vis-widget-body" >
                <%== this.data.attr('html_prepend') %><%= parseInt(vis.states.attr(this.data.oid + '.val'), 10) %><%== (parseInt(vis.states.attr(this.data.oid + '.val'), 10) === 1 ? this.data.attr("html_append_singular") : this.data.attr("html_append_plural")) %>
            </div>
        </div>
    <% } %>
</script>

<script id="tplBulbOnOffCtrl"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_BulbOnOffCtrl.png"></img>'
        data-vis-set="basic"
        data-vis-type="ctrl"
        data-vis-name="Bulb on/off"
        data-vis-attrs="oid;min;max;icon_off[img~bulb_off.png]/image;icon_on[img~bulb_on.png]/image;readOnly/checkbox;"
        data-vis-attrs0="group.ccontrol;urlTrue;urlFalse;oidTrue/id;oidFalse/id;oidTrueValue;oidFalseValue;"
>
    <div
        data-oid="<%= this.data.attr('oid') %>"
        class="vis-widget <%== this.data.attr('class') %>"
        id="<%= this.data.attr('wid') %>"
        style="width: 44px; height: 59px"
        data-read-only="<%=  this.data.attr('readOnly') %>"
        data-min="<%= this.data.attr('min') %>"
        data-max="<%= this.data.attr('max') %>"
        data-url-true="<%=  this.data.attr('urlTrue') %>"
        data-url-false="<%= this.data.attr('urlFalse') %>"
        data-oid-true="<%=  this.data.attr('oidTrue') %>"
        data-oid-false="<%= this.data.attr('oidFalse') %>"
        data-oid-true-value="<%=  this.data.attr('oidTrueValue') %>"
        data-oid-false-value="<%= this.data.attr('oidFalseValue') %>"
        <%= (el) -> vis.binds.basic.toggle(el) %>
        >
        <div class="vis-widget-body">
            <% if (vis.binds.basic.isFalse(vis.states.attr(this.data.oid + '.val'), this.data.attr('min'), this.data.attr('max'))) { %>
                <img src="<%== this.data.attr('icon_off') ? this.data.attr('icon_off') : 'img/bulb_off.png' %>" width="100%"/>
            <% } else { %>
                <img src="<%== this.data.attr('icon_on') ? this.data.attr('icon_on') : 'img/icon_on.png' %>" width="100%"/>
            <% } %>
        </div>
    </div>
</script>

<script id="tplValueFloatBar"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val,bar"
        data-vis-name="Bar"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueFloatBar.png"></img>'
        data-vis-attrs="oid;min[0];max[100];orientation[horizontal]/select,horizontal,vertical/onOrientation;color[blue]/color;border;shadow;reverse/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 240px; height: 20px; border: 1px solid #888" id="<%= this.data.attr('wid') %>">
        <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget-body"
        style="<%= (this.data.attr('orientation') === 'vertical') ? ('height: ' + vis.binds.basic.getCalc(this.data) + ';' + ((this.data.border) ? ' width:  calc(100% - ' + vis.binds.basic.extractWidth(this.data.border, 2) + ');' : '') + (this.data.reverse === 'true' || this.data.reverse === true ? 'left: 0; position: absolute; bottom: 0%;' : '')) : (((this.data.border) ? " height: calc(100% - " + vis.binds.basic.extractWidth(this.data.border, 2) + ');' : '') + 'width: ' + vis.binds.basic.getCalc(this.data) + ';' + (this.data.reverse === 'true' || this.data.reverse === true ? 'float: right; ' : '')) %>background-color:<%= this.data.color %>; border: <%= this.data.border %>; box-shadow: <%= this.data.shadow %>"></div>
    </div>
</script>

<script id="tplNote"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val"
        data-vis-name="Note"
        data-vis-prev='<img src="widgets/basic/img/Prev_Note.png"></img>'
        data-vis-attrs="oid;max_width[300];html_prepend;html_append;test_text">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:50px; height:50px; border:1px solid #888; background: rgba(255,255,105,0.8)" id="<%= this.data.attr('wid') %>" onclick="vis.binds.basic.editNote('<%= this.data.attr('wid') %>', '<%= this.data.attr('max_width') %>', '<%= this.data.attr('min_width') %>', '<%= this.data.attr('min_height') %>', '<%= this.data.attr('oid') %>')">
		<div data-oid="<%= this.data.attr('oid') %>" id="div_<%= this.data.attr('wid') %>" style="padding: 10px">
			<%== this.data.attr('html_prepend') %><%= (this.data.test_text && vis.editMode) ? this.data.test_text : (vis.states.attr(this.data.oid + '.val') == null ? "" : vis.states.attr(this.data.oid + '.val')) %><%== this.data.attr('html_append') %>
		</div>
    </div>
</script>

<script id="tplTableBody"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="json,table"
        data-vis-name="Table"
        data-vis-prev='<img src="widgets/basic/img/Prev_TableBody.png"></img>'
        data-vis-attrs="table_oid/id;"
        data-vis-attrs0="static_value[[{^Title^: ^first^, ^Value^: 1, ^_Description^: ^Value1^}, {^Title^: ^second^, ^Value^: 2, ^_Description^: ^Value2^}]]/text;"
        data-vis-attrs1="event_oid/id;new_on_top/checkbox;ack_oid/id;selected_oid/id;hide_header/checkbox;show_scroll/checkbox;detailed_wid/widget;max_rows/number;"
        data-vis-attrs2="colCount/number;group.header/byindex;colName(1-colCount);colWidth(1-colCount);colAttr(1-colCount);"
        data-vis-attrs-not-used="btn_print;view_for_print/views"
>
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width: 300px; height: 150px; background: #d3d3d3">
       <% vis.binds.table.showTable(this.view, this.data.attr('wid'), this.data); %>
    </div>
</script>

<script id="tplHtmlLogout"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="tools"
        data-vis-prev='<img src="widgets/basic/img/Prev_HtmlLogout.png"></img>'
        data-vis-name="HTML logout"
        data-vis-attrs="html[<button style=^cursor: pointer^>Logout</button>]/text;redirect_url;in_app_close/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 70px; height: 30px; cursor: pointer" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.basic.logout(el, this.data) %> >
        <div class="vis-widget-body">
            <%== this.data.attr('html') %>
        </div>
    </div>
</script>

<!--script id="tplDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="table"
        data-vis-name="Dialog"
        data-vis-attrs="show/checkbox;trigger_id/id;button(1-3);title;text;image/image;width[400]/slider,50,1000,10;height[200]/slider,50,1000,10;modal/checkbox;_no_style[true]/hidden;_no_move[true]/hidden;_no_resize[true]/hidden;margin_left[0]/slider,0,200,1;margin_top[0]/slider,0,200,1"
        >
    <%
        var options =  {
            trigger_id:  this.data.attr('trigger_id'),
            buttons:     [this.data.attr('button1'), this.data.attr('button2'), this.data.attr('button3')],
            image:       this.data.attr('image'),
            title:       this.data.attr('title'),
            text:        this.data.attr('text'),
            width:       this.data.attr('width'),
            height:      this.data.attr('height'),
            show:        this.data.attr('show'),
            modal:       this.data.attr('modal'),
            margin_left: this.data.attr('margin_left'),
            margin_top:  this.data.attr('margin_top')
        };
        vis.binds.table.showDialog(this.view, this.data.attr('wid'), options);
    %>
</script-->

<script id="tplValueGesture"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val,tools"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueGesture.png"></img>'
        data-vis-name="Gesture indicator"
        data-vis-no-gestures="true"
        data-vis-attrs="html_prepend;html_append_singular;html_append_plural;group.extended;digits[0];is_comma[true]/checkbox;is_tdp/checkbox;factor[1];test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="height: 21px; border: 1px solid #c7c7c7; border-radius: 5px; text-align: center; padding-top: 6px; box-shadow: 2px 2px 5px 1px gray; padding-left: 2px; padding-right: 2px; background: lightgray;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <% vis.binds.basic.createValueGesture(this.data.wid, this.view, this.data, this.style); %>
        </div>
    </div>
</script>

<script id="tplSpeech2Text"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val"
        data-vis-prev='<img src="widgets/basic/img/Prev_Speech2Text.png"></img>'
        data-vis-name="Speech to text"
        data-vis-no-gestures="true"
        data-vis-attrs="oid;speechMode[single]/select,single,startstop,continuous;language/select,,en-US,de,ru-RU;keywords;"
        data-vis-attrs0="group.image;noImage/checkbox;imageInactive[widgets~basic~img~micInactive.svg]/image;imageActive[widgets~basic~img~micActive.svg]/image;imageStarted[widgets~basic~img~micStarted.svg]/image;imageDetected[widgets~basic~img~micDetected.svg]/image;imageSent[widgets~basic~img~micSent.svg]/image;imageHeightPx[70]/slider,0,200,1;imageWidthPx[70]/slider,0,200,1;"
        data-vis-attrs1="group.text;noText/checkbox;noResults/checkbox;keyWordColor[#FFB051]/color;textSentColor[#7E88D3]/color;">
    <div class="vis-widget <%== this.data.attr('class') %>" style="height: 77px; width: 500px" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <table style="height: 100%; width: 100%"><tr>
                <td style="<%= this.data.attr('noImage') ? 'display: none' : '' %>"><img class="mic-image" style="height: <%= this.data.attr('imageHeightPx') %>px; width: <%= this.data.attr('imageWidthPx') %>px" src="<%= this.data.attr('imageInactive') %>" /></td>
                <td class="mic-text" style="width: 100%">
                    <div class="mic-info-text" style="<%= this.data.attr('noText')    ? 'display: none' : '' %>"></div>
                    <div class="mic-results"   style="<%= this.data.attr('noResults') ? 'display: none' : '' %>"></div>
                </td>
            </tr></table>
        </div>
    </div>
    <% vis.binds.basic.speech2text(this.data.wid, this.view, this.data, this.style); %>
</script>

<script id="tplFullScreen"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_FullScreen.png"></img>'
        data-vis-set="basic"
        data-vis-type="tools"
        data-vis-name="Full Screen"
        data-vis-attrs="">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:43px; height:43px; background: #AAAAAA; cursor: pointer; opacity: 0.9" id="<%= this.data.attr('wid') %>">
		<div class='vis-fullscreen-icon' style="padding: 10px"></div>
		<%= vis.binds.basic.toggleFullScreen(this.data.wid, this.view, this.data, this.style); %>
    </div>
</script>

<script id="tplScreenResolution"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_ScreenResolution.png"></img>'
        data-vis-set="basic"
        data-vis-type="tools"
        data-vis-name="Screen Resolution"
        data-vis-attrs="">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:170px; height:75px; border: 1px solid #888; font-size: 12px; opacity: 0.8" id="<%= this.data.attr('wid') %>">
		<div id="div_<%= this.data.attr('wid') %>" style="padding: 10px">
			Default view: <span class='vis-resolution-default-view'></span><br>
			Width: <span class='vis-resolution-width'></span><br>
			Height: <span class='vis-resolution-height'></span><br>
			Instance: <span><%== vis.instance ? vis.instance : vis.binds.basic.createScreenText() %></span>
		</div>
		<%= vis.binds.basic.detectScreen(this.data.attr('wid')) %>
    </div>
</script>


<script id="_tplGroup"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-attrs="attrCount[1]/slider,0,20,1;group.objects;attrName(1-attrCount)//onAttrChanged;attrType(1-attrCount)/select,,id,checkbox,image,color,views,html,widget,history/onAttrChanged;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow: visible" id="<%= this.data.attr('wid') %>"></div>
</script>

<!-- --------------basic.html--- END -->
<!-- --------------consumption.html--- START -->
<!--
    ioBroker.consumption

    version: "0.4.18"

    Copyright 2020 bluefox <dogafox@gmail.com>
-->
<link rel="stylesheet" type="text/css" href="widgets/consumption/css/styles.css" />

<script type="text/javascript">

    /*var vis = {
        editMode: false,
        binds: {},
        conn: {
            getStates: function () {}
        },
        unregisterOnChange: function () {}
    };
    function _(a) {return a; }
    function $(item) { return item; }*/

    $.extend(true, systemDictionary, {
        "%s overview": {
            "en": "%s overview",
            "de": "%s Übersicht",
            "ru": "%s обзор",
            "pt": "Visão geral do %s",
            "nl": "Overzicht van %s",
            "fr": "Présentation de %s",
            "it": "Panoramica di %s",
            "es": "Resumen de %s",
            "pl": "Przegląd %s",
            "zh-cn": "％s概述"
        },
        "Actual": {
            "en": "Actual",
            "de": "Tatsächlich",
            "ru": "Этот год",
            "pt": "Real",
            "nl": "Eigenlijk",
            "fr": "Réel",
            "it": "Effettivo",
            "es": "Real",
            "pl": "Rzeczywisty",
            "zh-cn": "实际"
        },
        "All": {
            "en": "All",
            "de": "Alle",
            "ru": "Все",
            "pt": "Tudo",
            "nl": "Allemaal",
            "fr": "Tout",
            "it": "Tutti",
            "es": "Todos",
            "pl": "Wszystko",
            "zh-cn": "所有"
        },
        "Costs for %s": {
            "en": "Costs for %s",
            "de": "Kosten für %s",
            "ru": "Затраты на %s",
            "pt": "Custos para %s",
            "nl": "Kosten voor %s",
            "fr": "Coûts pour %s",
            "it": "Costi per %s",
            "es": "Costos para %s",
            "pl": "Koszty dla %s",
            "zh-cn": "％s的费用"
        },
        "Forecast": {
            "en": "Forecast",
            "de": "Prognose",
            "ru": "Прогноз",
            "pt": "Previsão",
            "nl": "Voorspelling",
            "fr": "Prévoir",
            "it": "previsione",
            "es": "Pronóstico",
            "pl": "Prognoza",
            "zh-cn": "预测"
        },
        "Heat map": {
            "en": "Heat map",
            "de": "Wärmekarte",
            "ru": "Тепловая карта",
            "pt": "Mapa de calor",
            "nl": "Heat map",
            "fr": "Carte de chaleur",
            "it": "Mappa di calore",
            "es": "Mapa de calor",
            "pl": "Mapa ciepła",
            "zh-cn": "热图"
        },
        "Name": {
            "en": "Name",
            "de": "Name",
            "ru": "Имя",
            "pt": "Nome",
            "nl": "Naam",
            "fr": "Nom",
            "it": "Nome",
            "es": "Nombre",
            "pl": "Imię",
            "zh-cn": "名称"
        },
        "Now %s": {
            "en": "Now %s",
            "de": "Jetzt %s",
            "ru": "Сейчас %s",
            "pt": "Agora %s",
            "nl": "Nu %s",
            "fr": "Maintenant %s",
            "it": "Ora %s",
            "es": "Ahora %s",
            "pl": "Teraz %s",
            "zh-cn": "现在％s"
        },
        "Pie chart": {
            "en": "Pie chart",
            "de": "Kuchendiagramm",
            "ru": "Круговая диаграмма",
            "pt": "Gráfico de pizza",
            "nl": "Cirkeldiagram",
            "fr": "Diagramme circulaire",
            "it": "Grafico a torta",
            "es": "Gráfico circular",
            "pl": "Wykres kołowy",
            "zh-cn": "饼形图"
        },
        "Planned": {
            "en": "Planned",
            "de": "Geplant",
            "ru": "Запланированные",
            "pt": "Planejado",
            "nl": "Gepland",
            "fr": "Prévu",
            "it": "Planned",
            "es": "Planificado",
            "pl": "Zaplanowany",
            "zh-cn": "计划"
        },
        "Planning": {
            "en": "Planning",
            "de": "Planung",
            "ru": "Запланировано",
            "pt": "Planejamento",
            "nl": "Planning",
            "fr": "Planification",
            "it": "Pianificazione",
            "es": "Planificación",
            "pl": "Planowanie",
            "zh-cn": "规划"
        },
        "Reference": {
            "en": "Reference",
            "de": "Referenz",
            "ru": "Сравнение",
            "pt": "Referência",
            "nl": "Referentie",
            "fr": "Référence",
            "it": "Riferimento",
            "es": "Referencia",
            "pl": "Odniesienie",
            "zh-cn": "参考"
        },
        "Stack bar": {
            "en": "Stack bar",
            "de": "Stapelleiste",
            "ru": "Stack bar",
            "pt": "Barra de empilhamento",
            "nl": "Stapelbalk",
            "fr": "Barre de pile",
            "it": "Stack bar",
            "es": "Barra de pila",
            "pl": "Pasek stosu",
            "zh-cn": "堆叠栏"
        },
        "Table": {
            "en": "Table",
            "de": "Tabelle",
            "ru": "Таблица",
            "pt": "Tabela",
            "nl": "Tafel",
            "fr": "Table",
            "it": "tavolo",
            "es": "Mesa",
            "pl": "Stół",
            "zh-cn": "表"
        },
        "Total": {
            "en": "Total",
            "de": "Gesamt",
            "ru": "Итого",
            "pt": "Total",
            "nl": "Totaal",
            "fr": "Total",
            "it": "Totale",
            "es": "Total",
            "pl": "Całkowity",
            "zh-cn": "总"
        },
        "from": {
            "en": "from",
            "de": "von",
            "ru": "от",
            "pt": "de",
            "nl": "van",
            "fr": "de",
            "it": "a partire dal",
            "es": "desde",
            "pl": "od",
            "zh-cn": "从"
        },
        "rendering...": {
            "en": "rendering...",
            "de": "Rendern...",
            "ru": "рендеринг...",
            "pt": "Renderização...",
            "nl": "renderen...",
            "fr": "le rendu...",
            "it": "il rendering ...",
            "es": "representación...",
            "pl": "wykonanie...",
            "zh-cn": "渲染..."
        },
        "to": {
            "en": "to",
            "de": "bis",
            "ru": "до",
            "pt": "para",
            "nl": "naar",
            "fr": "à",
            "it": "per",
            "es": "a",
            "pl": "do",
            "zh-cn": "至"
        },
        "Total overview": {
            "en": "Total overview",
            "de": "Gesamtübersicht",
            "ru": "Общий обзор",
            "pt": "Visão geral total",
            "nl": "Totaal overzicht",
            "fr": "Vue d'ensemble",
            "it": "Panoramica totale",
            "es": "Resumen total",
            "pl": "Ogólny przegląd",
            "zh-cn": "总概述"
        }
    });

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            "consInstance": {
                "en": "Instance",
                "de": "Instanz",
                "ru": "Инстанция",
                "pt": "Instância",
                "nl": "Voorbeeld",
                "fr": "Exemple",
                "it": "Esempio",
                "es": "Ejemplo",
                "pl": "Instancja",
                "zh-cn": "实例"
            },
            "colorTheme": {
                "en": "Theme",
                "de": "Thema",
                "ru": "Тема",
                "pt": "Tema",
                "nl": "Thema",
                "fr": "Thème",
                "it": "Tema",
                "es": "Tema",
                "pl": "Motyw",
                "zh-cn": "主题"
            },
            "startsFrom": {
                "en": "Data start from",
                "de": "Daten beginnen ab",
                "ru": "Данные начинаются с",
                "pt": "Os dados começam em",
                "nl": "Gegevens beginnen vanaf",
                "fr": "Les données commencent à partir de",
                "it": "I dati iniziano da",
                "es": "Los datos comienzan desde",
                "pl": "Dane zaczynają się od",
                "zh-cn": "数据从"
            },
            "startsFrom_tooltip": {
                "en": "In form 2020-01 or 2020-01-01",
                "de": "In Form 2020-01 oder 2020-01-01",
                "ru": "По форме 2020-01 или 2020-01-01",
                "pt": "No formulário 2020-01 ou 2020-01-01",
                "nl": "In vorm 2020-01 of 2020-01-01",
                "fr": "Sous forme 2020-01 ou 2020-01-01",
                "it": "Nel modulo 2020-01 o 2020-01-01",
                "es": "En forma 2020-01 o 2020-01-01",
                "pl": "W formie 2020-01 lub 2020-01-01",
                "zh-cn": "格式为2020-01或2020-01-01"
            },
            "consumption_station": {
                "en": "Consumption station",
                "de": "Verbrauchsstation",
                "ru": "Станция потребления",
                "pt": "Estação de consumo",
                "nl": "Verbruiksstation",
                "fr": "Station de consommation",
                "it": "Stazione di consumo",
                "es": "Estación de consumo",
                "pl": "Stacja zużycia",
                "zh-cn": "消费站"
            },
            "group_consumption_types": {
                "en": "Hide chart types",
                "de": "Diagrammtypen ausblenden",
                "ru": "Скрыть типы диаграмм",
                "pt": "Ocultar tipos de gráfico",
                "nl": "Verberg diagramtypen",
                "fr": "Masquer les types de graphiques",
                "it": "Nascondi i tipi di grafico",
                "es": "Ocultar tipos de gráficos",
                "pl": "Ukryj typy wykresów",
                "zh-cn": "隐藏图表类型"
            },
            "hide_planning": {
                "en": "Planning",
                "de": "Planung",
                "ru": "Планирование",
                "pt": "Ocultar planejamento",
                "nl": "Verberg planning",
                "fr": "Masquer la planification",
                "it": "Nascondi pianificazione",
                "es": "Ocultar planificación",
                "pl": "Ukryj planowanie",
                "zh-cn": "隐藏计划"
            },
            "hide_pie": {
                "en": "Pie-Chart",
                "de": "Kuchendiagramm",
                "ru": "Круговая диаграмма",
                "pt": "Esconder torta",
                "nl": "Verberg taart",
                "fr": "Masquer la tarte",
                "it": "Nascondi torta",
                "es": "Ocultar pastel",
                "pl": "Ukryj ciasto",
                "zh-cn": "隐藏馅饼"
            },
            "hide_stackbar": {
                "en": "Stack bar",
                "de": "Stack bar",
                "ru": "Stack bar",
                "pt": "Ocultar barra de pilha",
                "nl": "Verberg stapelbalk",
                "fr": "Masquer la barre de pile",
                "it": "Nascondi barra dello stack",
                "es": "Ocultar barra de pila",
                "pl": "Ukryj pasek stosu",
                "zh-cn": "隐藏堆栈栏"
            },
            "hide_heatmap": {
                "en": "Heat map",
                "de": "Heatmap",
                "ru": "Тепловая карта",
                "pt": "Ocultar mapa de calor",
                "nl": "Hittekaart verbergen",
                "fr": "Masquer la carte de chaleur",
                "it": "Nascondi mappa termica",
                "es": "Ocultar mapa de calor",
                "pl": "Ukryj mapę cieplną",
                "zh-cn": "隐藏热图"
            },
            "hide_table": {
                "en": "Table",
                "de": "Tabelle",
                "ru": "Таблица",
                "pt": "Ocultar mesa",
                "nl": "Tafel verbergen",
                "fr": "Masquer le tableau",
                "it": "Nascondi tabella",
                "es": "Ocultar tabla",
                "pl": "Ukryj tabelę",
                "zh-cn": "隐藏表格"
            },
            "show_heatmap_range": {
                "en": "Show heat map range",
                "de": "Wärmekartenbereich anzeigen",
                "ru": "Показать диапазон тепловой карты",
                "pt": "Mostrar alcance do mapa de calor",
                "nl": "Toon warmtekaartbereik",
                "fr": "Afficher la plage de la carte thermique",
                "it": "Mostra l'intervallo della mappa termica",
                "es": "Mostrar rango de mapa de calor",
                "pl": "Pokaż zakres mapy cieplnej",
                "zh-cn": "显示热图范围"
            },
            "currency": {
                "en": "currency",
                "de": "Währung",
                "ru": "валюта",
                "pt": "moeda",
                "nl": "valuta",
                "fr": "devise",
                "it": "moneta",
                "es": "moneda",
                "pl": "waluta",
                "zh-cn": "货币"
            }
        });
    }

    vis.binds.consumption = {
        version: "0.4.18",
        showVersion: function () {
            if (vis.binds.consumption.version) {
                console.log('Version consumption: ' + vis.binds.consumption.version);
                vis.binds.consumption.version = null;
            }
        },
        months: {
            en: ['Jan', 'Feb', 'Mar', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            de: ['Jan', 'Feb', 'Mar', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'],
            ru: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек']
        },
        instancePromise: {},

        padZero: function (num) {
            if (num.length < 2) {
                return '0' + num;
            } else {
                return num;
            }
        },
        invertColor: function (hex, bw) {
            // taken from here: https://stackoverflow.com/questions/35969656/how-can-i-generate-the-opposite-color-according-to-current-color
            if (hex.indexOf('#') === 0) {
                hex = hex.slice(1);
            }
            // convert 3-digit hex to 6-digits.
            if (hex.length === 3) {
                hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
            }
            if (hex.length !== 6) {
                throw new Error('Invalid HEX color.');
            }
            var r = parseInt(hex.slice(0, 2), 16);
            var g = parseInt(hex.slice(2, 4), 16);
            var b = parseInt(hex.slice(4, 6), 16);

            if (bw) {
                // http://stackoverflow.com/a/3943023/112731
                return (r * 0.299 + g * 0.587 + b * 0.114) > 186
                    ? '#000000'
                    : '#FFFFFF';
            }
            // invert color components
            r = (255 - r).toString(16);
            g = (255 - g).toString(16);
            b = (255 - b).toString(16);
            // pad each with zeros and return
            return '#' + vis.binds.consumption.padZero(r) + vis.binds.consumption.padZero(g) + vis.binds.consumption.padZero(b);
        },
        getStations: function (instance, cb) {
            instance = instance || 0;
            vis.conn.getStates([
                'consumption.' + instance + '.instances.common.resources',
                'consumption.' + instance + '.instances.common.stations'
            ], function (err, data) {
                if (err) {
                    cb(err);
                } else {
                    try {
                        var stations  = JSON.parse(data['consumption.' + instance + '.instances.common.stations'].val  || '[]');
                        var resources = JSON.parse(data['consumption.' + instance + '.instances.common.resources'].val || '[]');
                        cb(null, {stations: stations, resources: resources});
                    } catch (e) {
                        cb('Cannot parse stations: ' + e);
                    }
                }
            });
        },
        renderStations: function ($div, $el, stations) {
            var text = '<table class="vis-cons-stations-table"><tr class="vis-cons-stations-tr>';
            text += '<td class="vis-cons-stations-td" data-name="">' + _('All') + '</td></tr>';
            for (var i = 0; i < stations.length; i++) {
                text += '<td class="vis-cons-stations-td" data-name="' + stations[i].name + '" data-color="' + stations[i].color + '">';
                text += stations[i].title;
                text += '</td>';
            }

            text += '</tr></table>';

            $el.html(text);

            var $items = $el.find('.vis-cons-stations-td');

            // install handlers
            $items.on('click', function () {
                $(this).parent().find('.vis-cons-stations-td').removeClass('vis-cons-stations-selected');
                $(this).addClass('vis-cons-stations-selected');
                vis.binds.consumption.setSettings($div, null, $(this).data('name'));
            });

            // select current resource
            var settings = $div.data('settings');

            $items.each(function () {
                if (settings.station === $(this).data('name')) {
                    $(this).addClass('vis-cons-resources-selected');
                }
            });
        },
        renderResources: function ($div, $el, resources) {
            var count = resources.length + 1; // + all
            var width = Math.round(10000 / count) / 100;

            var text = '<table class="vis-cons-resources-table"><tr class="vis-cons-resources-tr">';
            if (count > 2) {
                text += '<td class="vis-cons-resources-td vis-cons-resources-all" data-name="" style="width: ' + width + '%"><span class="vis-cons-types-icon">€</span><span class="vis-cons-types-title">' + _('all') + '</span></td>';
            }

            var ownClasses = $div.data('data').ownClasses || false;

            for (var r = 0; r < resources.length; r++) {
                var color = resources[r].color;
                var style = ownClasses ? '' : 'background: ' + color + '50; color: ' + vis.binds.consumption.invertColor(resources[r].color, true);

                text += '<td class="vis-cons-resources-td vis-cons-resources-td-' + resources[r].name + '" data-name="' + resources[r].name + '" style="width: ' + width + '%; ' + style + '">';
                if (resources[r].icon && resources[r].icon.length <= 2) {
                    text += '<span class="vis-cons-types-icon">' + resources[r].icon + '</span>';
                }
                text += '<span class="vis-cons-types-title">' + resources[r].title + '</span>';
                text += '</td>';
            }
            text += '</tr></table>';
            $el.html(text);

            // install handlers
            var $items = $el.find('.vis-cons-resources-td');
            $items.on('click', function () {
                $(this).parent().find('.vis-cons-resources-td').removeClass('vis-cons-resources-selected');
                $(this).addClass('vis-cons-resources-selected');
                vis.binds.consumption.setSettings($div, null, null, $(this).data('name'));
            });

            // select current resource
            var settings = $div.data('settings');

            if (count === 2 && !settings.resource) {
                vis.binds.consumption.setSettings($div, null, null, resources[0].name);
                $items.each(function () {
                    if ($(this).data('name')) {
                        $(this).addClass('vis-cons-resources-selected');
                    }
                });
            } else {
                $items.each(function () {
                    if (settings.resource === $(this).data('name')) {
                        $(this).addClass('vis-cons-resources-selected');
                    }
                });
            }
        },
        renderTypes: function ($div, $el) {
            var data =$div.data('data');

            var text = '<table class="vis-cons-types-table">';
            if (!data.hide_planning || data.hide_planning === 'false') {
                text += '<tr class="vis-cons-types-tr"><td class="vis-cons-types-td" data-name="plan" title="' + _('Planning') + '">' +
                    '<img class="vis-cons-types-icon" src="widgets/consumption/img/market-research.svg" alt="analysis"/>' +
                    '</td></tr>';
            }
            if (!data.hide_pie || data.hide_pie === 'false') {
                text += '<tr class="vis-cons-types-tr"><td class="vis-cons-types-td" data-name="donut" title="' + _('Pie chart') + '">' +
                    '<img class="vis-cons-types-icon" src="widgets/consumption/img/seo-and-web.svg" alt="donut"/>' +
                    '</td></tr>';
            }
            if (!data.hide_stackbar || data.hide_stackbar === 'false') {
                text += '<tr class="vis-cons-types-tr"><td class="vis-cons-types-td" data-name="stackbar" title="' + _('Stack bar') + '">' +
                    '<img class="vis-cons-types-icon" src="widgets/consumption/img/stacked.svg" alt="stackbar"/>' +
                    '</td></tr>';
            }
            if (!data.hide_heatmap || data.hide_heatmap === 'false') {
                text += '<tr class="vis-cons-types-tr"><td class="vis-cons-types-td" data-name="heatmap" title="' + _('Heat map') + '">' +
                    '<img class="vis-cons-types-icon" src="widgets/consumption/img/heatmap.svg" alt="heatmap"/>' +
                    '</td></tr>';
            }
            if (!data.hide_table || data.hide_table === 'false') {
                text += '<tr class="vis-cons-types-tr"><td class="vis-cons-types-td" data-name="table" title="' + _('Table') + '">' +
                    '<img class="vis-cons-types-icon" src="widgets/consumption/img/spreadsheet.svg" alt="table"/>' +
                    '</td></tr>';
            }
            if (!data.hide_charts || data.hide_charts === 'false') {
                text += '<tr class="vis-cons-types-tr"><td class="vis-cons-types-td" data-name="charts" title="' + _('Charts') + '">' +
                    '<img class="vis-cons-types-icon" src="widgets/consumption/img/charts.svg" alt="charts"/>' +
                    '</td></tr>';
            }
            text += '</table>';
            $el.html(text);

            var $items = $el.find('.vis-cons-types-td');
            // install handlers
            $items.on('click', function () {
                $(this).parent().parent().find('.vis-cons-types-td').removeClass('vis-cons-types-selected');
                $(this).addClass('vis-cons-types-selected');
                vis.binds.consumption.setSettings($div, $(this).data('name'));
            });

            // select current resource
            var settings = $div.data('settings');

            $items.each(function () {
                if (settings.type === $(this).data('name')) {
                    $(this).addClass('vis-cons-types-selected');
                }
            });
        },
        loadCharts: function (cb) {
            if (!vis.binds.consumption.loaded) {
                vis.binds.consumption.loaded = true;
                $.ajax({
                    url: 'widgets/consumption/js/echarts.min.js',
                    dataType: 'script',
                    success: function () { cb && cb();}
                });
            } else {
                return cb && cb();
            }
        },
        isCurrency: function (symbol) {
            return symbol === '€' || symbol === '$' || symbol === '₽' || symbol === '£' || symbol === 'Ұ' || symbol === '¥'|| symbol === '元' || symbol === 'CHF';
        },
        setSettings: function ($div, type, station, resource, start, end, isEuro, force) {
            var settings = $div.data('settings');
            var changed = false;
            if (type && settings.type !== type) {
                settings.type = type;
                changed = true;
            }
            if (isEuro !== null && isEuro !== undefined && settings.isEuro !== isEuro) {
                settings.isEuro = isEuro;
                changed = true;
            }
            if (station !== null && station !== undefined && settings.station !== station) {
                settings.station = station;
                changed = true;
            }
            if (resource !== null && resource !== undefined && settings.resource !== resource) {
                settings.resource = resource;
                changed = true;
                // Check if new Resource has this unit
                if (resource && typeof settings.isEuro === 'string') {
                    settings.isEuro = vis.binds.consumption.isCurrency(settings.isEuro);
                }
            }

            if (start && settings.start !== start) {
                var startsFrom = $div.data('data').startsFrom;
                if (startsFrom) {
                    var parts = startsFrom.split('-');
                    startsFrom = new Date(parseInt(parts[0], 10), parseInt(parts[1], 10) - 1, 1);
                    if (start < startsFrom.getTime()) {
                        start = startsFrom.getTime();
                    }
                }

                settings.start = start;
                changed = true;
            }
            if (end && settings.end !== end) {
                var startsFrom1 = $div.data('data').startsFrom;
                if (startsFrom1) {
                    var parts1 = startsFrom1.split('-');
                    startsFrom1 = new Date(parseInt(parts1[0], 10), parseInt(parts1[1], 10) - 1, 1);
                    if (start < startsFrom1.getTime()) {
                        end = startsFrom1.getTime();
                    }
                }
                settings.end = end;
                changed = true;
            }

            if (changed || force) {
                var instance = $div.data('instance');
                localStorage.setItem('vis-consumption.' + instance, JSON.stringify(settings));
                $div.data('settings', settings);
                vis.conn.setState(instance + '.trigger', JSON.stringify(settings));
            }
        },
        initInstance: function (instId, instance, cb) {
            if (!vis.binds.consumption.instancePromise[instId]) {
                vis.binds.consumption.instancePromise[instId] = true;
                vis.conn.getStates([instId + '.lastTime'], function (err, data) {
                    if (!data[instId + '.lastTime'] || !data[instId + '.lastTime'].val) {
                        vis.conn.setState('consumption.' + instance + '.instances.common.addInstance', vis.instance.replace(/\./g, '_'), function () {
                            setTimeout(function () {
                                vis.conn.subscribe(instId + '.result', function () {
                                    cb && cb();
                                }, 200); // wait till
                            });
                        });
                    } else {
                        vis.conn.subscribe(instId + '.result', function () { cb && cb(); });
                    }
                });
            } else {
                cb && cb();
            }
        },
        init: function (el, wid, view, data, style) {
            var $div = $('#' + wid);
            if (!$div.length) {
                return setTimeout(function () {
                    vis.binds.consumption.init(el, wid, view, data, style);
                }, 100);
            }

            var _data = Object.assign({}, data);
            _data.consInstance = _data.consInstance || 0;
            _data.startsFrom = _data.startsFrom || '2020-01';
            var parts = _data.startsFrom.split('-');
            if ((parts[0] || '').length !== 4) {
                parts[0] = '2020';
            }
            if (!parts[1]) {
                parts[1] = '01';
            }
            _data.startsFrom = parts[0] + '-' + parts[1];
            _data.currency = _data.currency || '€';

            // generate instance if not exists
            !vis.instance && vis.generateInstance();

            var inst = 'consumption.' + _data.consInstance + '.instances.' + vis.instance.replace(/\./g, '_');
            $div.data('instance', inst);
            $div.data('dateFormat', _data.dateFormat || 'yy-mm-dd');
            $div.data('data', Object.assign({}, _data));
            $div.data('currency', _data.currency);

            // load echarts
            vis.binds.consumption.loadCharts(function () {
                vis.binds.consumption.initInstance(inst, _data.consInstance, function () {
                    vis.binds.consumption.getStations(_data.consInstance, function (err, data) {
                        // init settings
                        var settings = localStorage.getItem('vis-consumption.' + inst) || '{}';
                        try {
                            settings = JSON.parse(settings);
                        } catch (e) {

                        }
                        var now = new Date();
                        settings.end = settings.end || now.getTime();

                        if (!settings.start) {
                            now.setMonth(0);
                            now.setDate(1);
                            now.setHours(0);
                            now.setMinutes(0);
                            now.setSeconds(0);
                            now.setMilliseconds(0);
                            settings.start = now.getTime();
                        }

                        settings.type     = settings.type    || 'plan';
                        settings.station  = _data.consumption_station || settings.station || data.stations[0].name;
                        var s;
                        for (s = 0; s < data.stations.length; s++) {
                            if (settings.station === data.stations[s].name) {
                                break;
                            }
                        }
                        if (s === data.stations.length) {
                            settings.station  = data.stations[0].name;
                        }

                        settings.resource = settings.resource === null || settings.resource === undefined ? data.resources[0].name : settings.resource;
                        $div.data('settings', settings);

                        var text = '<table class="vis-cons-table"><tbody style="width:100%; height: 100%;">';

                        text += '<tr class="vis-cons-table-first-row">';
                        text += '<td class="vis-cons-table-empty-cell"></td>'; // empty
                        text += '<td class="vis-cons-resources"></td>';
                        text += '</tr>';

                        text += '<tr class="vis-cons-table-second-row">';
                        text += '<td class="vis-cons-types"></td>';
                        text += '<td class="vis-cons-toolbar-ans-results">';
                        text += '<div class="vis-cons-toolbar" style="color: ' + (_data.colorTheme === 'dark' ? 'white' : 'black') + '"><div class="vis-cons-toolbar-euro"></div>' +
                                '<div class="vis-cons-toolbar-dates"></div></div>' +
                                '<div class="vis-cons-results"></div></td>';
                        text += '</tr>';
                        text += '</tbody></table>';
                        $div.html(text);

                        var $types = $div.find('.vis-cons-types');
                        vis.binds.consumption.renderTypes($div, $types);

                        $div.data('resources', data.resources);
                        $div.data('stations', data.stations);

                        var $resources = $div.find('.vis-cons-resources');
                        vis.binds.consumption.renderResources($div, $resources, data.resources);

                        vis.binds.consumption.renderResults($div, settings);

                        function onChange(wid, id, newVal) {
                            if ($div && id === inst + '.result') {
                                if (typeof newVal === 'string') {
                                    try {
                                        newVal = JSON.parse(newVal);
                                    } catch (e) {
                                        newVal = {};
                                    }
                                }
                                try {
                                    vis.binds.consumption.renderResults($div, settings, newVal);
                                } catch (e) {
                                    console.error('Cannot update chart: ' + e);
                                }
                            } else if (!$div) {
                                console.log('Try unregister one more time');
                                vis.unregisterOnChange(onChange, wid);
                            }
                        }

                        vis.registerOnChange(onChange, wid);

                        /*vis.states.bind(inst + '.result.val', onChangeBindHandler);

                        // remember all ids, that bound
                        $div.data('bound', [inst + '.result.val']);

                        // remember bind handler
                        $div.data('bindHandler', onChangeBindHandler);*/

                        $div.data('destroy', function (widget, $widget) {
                            vis.binds.consumption.instancePromise[inst] = null;
                            vis.conn.unsubscribe(inst + '.result');
                            vis.unregisterOnChange(onChange, wid);
                            $div = null;
                        });

                        // request data
                        vis.binds.consumption.setSettings($div, null, null, null, null, null, null, true);
                    });
                });
            });
        },
        destroyChart: function ($div, $report) {
            $report = $report || $div.find('.vis-cons-results');
            try {
                var chart = $report.data('chart');
                chart && echarts.dispose(chart);
                $report.data('chart', null);
            } catch (e) {

            }
        },
        renderEuroSwitch: function ($div, $results, $toolbar, settings, unit, showDropDown) {
            settings = settings || $div.data('settings');
            var $euro = $toolbar.find('.vis-cons-toolbar-euro');

            // install onclick handler once
            if (!$euro.data('installed')) {
                $euro.data('installed', true);

                $euro.on('click', function () {
                    var ignoreClick = $(this).data('ignoreClick');
                    if (!ignoreClick) {
                        $(this).find('.vis-cons-switch-input').prop('checked', !settings.isEuro);
                        vis.binds.consumption.setSettings($div, null, null, null, null, null, !settings.isEuro);
                    }
                });
            }

            var $switch = $euro.find('.vis-cons-switch-input');
            var $select = $euro.find('.vis-cons-select-input');
            if (unit) {
                $euro.data('ignoreClick', false);
                $euro.css('padding-top', '15px');
                if (settings.resource) {
                    if ($switch.length) {
                        $switch.prop('checked', settings.isEuro);
                        $euro.find('.vis-cons-switch-unit').html(unit);
                    } else {
                        var text = '<span class="vis-cons-switch-label vis-cons-switch-unit">' + unit + '</span><input type="checkbox" class="vis-cons-switch-input" ' + (settings.isEuro ? 'checked' : '') + '/><label for="switch">Toggle</label><span class="vis-cons-switch-label vis-cons-switch-euro">€</span>';
                        $euro.html(text);
                    }
                } else {
                    $euro.css('padding-top', '0');
                    ($switch.length || $select.length) && $euro.html('');
                }
            } else if (showDropDown) {
                $euro.data('ignoreClick', true);
                // collect all units
                var resources = $div.data('resources');
                if (!$select.length) {
                    var units = [$div.data('currency')];
                    var theme = $div.data('data').colorTheme;
                    var textColor = theme === 'dark' ? 'white' : 'black';
                    var style = 'height: 24px; color: ' + textColor + '; background: #00000000; border: 1px solid lightgray; padding: 3px;';
                    var select = '<select class="vis-cons-select-input" style="' + style + '"><option value="€">€</option>\n';
                    for (var r = 0; r < resources.length; r++) {
                        if (resources[r].unit && units.indexOf(resources[r].unit) === -1) {
                            units.push(resources[r].unit);
                            select += '<option style="color: black" value="' + resources[r].unit + '">' + resources[r].unit + '</option>\n';
                        }
                    }
                    select += '</select>';
                    $euro.html(select);
                    $select = $euro.find('.vis-cons-select-input');
                    $select.off('change').on('change', function () {
                        vis.binds.consumption.setSettings($div, null, null, null, null, null, $(this).val());
                    });
                }
                $select.val(settings.isEuro === true || !settings.isEuro ? $div.data('currency') : settings.isEuro);
            } else {
                $euro.data('ignoreClick', true);
                ($switch.length || $select.length) && $euro.html('');
                $euro.css('padding-top', '0');
            }
        },
        renderDatePicker: function ($div, $results, $toolbar, settings, visible) {
            settings = settings || $div.data('settings');
            var $dates = $toolbar.find('.vis-cons-toolbar-dates');
            var $inputs = $dates.find('select');
            var startsFrom = $div.data('data').startsFrom;
            if (visible) {
                var dateFormat = $div.data('dateFormat');
                if ($inputs.length) {
                    var $from = $dates.find('.vis-cons-toolbar-from');
                    var $to   = $dates.find('.vis-cons-toolbar-to');
                    $from.val(settings.start);
                    $to.val(settings.end);
                } else {
                    var theme = $div.data('data').colorTheme;
                    var textColor = theme === 'dark' ? 'white' : 'black';
                    var style = 'color: ' + textColor + '; background: #00000000; border: 1px solid lightgray; padding: 3px;';
                    var parts = startsFrom.split('-');

                    var _startsFrom = new Date(parseInt(parts[0], 10), parseInt(parts[1], 10) - 1, 1);
                    var now = new Date();
                    now.setMonth(now.getMonth() + 1);
                    var startOptions = [];
                    while (_startsFrom < now) {
                        startOptions.push('<option style="color: black" value="' + _startsFrom.getTime() + '">' + $.datepicker.formatDate(dateFormat, _startsFrom) + '</option>');
                        _startsFrom.setMonth(_startsFrom.getMonth() + 1);
                    }

                    var _endsTo = new Date(parseInt(parts[0], 10), parseInt(parts[1], 10) - 1, 1);
                    var endOptions = [];
                    while (_endsTo < now) {
                        var d = new Date(_endsTo);
                        d.setMonth(d.getMonth() + 1);
                        d.setMilliseconds(d.getMilliseconds() - 1);
                        endOptions.push('<option style="color: black" value="' + d.getTime() + '">' + $.datepicker.formatDate(dateFormat, d) + '</option>');
                        _endsTo.setMonth(_endsTo.getMonth() + 1);
                    }

                    var text = '<span class="vis-cons-toolbar-dates-label">' + _('from') + ':</span> ' +
                               '<select class="vis-cons-toolbar-from" style="' + style + '">' + startOptions.join('\n') + '</select> ' +
                               '<span class="vis-cons-toolbar-dates-label">' + _('to') + ':</span> ' +
                               '<select style="' + style + '" class="vis-cons-toolbar-to">' + endOptions.join('\n') + '</select>';
                    $dates.html(text);
                    var $from1 = $dates.find('.vis-cons-toolbar-from');
                    var $to1   = $dates.find('.vis-cons-toolbar-to');

                    $from1.on('change', function () {
                        var from = parseInt($(this).val(), 10);
                        var to = settings.end;
                        if (to <= from) {
                            var d = new Date(from);
                            d.setMonth(d.getMonth() + 1);
                            d.setMilliseconds(d.getMilliseconds() - 1);
                            to = d.getTime();
                        }
                        vis.binds.consumption.setSettings($div, null, null, null, from, to);
                    }).val(settings.start);
                    $to1.on('change', function () {
                        var to = parseInt($(this).val(), 10);
                        var from = settings.start;
                        if (to <= from) {
                            var d = new Date(to);
                            d.setMilliseconds(d.getMilliseconds() + 1);
                            d.setMonth(d.getMonth() - 1);
                            from = d.getTime();
                        }
                        vis.binds.consumption.setSettings($div, null, null, null, from, to);
                    }).val(settings.end);
                }
            } else {
                if ($inputs.length) {
                    $dates.html('');
                }
            }
        },
        renderToolbar: function ($div, $results, $toolbar, euroVisible, dateVisible) {
            if (euroVisible || dateVisible) {
                $results.css('height', 'calc(100% - 50px)');
                $toolbar.show();
            } else {
                $results.css('height', '100%');
                $toolbar.hide();
            }
        },
        renderResults: function ($div, settings, data) {
            settings = settings || $div.data('settings');
            var $toolbar = $div.find('.vis-cons-toolbar');
            var $report  = $div.find('.vis-cons-results');
            if (!data || !data.series) {
                return $report.html('<div class="vis-cons-rendering">' + _('rendering...') + '</div>');
            } else {
                var $render = $report.find('.vis-cons-rendering');
                $render && $render.length && $render.remove();
            }

            switch (settings.type) {
                case 'donut':
                    vis.binds.consumption.renderToolbar($div, $report, $toolbar, true, true);
                    vis.binds.consumption.renderEuroSwitch($div, $report, $toolbar, settings, settings.resource ? data.unitOriginal : '', !settings.resource);
                    vis.binds.consumption.renderDatePicker($div, $report, $toolbar, settings, true);
                    vis.binds.consumption.renderDonut($div, $report, settings, data);
                    $div.find('.slider-range-div').remove();
                    break;

                case 'stackbar':
                    vis.binds.consumption.renderToolbar($div, $report, $toolbar, true, false);
                    vis.binds.consumption.renderEuroSwitch($div, $report, $toolbar, settings, settings.resource ? data.unitOriginal : '', !settings.resource);
                    vis.binds.consumption.renderDatePicker($div, $report, $toolbar, settings, false);
                    vis.binds.consumption.renderStackBar($div, $report, settings, data);
                    $div.find('.slider-range-div').remove();
                    break;

                case 'heatmap':
                    vis.binds.consumption.renderToolbar($div, $report, $toolbar, true, false);
                    vis.binds.consumption.renderEuroSwitch($div, $report, $toolbar, settings, settings.resource ? data.unitOriginal : '', !settings.resource);
                    vis.binds.consumption.renderDatePicker($div, $report, $toolbar, settings, false);
                    vis.binds.consumption.renderHeatMap($div, $report, settings, data);
                    break;

                case 'table':
                    vis.binds.consumption.destroyChart($div, $report);
                    vis.binds.consumption.renderToolbar($div, $report, $toolbar, true, false);
                    vis.binds.consumption.renderEuroSwitch($div, $report, $toolbar, settings, settings.resource ? data.unitOriginal : '', !settings.resource);
                    vis.binds.consumption.renderDatePicker($div, $report, $toolbar, settings, false);
                    vis.binds.consumption.renderTable($div, $report, settings, data);
                    $div.find('.slider-range-div').remove();
                    break;

                case 'charts':
                    vis.binds.consumption.destroyChart($div, $report);
                    vis.binds.consumption.renderToolbar($div, $report, $toolbar, true, false);
                    vis.binds.consumption.renderEuroSwitch($div, $report, $toolbar, settings, settings.resource ? data.unitOriginal : '', !settings.resource);
                    vis.binds.consumption.renderDatePicker($div, $report, $toolbar, settings, false);
                    vis.binds.consumption.renderCharts($div, $report, settings, data);
                    $div.find('.slider-range-div').remove();
                    break;

                case 'plan':
                default:
                    vis.binds.consumption.destroyChart($div, $report);
                    vis.binds.consumption.renderToolbar($div, $report, $toolbar, !!settings.resource ? data.unitOriginal : '', false);
                    vis.binds.consumption.renderEuroSwitch($div, $report, $toolbar, settings, settings.resource ? data.unitOriginal : '');
                    vis.binds.consumption.renderDatePicker($div, $report, $toolbar, settings, false);
                    vis.binds.consumption.renderPlan($div, $report, settings, data);
                    $div.find('.slider-range-div').remove();
                    break;
            }
        },
        renderDonut: function ($div, $report, settings, data) {
            var unit = data.unit;
            var option = {
                tooltip: {
                    show: true,
                    trigger: 'item',
                    formatter: '{b}<br/>{c} ' + unit + ' ({d}%)'
                },
                series: data.series
            };

            var showIndexes;
            // var theme = $div.data('data').colorTheme;
            if (option.series[0].data.length >= 10) {
                var _showIndexes = [];
                for (var k = 0; k < option.series[0].data.length; k++) {
                    _showIndexes.push({val: option.series[0].data[k].value, i: k});
                }
                _showIndexes.sort(function (a, b) {return a.val > b.val ? -1 : (a.val < b.val ? 1 : 0)});
                _showIndexes.splice(10, _showIndexes.length - 10);
                showIndexes = [];
                for (var u = 0; u < _showIndexes.length; u++) {
                    showIndexes.push(_showIndexes[u].val);
                }
            }

            for (var i = 0; i < option.series.length; i++) {
                var serie = option.series[i];
                serie.type = 'pie';
                if (i === 0) {
                    if (option.series.length === 1) {
                        serie.radius = '65%';
                    } else {
                        serie.radius = ['40%', '65%'];
                    }
                    // only outer ring has labels
                    if (option.series[i].data.length < 10) {
                        serie.label = {
                            show: true,
                            formatter: ' {b|{b}}\n{hr|}\n  {c} ' + unit + ' {per|{d}%}  ',
                            backgroundColor: '#eee',
                            borderColor: '#aaa',
                            borderWidth: 1,
                            borderRadius: 2,
                            padding: [0, 7],
                            rich: {
                                b: {
                                    color: '#999',
                                    align: 'center',
                                    fontSize: 14,
                                    lineHeight: 20
                                },
                                hr: {
                                    borderColor: '#aaa',
                                    width: '100%',
                                    borderWidth: 0.5,
                                    height: 0
                                },
                                per: {
                                    color: '#eee',
                                    backgroundColor: '#334455',
                                    padding: [2, 4],
                                    borderRadius: 2,
                                    lineHeight: 22
                                }
                            }
                        };
                    } else {
                        serie.label = {
                            show: true,
                            formatter: function (param) {
                                return param.name + ': ' + param.percent + '% (' + param.value + unit + ')'
                            },
                            fontSize: 10,
                            color: '#000',
                            backgroundColor: '#eee',
                            borderColor: '#aaa',
                            borderWidth: 1,
                            borderRadius: 2,
                            padding: [0, 7],
                            rich: {
                                b: {
                                    color: '#999',
                                    align: 'center',
                                    fontSize: 14,
                                    lineHeight: 20
                                },
                                hr: {
                                    borderColor: '#aaa',
                                    width: '100%',
                                    borderWidth: 0.5,
                                    height: 0
                                },
                                per: {
                                    color: '#eee',
                                    backgroundColor: '#334455',
                                    padding: [2, 4],
                                    borderRadius: 2,
                                    lineHeight: 22
                                }
                            }
                        };
                    }
                } else {
                    // inner ring
                    serie.radius = [0, '35%'];
                    serie.label = {position: 'inner'};
                }
            }

            var chart = $report.data('chart');

            if (!chart || $report.data('type') !== 'donut' + data.series.length) {
                vis.binds.consumption.destroyChart($div, $report);
                $report.text(''); // remove old stuff
                chart = echarts.init($report[0]/*, null, {renderer: 'svg'}*/);
                $report.data('type', 'donut' + data.series.length);
                $report.data('chart', chart);
            }

            // console.log(JSON.stringify(option, null, 2));

            chart.setOption(option);
        },
        renderPlan: function ($div, $report, settings, data) {
            var theme = $div.data('data').colorTheme;
            var textColor = theme === 'dark' ? 'white' : 'black';

            var text = '<table class="vis-cons-plan-table" style="color: ' + textColor + '">';
            text += '<tr class="vis-cons-plan-tr-first"><td class="vis-cons-plan-td-main"></td><td class="vis-cons-plan-main-td-widget"><div class="vis-cons-plan-main-td-widget-div"></div></td></tr>';
            if (!settings.resource) {
                text += '<tr class="vis-cons-plan-tr-second"><td colspan="2" class="vis-cons-plan-td-additional"></td></tr>';
            }
            text += '</table>';
            $report.html(text);

            vis.binds.consumption.renderPlanMain($div, $report.find('.vis-cons-plan-td-main'), settings, data);
            var resources = $div.data('resources');

            var name = (settings.resource || 'all').toLowerCase();
            var resourceTitle = '';
            if (settings.resource) {
                for (var r = 0; r < resources.length; r++) {
                    if (resources[r].name === settings.resource) {
                        resourceTitle = resources[r].title;
                        break;
                    }
                }
            }

            var options = {
                reference: data.series[name].reference, // last year consumption
                actual:    data.series[name].actual,    // actual consumption
                planned:   data.series[name].planned,   // planned this year
                forecast:  data.series[name].forecast,  // forecast this year
                unit:      data.unit,
                height:    180,
                textColor: textColor,

                title: resourceTitle ? _('%s overview', resourceTitle) : _('Total overview')
            };

            vis.binds.consumption.forecastBar.init($report.find('.vis-cons-plan-main-td-widget-div'), options);

            if (!settings.resource) {
                var $additional = $report.find('.vis-cons-plan-td-additional');
                var divs = [];
                for (var rr = 0; rr < resources.length; rr++) {
                    divs.push('<div class="vis-cons-plan-div-additional-widget"><div class="vis-cons-plan-main-additional-widget-div" data-resource="' + resources[rr].name + '"></div></div>');
                }

                $additional.html(divs.join('\n'));

                for (var i = 0; i < resources.length; i++) {
                    var res = resources[i];
                    var $wDiv = $additional.find('.vis-cons-plan-main-additional-widget-div[data-resource="' + res.name + '"]');
                    var resourceTitle1 = resources[i].title;

                    var name1 = res.name.toLowerCase();

                    var options1 = {
                        reference: data.series[name1].reference, // last year consumption
                        actual:    data.series[name1].actual,    // actual consumption
                        planned:   data.series[name1].planned,   // planned this year
                        forecast:  data.series[name1].forecast,  // forecast this year
                        unit:      data.unit,
                        height:    100,
                        textColor: textColor,
                        onClick:   (function (n) { return function () {
                            vis.binds.consumption.setSettings($div, null, null, n);
                        }})(name1),

                        title: resourceTitle1
                    };

                    vis.binds.consumption.forecastBar.init($wDiv, options1);
                }
            }
        },
        renderStackBar: function ($div, $report, settings, data) {
            var unit = data.unit;
            var theme = $div.data('data').colorTheme;
            var color = theme === 'dark' ? '#CCC' : '#333';

            function formatter(year, month) {
                var sum = null;
                for (var s = 0; s < data.series.length; s++) {
                    if (data.series[s].stack === year && data.series[s].data[month] !== null && data.series[s].data[month] !== undefined) {
                        sum = sum || 0;
                        sum += data.series[s].data[month];
                    }
                }

                return vis.binds.consumption.format(sum, unit, true);
            }

            // find last items of every stack
            var last = {};
            for (var s = 0; s < data.series.length; s++) {
                last[data.series[s].stack] = data.series[s];
                data.series[s].type = 'bar';
            }

            // and place text on the top
            for (var stack in last) {
                last[stack].label = {
                    formatter: (function (stack) {
                        return function (opt) { return formatter(stack, opt.dataIndex); }
                    })(stack),
                    show: true,
                    color: color,
                    fontSize: 10,
                    rotate: 45,
                    offset: [5, -10],
                    position: 'top'
                }
            }

            // add year to name
            if (data.series.length <= 10) {
                for (var ss = 0; ss < data.series.length; ss++) {
                    data.series[ss].name = data.series[ss].year + ' ' + data.series[ss].name;
                }
            }

            var option = {
                tooltip: {
                    show: true,
                    trigger: 'axis',
                    formatter: function (params) {
                        var len = params.length / 2;
                        var map = [];
                        for (var i = 0; i < params.length; i++) {
                            map.push({text: '<div style="opacity: ' + (i < len ? 0.5 : 1) + '"><span style="display: inline-block; margin-right: 5px;border-radius: 10px;width: 9px;height: 9px; background-color: ${params[i].color}; opacity: ' + params[i].opacity + '"></span>' + params[i].seriesName + ': ' + vis.binds.consumption.format(params[i].value, unit) + '</div>', val: params[i].value});
                        }
                        if (params.length > 10) {
                            map.splice(0, len);
                            map.sort(function (a, b) {return a.val > b.val ? -1 : (a.val < b.val ? 1 : 0)});
                            map.splice(10, map.length - 10);
                            map.push({text: '<div>...</div>'});
                        }

                        var text = '';
                        for (var j = 0; j < map.length; j++) {
                            text += map[j].text;
                        }

                        return '<div style="text-align: left"><strong style="padding-left: 15px">' + params[0].name + '</strong></br>' + text + '</div>';
                    },
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                grid: {
                    left: '0%',
                    right: '0%',
                    bottom: data.legend ? '50px' : '0%',
                    top: '30px',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: vis.binds.consumption.months[vis.language] || vis.binds.consumption.months.en,
                    axisLabel: {
                        color: color
                    },
                    axisTick: {
                        alignWithLabel: true,
                        lineStyle: {
                            color: color
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: color
                        }
                    }
                },
                yAxis: {
                    type: 'value',
                    name: data.unit,
                    axisLabel: {
                        color: color
                    },
                    axisTick: {
                        lineStyle: {
                            color: color
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: color
                        }
                    }
                },
                series: data.series
            };

            if (data.legend && data.series.length < 10) {
                option.legend = {
                    data: data.legend,
                    //type: 'scroll',
                    bottom: 0,
                    selectedMode: false,
                    textStyle: {
                        color: color
                    }
                }
            }

            var chart;

            vis.binds.consumption.destroyChart($div, $report);
            $report.text(''); // remove old stuff
            chart = echarts.init($report[0], null, {renderer: 'svg'});
            $report.data('type', 'stackbar');
            $report.data('chart', chart);
            chart.setOption(option);
        },

        format: function (m, unit, noHtml) {
            if (m === undefined || m === null) {
                return '';
            }

            if (vis.binds.consumption.isCurrency(unit)) {
                if (noHtml) {
                    if (m < 1000) {
                        return m.toFixed(1).toString().replace('.', ',') + ' ' + unit;
                    } else {
                        return Math.round(m) + ' ' + unit;
                    }
                } else {
                    return '<span class="vis-cons-table-value">' + m.toFixed(1).replace('.', ',') + '<span class="vis-cons-table-unit"> ' + unit + '</span>';
                }
            } else {
                var val = m < 1000 ? (Math.round(m * 10) / 10).toString().replace('.', ',') : Math.round(m);
                if (noHtml) {
                    return val + ' ' + (unit || '');
                } else {
                    return '<span class="vis-cons-table-value">' + val + '<span class="vis-cons-table-unit"> ' + (unit || '') + '</span>';
                }
            }
        },
        renderTable: function ($div, $report, settings, data) {
            // combine
            //          Jan Feb Mar                       Total
            // -----------------------
            // E1 2020
            // E1 2019
            // ----------------------
            // E2 2020
            // E2 2019
            // ----------------------
            // Total 2020                                  xxx
            // Total 2019                                  yyy
            var theme = $div.data('data').colorTheme;
            var textColor = theme === 'dark' ? 'white' : 'black';
            var lines = [];
            lines.push('<tr class="vis-cons-table-tr-header"><th>' + _('Name') + '</th><th></th><th>' + (vis.binds.consumption.months[vis.language] || vis.binds.consumption.months.en).join('</th><th>') + '</th><th>' + _('Total') + ' </th></tr>\n');
            var ids = {};

            var prevYear;
            var actualYear;
            for (var s = 0; s < data.series.length; s++) {
                ids[data.series[s]._id] = ids[data.series[s]._id] || {};

                if (data.series[s].stack === 'prev') {
                    prevYear = prevYear || data.series[s].year;
                    ids[data.series[s]._id].prev = data.series[s];
                } else {
                    actualYear = actualYear || data.series[s].year;
                    ids[data.series[s]._id].actual = data.series[s];
                }
            }
            actualYear = actualYear || new Date().getFullYear();
            prevYear   = prevYear || (actualYear - 1);

            var unit = data.unit;

            var items = Object.keys(ids).sort();
            var stats = {actual: [], prev:  []};

            for (var i = 0; i < items.length; i++) {
                var item = items[i];
                var line1 = '<tr class="vis-cons-table-tr-actual">';
                item = ids[item];
                if (!item.actual) {
                    line1 += '<td rowspan="2" class="vis-cons-table-td-name">' + (item.prev ? item.prev.name : '--') + '</td>';
                    line1 += '<td>' + actualYear + '</td>';
                    for (var m = 0; m < 12; m++) {
                        line1 += '<td>--</td>';
                    }
                    line1 += '<td>--</td>';
                } else {
                    line1 += '<td rowspan="2" class="vis-cons-table-td-name">' + item.actual.name + '</td>';
                    line1 += '<td>' + actualYear + '</td>';
                    item.actual.data = item.actual.data || [];
                    var sum1 = 0;
                    for (var mm = 0; mm < 12; mm++) {
                        line1 += '<td>' + (item.actual.data[mm] === null || item.actual.data[mm] === undefined ? '--' : vis.binds.consumption.format(item.actual.data[mm], unit)) + '</td>';
                        sum1 += parseFloat(item.actual.data[mm] || 0);

                        stats.actual[mm] = stats.actual[mm] || {c: 0, s: 0};

                        if (item.actual.data[mm] !== null || item.actual.data[mm] !== undefined) {
                            stats.actual[mm].c++;
                            stats.actual[mm].s += parseFloat(item.actual.data[mm] || 0);
                        }
                    }
                    line1 += '<td class="vis-cons-table-td-total">' + vis.binds.consumption.format(sum1, unit) + '</td>';
                }
                line1 += '</tr>';
                lines.push(line1);


                line1 = '<tr class="vis-cons-table-tr-prev">';
                if (!item.prev) {
                    //line += '<td>--</td>';
                    line1 += '<td>' + prevYear + '</td>';
                    for (var mmm = 0; mmm < 12; mmm++) {
                        line1 += '<td>--</td>';
                    }
                    line1 += '<td>--</td>';
                } else {
                    //line += '<td>' + item.prev.name + '</td>';
                    line1 += '<td>' + prevYear + '</td>';
                    item.prev.data = item.prev.data || [];
                    var sum = 0;
                    for (var m = 0; m < 12; m++) {
                        line1 += '<td>' + (item.prev.data[m] === null || item.prev.data[m] === undefined ? '--' : vis.binds.consumption.format(item.prev.data[m], unit)) + '</td>';
                        sum += parseFloat(item.prev.data[m] || 0);

                        stats.prev[m] = stats.prev[m] || {c: 0, s: 0};

                        if (item.prev.data[m] !== null || item.prev.data[m] !== undefined) {
                            stats.prev[m].c++;
                            stats.prev[m].s += parseFloat(item.prev.data[m] || 0);
                        }
                    }
                    line1 += '<td class="vis-cons-table-td-total">' + vis.binds.consumption.format(sum, unit) + '</td>';
                }
                line1 += '</tr>\n';
                lines.push(line1);
            }

            // total of all lines for actual
            var line = '<tr class="vis-cons-table-tr-actual vis-cons-table-tr-total">';
            if (!stats.actual.length) {
                line += '<td rowspan="2" class="vis-cons-table-td-name">' + _('All') + '</td>';
                line += '<td>' + actualYear + '</td>';
                for (var m = 0; m < 12; m++) {
                    line += '<td>--</td>';
                }
                line += '<td>--</td>';
            } else {
                line += '<td rowspan="2" class="vis-cons-table-td-name">' + _('All') + '</td>';
                line += '<td>' + actualYear + '</td>';
                var sum2 = 0;
                for (var m1 = 0; m1 < 12; m1++) {
                    line += '<td>' + (!stats.actual[m1].c ? '--' : vis.binds.consumption.format(stats.actual[m1].s, unit)) + '</td>';
                    sum2 += stats.actual[m1].s || 0;
                }
                line += '<td class="vis-cons-table-td-total">' + vis.binds.consumption.format(sum2, unit) + '</td>';
            }
            line += '</tr>\n';
            lines.push(line);

            // total of all lines for prev
            line = '<tr class="vis-cons-table-tr-prev vis-cons-table-tr-total">';
            if (!stats.prev.length) {
                //line += '<td>--</td>';
                line += '<td>' + prevYear + '</td>';
                for (var m4 = 0; m4 < 12; m4++) {
                    line += '<td>--</td>';
                }
                line += '<td>--</td>';
            } else {
                //line += '<td>' + _('Previous') + '</td>';
                line += '<td>' + prevYear + '</td>';
                var sum3 = 0;
                for (var m3 = 0; m3 < 12; m3++) {
                    line += '<td>' + (!stats.prev[m3].c ? '--' : vis.binds.consumption.format(stats.prev[m3].s, unit)) + '</td>';
                    sum3 += stats.prev[m3].s || 0;
                }
                line += '<td class="vis-cons-table-td-total">' + vis.binds.consumption.format(sum3, unit) + '</td>';
            }
            line += '</tr>\n';
            line += '<tr class="vis-cons-table-tr-spacer"><td colspan="15"></td></tr>';
            lines.push(line);

            //$report.html('<table class="vis-cons-table" style="height: ' + (settings.resource ? 'calc(100% - 50px)' : '100%') + '; color: ' + textColor + '">' + lines.join('\n') + '</table>\n');
            $report.html('<table class="vis-cons-table" style="height: calc(100% - 50px); color: ' + textColor + '">' + lines.join('\n') + '</table>\n');
        },
        isLeapYear: function (date) {
            var year = typeof date !== 'object' ? date : date.getFullYear();
            if (year & 3) {
                return false;
            } else {
                return (year % 100 || !(year % 400));
            }
        },
        // Get Day of Year
        getMonth: function (day, year) {
            var dayCount = [31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];
            if (vis.binds.consumption.isLeapYear(year || new Date())) {
                dayCount = [31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335];
            }
            var month = 0;

            for (;month < dayCount.length; month++) {
                if (day < dayCount[month]) {
                    break;
                }
            }
            return {month: month, date: month ? day - dayCount[month - 1] : day};
        },
        renderHeatMap: function ($div, $report, settings, data) {
            var months = vis.binds.consumption.months[vis.language] || vis.binds.consumption.months.en;
            var theme = $div.data('data').colorTheme;
            var showHeatmapRange = $div.data('data').show_heatmap_range;
            showHeatmapRange = showHeatmapRange === true || showHeatmapRange === 'true';

            var maxDays = vis.binds.consumption.isLeapYear(new Date()) ? 366 : 365;
            var xData = [];
            for (var dd = 0; dd < maxDays; dd++) {
                xData[dd] = dd;
            }

            var yData = [];
            for (var d = 0; d < 24; d++) {
                yData[d] = d;
            }

            var values = data.series;

            var allData = [];
            var min = null;
            var max = null;
            for (var day = 0; day < values.length; day++) {
                if (!values[day]) {
                    continue;
                }
                for (var hour = 0; hour < values[day].length; hour++) {
                    var val = values[day][hour];
                    if (val !== null && val !== undefined) {
                        if (max === null || val > max) {
                            max = val;
                        }
                        if (min === null || val < min) {
                            min = val;
                        }
                        allData.push([day, hour, val]);
                    }
                }
            }
            var originalMin = min;
            var originalMax = max;

            var _diff = max - min;
            var limit = 0.03;
            min += _diff * limit; // remove lower 3%
            max -= _diff * limit; // remove upper 3%
            var _min = null;
            var _max = null;
            var minCount = 0;
            var maxCount = 0;
            for (var a = 0; a < allData.length; a++) {
                if (allData[a][2] <= min) {
                    minCount++;
                }
                if (allData[a][2] >= max) {
                    maxCount++;
                }
                if (allData[a][2] > min && (_min === null || allData[a][2] < _min)) {
                    _min = allData[a][2];
                }
                if (allData[a][2] < max && (_max === null || allData[a][2] > _max)) {
                    _max = allData[a][2];
                }
            }
            minCount = minCount / values.length;
            maxCount = maxCount / values.length;
            if (minCount < 0.01) {
                min = _min;
            }
            if (maxCount < 0.01) {
                max = _max;
            }
            max = _max;
            /*var limit = 0.1;
            var count = 0;
            for (var a = 0; a < allData.length; a++) {
                if (allData[a][2]) {
                    var ii = Math.round((allData[a][2] - min) / _diff * (stats.length - 1));
                    if (ii < 0) {
                        ii = 0;
                    } else if (ii > stats.length - 1) {
                        ii = stats.length - 1;
                    }
                    stats[ii]++;
                    count++;
                }
            }

            for (var i = 0; i < stats.length; i++) {
                stats[i] /= count;
            }
            var v = 0;
            while (stats[v] < limit && v < stats.length - 2) {
                v++;
            }

            if (v) {
                min += _diff * v * (1 / (stats.length - 1));
            }

            var m = stats.length - 1;
            while (stats[m] < limit && m > v) {
                m--;
            }
            if (m !== stats.length - 1) {
                if (m === v) {
                    m++;
                }
                max -= _diff * (stats.length - 1 - m) * (1 / (stats.length - 1));
            }*/
            var colors = ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026'];
            var size = colors.length;
            var diff = max - min;
            var width = $div.width();
            var unit = !settings.resource || settings.isEuro ? $div.data('currency') : data.unit;
            var color = theme === 'dark' ? '#CCC' : '#333';

            var instance = $div.data('instance');
            var curMin;
            var curMax;

            if (showHeatmapRange) {
                curMin = parseFloat(localStorage.getItem(instance + '_' + settings.resource + '_' + unit + '_min') || min);
                curMax = parseFloat(localStorage.getItem(instance + '_' + settings.resource + '_' + unit + '_max') || max);
                if (curMax > originalMax) {
                    curMax = originalMax;
                }
                if (curMin < originalMin) {
                    curMin = originalMin;
                }
            } else {
                curMin = _min;
                curMax = _max;
            }

            var option = {
                tooltip: {
                    show: true,
                    formatter: function (data) {
                        var m = vis.binds.consumption.getMonth(data.data[0]);
                        return months[m.month] + '.' + (m.date + 1) + ' ' + data.data[1] + ':00 - ' + vis.binds.consumption.format(data.data[2], unit);
                    }
                },
                xAxis: {
                    type: 'category',
                    data: xData,
                    axisLabel: {
                        show: true,
                        color: color,
                        align: 'left',
                        interval: function (data, value) {
                            var m = vis.binds.consumption.getMonth(data);
                            if (m.date === 0) {
                                return m.month.toString();
                            } else {
                                return false;
                            }
                        },
                        formatter: function (data) {
                            var m = vis.binds.consumption.getMonth(parseInt(data, 10));
                            return months[m.month];
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: color
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: color
                        }
                    }
                },
                grid: {
                    right: 0,
                    top: 0,
                    bottom: 65,
                    left: 25
                },
                yAxis: {
                    type: 'category',
                    data: yData,
                    axisLabel: {
                        alignWithLabel: true,
                        color: color
                    },
                    axisTick: {
                        lineStyle: {
                            color: color
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: color
                        }
                    }
                },
                visualMap: {
                    type: 'continuous',
                    min: curMin,
                    max: curMax,
                    calculable: true,
                    realtime: false,
                    orient: 'horizontal',
                    inRange: {color: colors},
                    precision: 1,
                    left: 50,
                    textStyle: {
                        color: color
                    },
                    itemHeight: Math.max(140, width - 280),
                    formatter: function (value) { return vis.binds.consumption.format(value, unit, true); }
                },
                series: [{
                    type: 'heatmap',
                    data: allData,
                    emphasis: {
                        itemStyle: {
                            borderColor: '#333',
                            borderWidth: 1
                        }
                    },
                    itemStyle1: {
                        color: function (data) {
                            var val = (data.data[2] - curMin) / diff;
                            var i = Math.round(val * 10);
                            if (i > size - 1) {
                                i = size - 1;
                            }
                            if (i < 0) {
                                i = 0;
                            }

                            return colors[i];
                        }
                    },
                    progressive: 1000,
                    animation: false
                }]
            };
            var chart = $report.data('chart');

            if (!chart || $report.data('type') !== 'heatmap_' + !!settings.resource) {
                vis.binds.consumption.destroyChart($div, $report);
                chart = echarts.init($report[0]);
                $report.data('type', 'heatmap_' + !!settings.resource);
                $report.data('chart', chart);
            }

            var $showHeatMapRange = $div.find('.slider-range');

            if (showHeatmapRange) {
                // var $toolbar = $div.find('.vis-cons-toolbar');
                // $div.find('.vis-cons-results').css('height', $toolbar.css('display') !== 'none' ? 'calc(100% - 100px)' : 'calc(100% - 50px)');
                if (!$showHeatMapRange.length) {
                    $('<div style="width: 100%; color: ' + (theme === 'dark' ? '#CCC' : '#333') + '; font-size: 14px" class="slider-range-div">' +
                        '<div class="slider-range-min" style="width: 100px; display: inline-block; text-align: right; padding-right: 15px">' + originalMin + '</div>' +
                        '<div class="slider-range" style="width: calc(100% - 210px); display: inline-block"></div>' +
                        '<div class="slider-range-max" style="width: 75px; display: inline-block; text-align: left; padding-left: 15px">' + originalMax + '</div>' +
                      '</div>').insertAfter($report);

                    $showHeatMapRange = $div.find('.slider-range');

                    $showHeatMapRange.slider({
                        range:  true,
                        min:    originalMin,
                        max:    originalMax,
                        values: [curMin, curMax],
                        step:   Math.round((originalMax - originalMin) * 100) / 10000,
                        slide: function (event, ui) {
                            var settings = $div.data('settings');
                            var unit = !settings.resource || settings.isEuro ? $div.data('currency') : data.unit;

                            $div._rangeTimer && clearTimeout($div._rangeTimer);
                            localStorage.setItem(instance + '_' + settings.resource + '_' + unit + '_min', ui.values[0]);
                            localStorage.setItem(instance + '_' + settings.resource + '_' + unit + '_max', ui.values[1]);

                            $div.find('.slider-range-min').text((Math.round(parseFloat(ui.values[0]) * 100) / 100).toString().replace('.', '.') + (unit ? ' ' : unit));
                            $div.find('.slider-range-max').text((Math.round(parseFloat(ui.values[1]) * 100) / 100).toString().replace('.', '.') + (unit ? ' ' : unit));

                            $div._rangeTimer = setTimeout(function () {
                                $div._rangeTimer = null;
                                var settings = $div.data('settings');
                                vis.binds.consumption.renderHeatMap($div, $report, settings, data);
                            }, 300);
                        }
                    });
                } else if (!$div._rangeTimer) {
                    $showHeatMapRange.slider('option', 'min', originalMin);
                    $showHeatMapRange.slider('option', 'max', originalMax);
                    $showHeatMapRange.slider('option', 'values', [parseFloat(curMin), parseFloat(curMax)]);
                    $showHeatMapRange.slider('option', 'step', Math.round((originalMax - originalMin) * 100) / 10000);
                }

                $div.find('.slider-range-min').text((Math.round(parseFloat(curMin) * 100) / 100).toString().replace('.', '.') + (unit ? ' ' : unit));
                $div.find('.slider-range-max').text((Math.round(parseFloat(curMax) * 100) / 100).toString().replace('.', '.') + (unit ? ' ' : unit));
            } else {
                var $showHeatMapRangeDiv = $div.find('.slider-range-div');
                //$div.find('.vis-cons-results').css('height', $toolbar.css('display') !== 'none' ? 'calc(100% - 50px)' : '100%');
                $showHeatMapRangeDiv.length && $showHeatMapRangeDiv.remove();
            }

            chart.setOption(option);
        },

        forecastBar: {
            getValue: function (oid) {
                var val = 0;
                if (oid || oid === '0') {
                    if (parseFloat(oid) !== oid) {
                        val = vis.states.attr(oid + '.val');
                    } else {
                        val = parseFloat(oid);
                    }
                    return val;
                } else {
                    return null;
                }
            },
            draw: function ($div, options) {
                var val1     = vis.binds.consumption.forecastBar.getValue(options.reference);
                var val2     = vis.binds.consumption.forecastBar.getValue(options.actual);
                var valLeft  = vis.binds.consumption.forecastBar.getValue(options.forecast);
                var valRight = vis.binds.consumption.forecastBar.getValue(options.planned);

                var max = val1 > val2 ? val1 : val2;
                max = max > valLeft  ? max : valLeft;
                max = max > valRight ? max : valRight;

                var val1Height     = Math.round(val1     / max * 100);
                var val2Height     = Math.round(val2     / max * 100);
                var valLeftHeight  = Math.round(valLeft  / max * 100);
                var valRightHeight = Math.round(valRight / max * 100);

                var color;
                if (val2 < valLeft && (!valRight || (val2 < valRight && valLeft < valRight))) {
                    color = options['color-border'];
                } else {
                    color = options['color-border-error'] || options['color-border'];
                }

                var backColor   = 'repeating-linear-gradient(135deg, ' + color + ', ' + color + ' 2px, rgba(0,0,0,0) 2px, rgba(0,0,0,0) 12px)';
                var $val1 = $div.find('.value-1').css({height: val1Height + '%', 'border-color': color}).attr('title', vis.binds.consumption.format(val1, options.unit, true));
                var $val2 = $div.find('.value-2').css({height: val2Height + '%', 'border-color': color}).attr('title', vis.binds.consumption.format(val2, options.unit, true));
                $div.find('.value-2-inner').css('background', backColor);
                $div.find('.label-value-1').css('top', 'calc(' + (100 - val1Height)  + '% - 5px)').attr('title', vis.binds.consumption.format(val1, options.unit, true));
                $div.find('.label-value-2').css('top', 'calc(' + (100 - val2Height)  + '% - 5px)').attr('title', vis.binds.consumption.format(val2, options.unit, true));

                                    $div.find('.line-left')    .css('top', (100 - valLeftHeight)  + '%');
                var $lineRight =  $div.find('.line-right')   .css('top', (100 - valRightHeight) + '%');

                                    $div.find('.label-left')   .css('top', 'calc(' + (100 - valLeftHeight)  + '% - 8px)').attr('title', vis.binds.consumption.format(valLeft, options.unit, true));
                var $labelRight = $div.find('.label-right')  .css('top', 'calc(' + (100 - valRightHeight) + '% - 8px)').attr('title', vis.binds.consumption.format(valRight, options.unit, true));

                                    $div.find('.arrow-left')   .css('top', 'calc(' + (100 - valLeftHeight)  + '% - 17px)');
                var $arrowRight = $div.find('.arrow-right')  .css('top', 'calc(' + (100 - valRightHeight) + '% - 17px)');

                if (!valRightHeight) {
                    $lineRight.hide();
                    $labelRight.hide();
                    $arrowRight.hide();
                } else {
                    $lineRight.show();
                    $labelRight.show();
                    $arrowRight.show();
                }

                if (val1 > val2) {
                    $val1.css({'z-index': 0, 'border-radius': '8px 8px 0 0'});
                    $val2.css({'z-index': 1, 'border-radius': ''});
                } else {
                    $val1.css({'z-index': 1, 'border-radius': ''});
                    $val2.css({'z-index': 0, 'border-radius': '8px 8px 0 0'});
                }
            },
            init: function ($div, options) {
                var year = new Date().getFullYear();

                var _options = Object.assign({
                    reference: 200, // last year consumption
                    actual:    100, // actual consumption
                    planned:   350, // planned this year
                    forecast:  400, // forecast this year
                    width:     100,
                    height:    200,
                    textColor: 'black',

                    'color-border': 'green',
                    'color-border-error': 'red',
                    title: '',
                    textForecast: _('Forecast'),
                    textPlanned: _('Planned'),
                    textActual: _('Now %s', year),
                    textPrev: year - 1,
                    unit: $div.data('currency')
                }, options);

                var text = '<div style="overflow: visible; width: ' + _options.width + 'px; height: ' + _options.height + 'px; color: ' + _options.textColor + '">\n' +
                    '\t\t<div class="forecast-bar" style="max-width: 100px;" >\n' +
                    '\t\t\t<div   class="value-1" style=""><span>' + _options.textPrev + '</span></div>\n' +
                    '\t\t\t<div   class="value-2" style=""><div class="value-2-inner"><span>' + _options.textActual + '</span></div></div>\n' +
                    '\t\t\t<div   class="label-value-1 forecast-texts"></div>\n' +
                    '\t\t\t<div   class="label-value-2 forecast-texts"></div>\n' +
                    '\n' +
                    '\t\t\t<span  class="check-visibility arrow-left">\n' +
                    '\t\t\t    <svg viewBox="0 0 20 20" style="fill: #DDDDDD; width: 35px; height: auto"><path d="M15,10l-9,5V5L15,10z"/></svg>\n' +
                    '\t\t\t</span>\n' +
                    '\t\t\t<span  class="check-visibility arrow-right">\n' +
                    '\t\t\t    <svg viewBox="0 0 20 20" style="fill: #DDDDDD;width: 35px; height: auto"><path d="M14,5v10l-9-5L14,5z"/></svg>\n' +
                    '\t\t\t</span>\n' +
                    '\t\t\t<div   class="check-visibility line-left"></div>\n' +
                    '\t\t\t<div   class="check-visibility line-right"></div>\n' +
                    '\t\t\t<div   class="check-visibility label-left  forecast-texts">' + _options.textForecast + '</div>\n' +
                    '\t\t\t<div   class="check-visibility label-right forecast-texts">' + _options.textPlanned + '</div>\n' +
                    '\n' +
                    '\t\t\t<div   class="forecast-title forecast-texts"><div class="forecast-title-inner">' + _options.title + '</div></div>\n' +
                    '\t\t</div>\n' +
                    '\t</div>';
                $div.html(text);

                _options.onClick && $div.find('.forecast-texts').css('cursor', 'pointer').on('click', _options.onClick);

                vis.binds.consumption.forecastBar.draw($div, _options);
            }
        },

        renderPlanMain: function ($div, $td, settings, data) {
            var name = (settings.resource || 'all').toLowerCase();
            var stations = $div.data('stations');
            var theme = $div.data('data').colorTheme;
            var textColor = theme === 'dark' ? 'white' : 'black';

            var stationName;
            if (settings.station) {
                for (var i = 0; i < stations.length; i++) {
                    if (stations[i].name === settings.station) {
                        stationName = stations[i].title;
                        break;
                    }
                }
            }
            var isBad = data.series[name].planned && data.series[name].forecast > data.series[name].planned;
            var text = '<div class="vis-cons-plan-main-div-widget" style="color: ' + textColor + '">\n';
            text += '<div class="vis-cons-plan-main-div-widget-title">'     + _('Costs for %s', stationName) + '</div>\n';
            text += '<div class="vis-cons-plan-main-div-widget-actual">'    + _('Actual') + ': ' +  vis.binds.consumption.format(data.series[name].actual, data.unit) + '</div>\n';
            text += '<div class="vis-cons-plan-main-div-widget-reference">' + _('Reference') + ': ' + (data.series[name].reference ? vis.binds.consumption.format(data.series[name].reference, data.unit) : '--') + '</div>\n';
            text += '<img class="vis-cons-plan-main-div-widget-icon vis-cons-plan-main-div-widget-icon-' + (isBad ? 'bad' : 'good') + '" src="widgets/consumption/img/' + (isBad ? 'smileBad.svg' : 'smile.svg') + '"/>\n';
            text += '<div class="vis-cons-plan-main-div-widget-forecast">'  + _('Forecast') + ': ' +  vis.binds.consumption.format(data.series[name].forecast, data.unit) + '</div>\n';
            text += '<div class="vis-cons-plan-main-div-widget-planned">'   + _('Planned') + ': ' +  vis.binds.consumption.format(data.series[name].planned, data.unit) + '</div>\n';
            text += '</div>';

            $td.html(text);
        },

        renderCharts: function ($div, $report, settings, data) {
            var $iframe = $report.find('.charts-iframe');
            if (!$iframe.length) {
                var text = '<iframe class="charts-iframe" border="0" src="" style="width: 100%; height: 100%"/>';
                $report.innerHTML(text);
                $iframe = $report.find('.charts-iframe');
            }
            var src;
            if (settings.resource) {
                src = '../echarts/index.html#preset=echarts.0._consumption_.' + settings.station + '.' + settings.resource + '&noBG=true';
            } else {
                src = '../echarts/index.html#preset=echarts.0._consumption_.' + settings.station + '.all&noBG=true';
            }

            $iframe.attr('src', src);
        }
    };

    vis.binds.consumption.showVersion();

</script>

<script id="tplConsumption"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/consumption/img/Prev_tplConsumption.png"></img>'
        data-vis-set="consumption"
        data-vis-type="ctrl"
        data-vis-name="Charts"
        data-vis-attrs="consInstance[0]/number,0,5;colorTheme[light]/nselect,light,dark;ownClasses[false]/checkbox;"
        data-vis-attrs0="startsFrom[2020-01-01];dateFormat[yy-mm-dd];consumption_station;currency;"
        data-vis-attrs1="group.consumption_types;hide_planning/checkbox;hide_pie/checkbox;hide_stackbar/checkbox;hide_heatmap/checkbox;hide_table/checkbox;hide_charts/checkbox;show_heatmap_range/checkbox;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 600px; height: 450px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="display: inline-block" <%= (el) -> vis.binds.consumption.init(el, this.data.wid, this.view, this.data, this.style) %> ></div>
    </div>
</script>
<!-- --------------consumption.html--- END -->
<!-- --------------dwd.html--- START -->
<!--
    ioBroker.vis dwd Widget-Set

    version: "2.4.5"

    Copyright 2013-2020 bluefox<dogafox@gmail.com>
-->

<script type="text/javascript">
    if (vis.editMode) {
        // Add words for widgets
        $.extend(true, systemDictionary, {
            "oid-begin":    {"en": "oid-begin",    "de": "oid-begin",    "ru": "oid-begin"},
            "oid-end":      {"en": "oid-end",      "de": "oid-end",      "ru": "oid-end"},
            "oid-headline": {"en": "oid-headline", "de": "oid-headline", "ru": "oid-headline"},
            "oid-severity": {"en": "oid-severity", "de": "oid-severity", "ru": "oid-severity"},
            "dwd-format": {
                "en": "Time format",
                "de": "Zeitformat",
                "ru": "Формат времени",
                "pt": "Formato da hora",
                "nl": "Tijd formaat",
                "fr": "Format de l'heure",
                "it": "Formato orario",
                "es": "Formato de tiempo",
                "pl": "Format czasu",
                "zh-cn": "时间格式"
            }
        });
    }
</script>

<script id="tplDwdAdapterSmall"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="dwd"
        data-vis-prev='<img src="widgets/dwd/img/Prev_DwdAdapterSmall.png"></img>'
        data-vis-name="DWD Wetterwarnungen klein"
        data-vis-attrs="oid[dwd.0.warning.text];oid-severity[dwd.0.warning.severity]">
    <%
    var dwdBackground = [
        "",        // 0
        "#ffeb3b", // 1 - Wetterwarnungen (Stufe 1)
        "#fb8c00", // 2 - Warnungen vor markantem Wetter (Stufe 2)
        "#e53935", // 3 - Unwetterwarnungen (Stufe 3)
        "#880e4f", // 4 - Warnungen vor extremem Unwetter (Stufe 4)
        "",        // 5 -
        "",        // 6 -
        "",        // 7 -
        "",        // 8 -
        "#c99afe", // 9 - Hitzewarnung
        "",        // 10
        "#c9f",    // 11 - Keine Warnungen
        "",        // 12 -
        "",        // 13 -
        "",        // 14 -
        "",        // 15 -
        "",        // 16 -
        "",        // 17 -
        "",        // 18 -
        "#fe68fe", // 19 - UV-Warnung
        "",        // 20 -
	"",        // 21 -
	"",        // 22 -
	"",        // 23 -
	"",        // 24 -
	"",        // 25 -
	"",        // 26 -
	"",        // 27 -
	"",        // 28 -
	"",        // 29 -
	"",        // 30 -
	"",        // 31 -
	"",        // 32 -
	"",        // 33 -
	"",        // 34 -
	"",        // 35 -
	"",        // 36 -
	"",        // 37 -
	"",        // 38 -
	"",        // 39 -
	"",        // 40 -
	"",        // 41 -
	"",        // 42 -
	"",        // 43 -
	"",        // 44 -
	"",        // 45 -
	"",        // 46 -
	"",        // 47 -
	"",        // 48 -
	"#e966fe", // 49 - starke Hitze
	"#f933fe", // 50 - extreme Hitze
	"",        // 51
    ];
    %>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 160px; height: 21px; font-family: Arial" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="padding: 3px; background-color: <%= dwdBackground[parseInt(vis.states.attr(this.data['oid-severity'] + '.val'), 10)] %>;">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== vis.states.attr(this.data.oid + '.val') %>
            </div>
        </div>
    </div>
</script>

<script id="tplDwdAdapter"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/dwd/img/Prev_DwdAdapter.png"></img>'
        data-vis-set="dwd"
        data-vis-name="DWD Wetterwarnungen"
        data-vis-attrs="oid-begin[dwd.0.warning.begin];oid-end[dwd.0.warning.end];oid-headline[dwd.0.warning.headline];oid[dwd.0.warning.description];oid-severity[dwd.0.warning.severity];dwd-format[DD.MM hh:mm]">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 585px; height: 85px; font-family: Arial" id="<%= this.data.attr('wid') %>">
        <%
		var dwdBackground = [
        	"",        // 0
        	"#ffeb3b", // 1 - Wetterwarnungen (Stufe 1)
        	"#fb8c00", // 2 - Warnungen vor markantem Wetter (Stufe 2)
        	"#e53935", // 3 - Unwetterwarnungen (Stufe 3)
        	"#880e4f", // 4 - Warnungen vor extremem Unwetter (Stufe 4)
        	"",        // 5 -
        	"",        // 6 -
        	"",        // 7 -
        	"",        // 8 -
        	"#c99afe", // 9 - Hitzewarnung
        	"",        // 10
        	"#c9f",    // 11 - Keine Warnungen
        	"",        // 12 -
        	"",        // 13 -
        	"",        // 14 -
        	"",        // 15 -
        	"",        // 16 -
        	"",        // 17 -
        	"",        // 18 -
        	"#fe68fe", // 19 - UV-Warnung
        	"",        // 20 -
		"",        // 21 -
		"",        // 22 -
		"",        // 23 -
		"",        // 24 -
		"",        // 25 -
		"",        // 26 -
		"",        // 27 -
		"",        // 28 -
		"",        // 29 -
		"",        // 30 -
		"",        // 31 -
		"",        // 32 -
		"",        // 33 -
		"",        // 34 -
		"",        // 35 -
		"",        // 36 -
		"",        // 37 -
		"",        // 38 -
		"",        // 39 -
		"",        // 40 -
		"",        // 41 -
		"",        // 42 -
		"",        // 43 -
		"",        // 44 -
		"",        // 45 -
		"",        // 46 -
		"",        // 47 -
		"",        // 48 -
		"#e966fe", // 49 - starke Hitze
		"#f933fe", // 50 - extreme Hitze
		"",        // 51
    ];
        %>
        <div class="vis-widget-body" style="padding: 3px; background-color: <%= dwdBackground[parseInt(vis.states.attr(this.data['oid-severity'] + '.val'), 10)] %>;">
            <div style="font-size: 1.5em; font-weight: bold;" data-oid="<%= this.data.attr('oid-headline') %>">
                <%== vis.states.attr(this.data['oid-headline'] + '.val') %>
            </div>
            <p><%== vis.states.attr(this.data['oid'] + '.val') %><br/>
            <%== vis.states.attr(this.data['oid-begin'] + '.val') ? vis.binds.basic.formatDate(vis.states.attr(this.data['oid-begin'] + '.val'), this.data['dwd-format']) + ' - ' : '' %><%== vis.states.attr(this.data['oid-end'] + '.val') ? vis.binds.basic.formatDate(vis.states.attr(this.data['oid-end'] + '.val'), this.data['dwd-format']) : '' %></p>
        </div>
    </div>
</script>

<!-- --------------dwd.html--- END -->
<!-- --------------echarts.html--- START -->
<!--
    ioBroker.echarts high quality Widget-Set

    version: "1.0.5"

    Copyright 2019-2020 bluefox <dogafox@gmail.com>

-->
<script type="text/javascript" >
    if (vis.editMode) {
        $.extend(true, systemDictionary, {
            "echart_oid": {
                "en": "EChart ID",
                "de": "EChart ID",
                "ru": "EChart ID",
                "pt": "EChart ID",
                "nl": "EChart ID",
                "fr": "ID de graphique",
                "it": "ID EChart",
                "es": "EChart ID",
                "pl": "Identyfikator EChart",
                "zh-cn": "图表ID"
            },
            "noChartBackground": {
                "en": "No background",
                "de": "Kein Hintergrund",
                "ru": "Без фона",
                "pt": "Sem fundo",
                "nl": "Geen achtergrond",
                "fr": "Pas de fond",
                "it": "Nessuno sfondo",
                "es": "Sin antecedentes",
                "pl": "Bez tła",
                "zh-cn": "没有背景"
            },
        });
    }
</script>

<script id="tplEchartsChart"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="echarts"
        data-vis-name="Chart"
        data-vis-type="chart"
        data-vis-prev='<img src="widgets/echarts/img/Prev_tplEchartsChart.png"/>'
        data-vis-attrs="echart_oid[nothing_selected]/id/filterTypeChart;noChartBackground/checkbox;"
        data-vis-filter="chart">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px; border-radius: 64px" id="<%= this.data.attr('wid') %>">
         <iframe style="width: 100%; height: 100%; border: 0" src="../echarts/index.html?preset=<%== this.data.attr('echart_oid') %>&noBG=<%== this.data.attr('noChartBackground') %>"></iframe>
    </div>
</script>
<!-- --------------echarts.html--- END -->
<!-- --------------eventlist.html--- START -->
<!--
    ioBroker.vis eventlist Widget-Set

    version: "0.5.4"

    Copyright 2020 ioBroker dogafox@gmail.com
-->

<link rel="stylesheet" href="widgets/eventlist/css/style.css" />

<script type="text/javascript">
    'use strict';

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            // Bars
            "eventlistInstance":              {
                "en": "Instance",
                "de": "Instanz",
                "ru": "Инстанция",
                "pt": "Instância",
                "nl": "Instance",
                "fr": "Instance",
                "it": "Instance",
                "es": "Instance",
                "pl": "Instancja",
                "zh-cn": "实例"
            },
            "showEventTime": {
                "en": "Time",
                "de": "Zeit",
                "ru": "Время",
                "pt": "Tempo",
                "nl": "Tijd",
                "fr": "Temps",
                "it": "Tempo",
                "es": "Hora",
                "pl": "Czas",
                "zh-cn": "时间"
            },
            "showEventValue": {
                "en": "Value",
                "de": "Wert",
                "ru": "Значение",
                "pt": "Valor",
                "nl": "Waarde",
                "fr": "Valeur",
                "it": "Valore",
                "es": "Valor",
                "pl": "Wartość",
                "zh-cn": "值"
            },
            "showEventDuration": {
                "en": "Duration",
                "de": "Dauer",
                "ru": "Продолжительность",
                "pt": "Duração",
                "nl": "Looptijd",
                "fr": "Durée",
                "it": "Durata",
                "es": "Duración",
                "pl": "Trwanie",
                "zh-cn": "持续时间"
            },
            "textEventEvent": {
                "en": "Event",
                "de": "Ereignis",
                "ru": "Мероприятие",
                "pt": "Evento",
                "nl": "Evenement",
                "fr": "un événement",
                "it": "Evento",
                "es": "Evento",
                "pl": "Zdarzenie",
                "zh-cn": "事件"
            },
            "textEventTime": {
                "en": "Time",
                "de": "Zeit",
                "ru": "Время",
                "pt": "Tempo",
                "nl": "Tijd",
                "fr": "Temps",
                "it": "Tempo",
                "es": "Hora",
                "pl": "Czas",
                "zh-cn": "时间"
            },
            "textEventValue": {
                "en": "Value",
                "de": "Wert",
                "ru": "Значение",
                "pt": "Valor",
                "nl": "Waarde",
                "fr": "Valeur",
                "it": "Valore",
                "es": "Valor",
                "pl": "Wartość",
                "zh-cn": "值"
            },
            "textEventDuration": {
                "en": "Duration",
                "de": "Dauer",
                "ru": "Продолжительность",
                "pt": "Duração",
                "nl": "Looptijd",
                "fr": "Durée",
                "it": "Durata",
                "es": "Duración",
                "pl": "Trwanie",
                "zh-cn": "持续时间"
            },
            'group_headerTitle': {
                "en": "Header texts",
                "de": "Kopfzeilentexte",
                "ru": "Тексты заголовков",
                "pt": "Textos de cabeçalho",
                "nl": "Kopteksten",
                "fr": "Textes d'en-tête",
                "it": "Testi di intestazione",
                "es": "Textos de encabezado",
                "pl": "Teksty nagłówka",
                "zh-cn": "标题文字"
            },
            "widthEventEvent": {
                "en": "Event",
                "de": "Ereignis",
                "ru": "Мероприятие",
                "pt": "Evento",
                "nl": "Evenement",
                "fr": "un événement",
                "it": "Evento",
                "es": "Evento",
                "pl": "Zdarzenie",
                "zh-cn": "事件"
            },
            "widthEventTime": {
                "en": "Time",
                "de": "Zeit",
                "ru": "Время",
                "pt": "Tempo",
                "nl": "Tijd",
                "fr": "Temps",
                "it": "Tempo",
                "es": "Hora",
                "pl": "Czas",
                "zh-cn": "时间"
            },
            "widthEventValue": {
                "en": "Value",
                "de": "Wert",
                "ru": "Значение",
                "pt": "Valor",
                "nl": "Waarde",
                "fr": "Valeur",
                "it": "Valore",
                "es": "Valor",
                "pl": "Wartość",
                "zh-cn": "值"
            },
            "widthEventDuration": {
                "en": "Duration",
                "de": "Dauer",
                "ru": "Продолжительность",
                "pt": "Duração",
                "nl": "Looptijd",
                "fr": "Durée",
                "it": "Durata",
                "es": "Duración",
                "pl": "Trwanie",
                "zh-cn": "持续时间"
            },
            "group_headerWidths": {
                "en": "Columns widths",
                "de": "Spaltenbreiten",
                "ru": "Ширина столбцов",
                "pt": "Larguras das colunas",
                "nl": "Kolombreedtes",
                "fr": "Largeurs de colonnes",
                "it": "Larghezze delle colonne",
                "es": "Anchos de columnas",
                "pl": "Szerokość kolumn",
                "zh-cn": "列宽"
            },
            "eventListSampleEvent": {
                "en": "Temperature outside changed to",
                "de": "Außentemperatur auf geändert",
                "ru": "Температура снаружи изменилась на",
                "pt": "A temperatura externa mudou para",
                "nl": "Temperatuur buiten veranderd naar",
                "fr": "Température extérieure modifiée à",
                "it": "La temperatura esterna è cambiata a",
                "es": "La temperatura exterior cambió a",
                "pl": "Temperatura na zewnątrz zmieniona na",
                "zh-cn": "外界温度更改为"
            },
            "alignEventEvent": {
                "en": "Event",
                "de": "Ereignis",
                "ru": "Мероприятие",
                "pt": "Evento",
                "nl": "Evenement",
                "fr": "un événement",
                "it": "Evento",
                "es": "Evento",
                "pl": "Zdarzenie",
                "zh-cn": "事件"
            },
            "alignEventTime": {
                "en": "Time",
                "de": "Zeit",
                "ru": "Время",
                "pt": "Tempo",
                "nl": "Tijd",
                "fr": "Temps",
                "it": "Tempo",
                "es": "Hora",
                "pl": "Czas",
                "zh-cn": "时间"
            },
            "alignEventValue": {
                "en": "Value",
                "de": "Wert",
                "ru": "Значение",
                "pt": "Valor",
                "nl": "Waarde",
                "fr": "Valeur",
                "it": "Valore",
                "es": "Valor",
                "pl": "Wartość",
                "zh-cn": "值"
            },
            "alignEventDuration": {
                "en": "Duration",
                "de": "Dauer",
                "ru": "Продолжительность",
                "pt": "Duração",
                "nl": "Looptijd",
                "fr": "Durée",
                "it": "Durata",
                "es": "Duración",
                "pl": "Trwanie",
                "zh-cn": "持续时间"
            },
            "group_headerAligns": {
                "en": "Align columns",
                "de": "Spalten ausrichten",
                "ru": "Выровнять столбцы",
                "pt": "Alinhar colunas",
                "nl": "Lijn kolommen uit",
                "fr": "Aligner les colonnes",
                "it": "Allinea le colonne",
                "es": "Alinear columnas",
                "pl": "Wyrównaj kolumny",
                "zh-cn": "对齐列"
            },
            "showScroll": {
                "en": "Show scroll",
                "de": "Schriftrolle anzeigen",
                "ru": "Показать прокрутку",
                "pt": "Mostrar pergaminho",
                "nl": "Toon scroll",
                "fr": "Afficher le défilement",
                "it": "Mostra scorrimento",
                "es": "Mostrar desplazamiento",
                "pl": "Pokaż przewijanie",
                "zh-cn": "显示滚动"
            },
            "defaultStyle": {
                "en": "Default style",
                "de": "Standardstil",
                "ru": "Стиль по умолчанию",
                "pt": "Estilo padrão",
                "nl": "Standaard stijl",
                "fr": "Style par défaut",
                "it": "Stile predefinito",
                "es": "Estilo por Defecto",
                "pl": "Domyślny styl",
                "zh-cn": "默认样式"
            },
            "center": {
                "en": "center",
                "de": "Center",
                "ru": "по центру",
                "pt": "сentro",
                "nl": "centrum",
                "fr": "centre",
                "it": "centro",
                "es": "centrar",
                "pl": "środek",
                "zh-cn": "中央"
            },
            defaultStyle_tooltip: {
                "en": "You can overload following classes: event-table for table, event-table-header for header",
                "de": "Sie können folgende Klassen überladen: event-table für table, event-table-header für header",
                "ru": "Вы можете перегрузить следующие классы: event-table для таблицы, event-table-header для заголовка.",
                "pt": "Você pode sobrecarregar as seguintes classes: event-table para a tabela, event-table-header` para o cabeçalho",
                "nl": "U kunt de volgende klassen overbelasten: event-table voor tabel, event-table-header` voor header",
                "fr": "Vous pouvez surcharger les classes suivantes: event-table pour la table, event-table-header` pour l'en-tête",
                "it": "Puoi sovraccaricare le seguenti classi: event-table per table, event-table-header` per header",
                "es": "Puede sobrecargar las siguientes clases: event-table para la tabla, event-table-header` para el encabezado",
                "pl": "Możesz przeciążać następujące klasy: event-table dla tabeli, event-table-header` dla nagłówka",
                "zh-cn": "您可以重载以下类：表的“事件表”，标头的“事件表头”"
            },
            "oddBackground": {
                "en": "Odd line background",
                "de": "Ungerader Hintergrund",
                "ru": "Фон нечетной линии",
                "pt": "Fundo de linha ímpar",
                "nl": "Oneven lijn achtergrond",
                "fr": "Arrière-plan de ligne impaire",
                "it": "Sfondo di linea dispari",
                "es": "Fondo de línea impar",
                "pl": "Dziwna linia tła",
                "zh-cn": "奇数线背景"
            },
            "evenBackground": {
                "en": "Even line background",
                "de": "Gerade Hintergrund",
                "ru": "Фон четной линии",
                "pt": "Plano de fundo de linha uniforme",
                "nl": "Zelfs lijnachtergrond",
                "fr": "Fond de ligne uniforme",
                "it": "Anche lo sfondo della linea",
                "es": "Fondo de línea uniforme",
                "pl": "Równe tło linii",
                "zh-cn": "偶数线背景"
            },
            "filterById": {
                "en": "Filter IDs",
                "de": "Filter-IDs",
                "ru": "Идентификаторы фильтра",
                "pt": "IDs de filtro",
                "nl": "Filter-ID's",
                "fr": "ID de filtre",
                "it": "ID filtro",
                "es": "ID de filtro",
                "pl": "Filtruj identyfikatory",
                "zh-cn": "过滤器ID"
            },
            filterById_tooltip: {
                "en": "You can provide multiple IDs divided by comma.",
                "de": "Sie können mehrere durch Komma getrennte IDs angeben.",
                "ru": "Вы можете указать несколько идентификаторов, разделенных запятыми.",
                "pt": "Você pode fornecer vários IDs divididos por vírgula.",
                "nl": "U kunt meerdere ID's opgeven, gescheiden door komma's.",
                "fr": "Vous pouvez fournir plusieurs ID séparés par une virgule.",
                "it": "Puoi fornire più ID divisi da virgole.",
                "es": "Puede proporcionar varios ID divididos por comas.",
                "pl": "Możesz podać wiele identyfikatorów rozdzielonych przecinkami.",
                "zh-cn": "您可以提供多个ID，以逗号分隔。"
            }
        });
    }

    $.extend(true, systemDictionary, {
        "eventtableTime": {
            "en": "Time",
            "de": "Zeit",
            "ru": "Время",
            "pt": "Tempo",
            "nl": "Tijd",
            "fr": "Temps",
            "it": "Tempo",
            "es": "Hora",
            "pl": "Czas",
            "zh-cn": "时间"
        },
        "eventtableValue": {
            "en": "Value",
            "de": "Wert",
            "ru": "Значение",
            "pt": "Valor",
            "nl": "Waarde",
            "fr": "Valeur",
            "it": "Valore",
            "es": "Valor",
            "pl": "Wartość",
            "zh-cn": "值"
        },
        "eventtableEvent": {
            "en": "Event",
            "de": "Ereignis",
            "ru": "Мероприятие",
            "pt": "Evento",
            "nl": "Evenement",
            "fr": "un événement",
            "it": "Evento",
            "es": "Evento",
            "pl": "Zdarzenie",
            "zh-cn": "事件"
        },
        "eventtableDuration": {
            "en": "Duration",
            "de": "Dauer",
            "ru": "Продолжительность",
            "pt": "Duração",
            "nl": "Looptijd",
            "fr": "Durée",
            "it": "Durata",
            "es": "Duración",
            "pl": "Trwanie",
            "zh-cn": "持续时间"
        }
    });

    vis.binds.eventlist = {
        version: "0.5.4",
        showVersion: function () {
            if (vis.binds.eventlist.version) {
                console.log('Version eventlist: ' + vis.binds.eventlist.version);
                vis.binds.eventlist.version = null;
            }
        },
        renderHeader(el, wid, view, data) {
            var text = '<tr class="' + (data.defaultStyle ? 'event-table-header' : '') + '">';
            if (data.showEventTime || data.showEventTime === undefined) {
                text += '<th width="' + data.widthEventTime + '" style="text-align: ' + data.alignEventTime + '">' + (data.textEventTime === '_' || data.textEventTime === undefined ? _('eventtableTime') : data.textEventTime) + '</th>';
            }
            text += '<th width="' + data.widthEventEvent + '" style="text-align: ' + data.alignEventEvent + '">' + (data.textEventEvent === '_' || data.textEventEvent === undefined ? _('eventtableEvent') : data.textEventEvent) + '</th>';
            if (data.showEventValue || data.showEventValue === undefined) {
                text += '<th width="' + data.widthEventValue + '" style="text-align: ' + data.alignEventValue + '">' + (data.textEventValue === '_' || data.textEventValue === undefined ? _('eventtableValue') : data.textEventValue) + '</th>';
            }
            if (data.showEventDuration || data.showEventDuration === undefined) {
                text += '<th width="' + data.widthEventDuration + '" style="text-align: ' + data.alignEventDuration + '">' + (data.textEventDuration === '_' || data.textEventDuration === undefined ? _('eventtableDuration') : data.textEventDuration) + '</th>';
            }
            text += '</tr>\n';
            return text;
        },
        renderRow(el, wid, view, data, json, i) {
            var item = json[i];
            var style = [];
            if (item._style) {
                var attrs = Object.keys(item._style);
                for (var t = 0; t < attrs.length; t++) {
                    style.push(attrs[t] + ': ' + item._style[attrs[t]]);
                }
            }
            if ((i % 2) && data.oddBackground) {
                style.push('background: ' + data.oddBackground);
            } else if (!(i % 2) && data.evenBackground) {
                style.push('background: ' + data.evenBackground);
            }

            var line = '<tr style="' + style.join('; ') + '">';
            if (data.showEventTime) {
                line += '<td style="text-align: ' + data.alignEventTime + '">' + item.ts + '</td>';
            }
            line += '<td style="text-align: ' + data.alignEventEvent + '">' + item.event + '</td>';
            if (data.showEventValue) {
                line += '<td style="text-align: ' + data.alignEventValue + '">' + (item.val === undefined || item.val === null ? '' : item.val) + '</td>';
            }
            if (data.showEventDuration) {
                line += '<td style="text-align: ' + data.alignEventDuration + '">' + (item.duration === undefined || item.duration === null ? '' : item.duration) + '</td>';
            }
            line += '</tr>\n';
            return line;
        },
        state2json(state) {
            state = state || {};
            let table = state.val || [];

            if (typeof table !== 'object') {
                try {
                    table = JSON.parse(table);
                } catch (e) {
                    console.warn('Cannot parse event list: "' + table + '"');
                    table = [];
                }
            }

            table = table || [];

            return table;
        },
        renderTable(el, wid, view, data, style, json, filterById) {
            var table = '<table style="width: 100%;" class="' + (data.defaultStyle || data.defaultStyle === undefined ? 'event-table' : '') + '"><tbody style="width: 100%;">'
            table += vis.binds.eventlist.renderHeader(el, wid, view, data);
            for (var i = 0; i < json.length; i++) {
                if (!data.max_rows || i < data.max_rows) {
                    if (!filterById || filterById.indexOf(json[i].id) !== -1) {
                        table += vis.binds.eventlist.renderRow(el, wid, view, data, json, i);
                    }
                } else {
                    break;
                }
            }

            table += '</tbody></table>\n';
            return table;
        },
        subscribes: [],
        init: function (el, wid, view, data, style) {
            var $div = $('#' + wid);
            if (!$div.length) {
                return setTimeout(function () {
                    vis.binds.eventlist.init(el, wid, view, data, style);
                }, 100);
            }
            data.max_rows = parseInt(data.max_rows, 10) || 0;
            data.widthEventTime     = data.widthEventTime     === parseFloat(data.widthEventTime).toString()     ? data.widthEventTime     + 'px' : data.widthEventTime || '';
            data.widthEventEvent    = data.widthEventEvent    === parseFloat(data.widthEventEvent).toString()    ? data.widthEventEvent    + 'px' : data.widthEventEvent || '';
            data.widthEventValue    = data.widthEventValue    === parseFloat(data.widthEventValue).toString()    ? data.widthEventValue    + 'px' : data.widthEventValue || '';
            data.widthEventDuration = data.widthEventDuration === parseFloat(data.widthEventDuration).toString() ? data.widthEventDuration + 'px' : data.widthEventDuration || '';
            data.showEventTime      = data.showEventTime      === undefined ? true : data.showEventTime;
            data.showEventValue     = data.showEventValue     === undefined ? true : data.showEventValue;
            data.showEventDuration  = data.showEventDuration  === undefined ? true : data.showEventDuration;

            if (data.showScroll) {
                $div.css('overflow-y', 'auto');
            }

            var jsonID = 'eventlist.' + (parseInt(data.eventlistInstance, 10) || 0) + '.eventJSONList';

            vis.conn.getStates(jsonID, (err, state) => {
                var json = vis.binds.eventlist.state2json(state[jsonID]);

                var filterById = (data.filterById || '').trim();
                if (filterById) {
                    var parts = filterById.split(',');
                    filterById = [];
                    for (var p = 0; p < parts.length; p++) {
                        if (parts[p].trim() && filterById.indexOf(parts[p].trim()) === -1) {
                            filterById.push(parts[p]);
                        }
                    }
                    if (!filterById.length) {
                        filterById = null;
                    }
                }

                if (vis.editMode && !json.length) {
                    json.push({
                        ts: new Date().toLocaleTimeString(),
                        val: '5°C',
                        event: _('eventListSampleEvent'),
                        duration: '1h 2s'
                    });
                }

                var text = vis.binds.eventlist.renderTable(el, wid, view, data, style, json, filterById);
                $div.html(text);

                function onChange(wid, id, newVal) {
                    if (id === jsonID) {
                        var json = vis.binds.eventlist.state2json({val: newVal});
                        var text = vis.binds.eventlist.renderTable(el, wid, view, data, style, json, filterById);
                        $div.html(text);
                    }
                }

                if (vis.binds.eventlist.subscribes[jsonID]) {
                    vis.binds.eventlist.subscribes[jsonID]++;
                } else {
                    vis.binds.eventlist.subscribes[jsonID] = 1;
                    vis.conn.subscribe(jsonID);
                    console.log('Subscribe on ' + jsonID);
                }

                vis.registerOnChange(onChange, jsonID);

                $div.data('destroy', function () {
                    if (vis.binds.eventlist.subscribes[jsonID]) {
                        vis.binds.eventlist.subscribes[jsonID]--;
                        if (!vis.binds.eventlist.subscribes[jsonID]) {
                            console.log('Unsubscribe on ' + jsonID);
                            vis.conn.unsubscribe(jsonID);
                            delete vis.binds.eventlist.subscribes[jsonID];
                        }
                        vis.unregisterOnChange(onChange, jsonID);
                    }
                });
            });
        },
        button: function (el, wid, view, data, style) {
            var $div = $('#' + wid);
            if (!$div.length) {
                return setTimeout(function () {
                    vis.binds.eventlist.button(el, wid, view, data, style);
                }, 100);
            }

            var jsonID = 'eventlist.' + (parseInt(data.eventlistInstance, 10) || 0) + '.triggerPDF';

            if (!data.no_style) {
                $div.addClass('ui-state-default').button();
                $div.find('.ui-button-text').css({width: '100%', height: '100%'});
            }
            if (!vis.editMode) {
                $div.off('click').on('click', function () {
                    vis.setValue(jsonID, true);
                    setTimeout(function () {
                        vis.conn.getStates([jsonID], function (error, data) {
                            if (error) {
                                vis.showError(error);
                            } else if (data[jsonID] && data[jsonID].ack && !data[jsonID].val) {
                                window.open('../eventlist/report.pdf?q=' + Date.now(), 'PDF');
                            } else {
                                setTimeout(function () {
                                    window.open('../eventlist/report.pdf?q=' + Date.now(), 'PDF');
                                }, 500);
                            }
                        });
                    }, 100);
                });
            }
        }
    };

    vis.binds.eventlist.showVersion();
</script>

<script id="tplEventlist"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="eventlist"
        data-vis-type="json,table"
        data-vis-name="Events"
        data-vis-prev='<img src="widgets/eventlist/img/Prev_Eventlist.png"></img>'
        data-vis-attrs="eventlistInstance[0]/instance,eventlist;"
        data-vis-attrs0="max_rows/number;defaultStyle[true]/checkbox;defaultStyle[true]/checkbox;filterById/id;oddBackground/color;evenBackground/color;"
        data-vis-attrs1="group.header;showEventTime[true]/checkbox;showEventValue[true]/checkbox;showEventDuration[false]/checkbox;"
        data-vis-attrs2="group.headerTitle;textEventTime[_];textEventEvent[_];textEventValue[_];textEventDuration[_];"
        data-vis-attrs3="group.headerWidths;widthEventTime;widthEventEvent;widthEventValue;widthEventDuration;"
        data-vis-attrs4="group.headerAligns;alignEventTime[right]/select,left,right,center;alignEventEvent[right]/select,left,right,center;alignEventValue[right]/select,left,right,center;alignEventDuration[right]/select,left,right,center;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width: 300px; height: 150px; overflow-x: hidden; overflow-y: auto">
        <div class="vis-widget-body" style="display: inline-block" <%= (el) -> vis.binds.eventlist.init(el, this.data.wid, this.view, this.data, this.style) %> ></div>
    </div>
</script>

<script id="tplEventlistButton"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="eventlist"
        data-vis-type="button"
        data-vis-name="PDF"
        data-vis-prev='<img src="widgets/eventlist/img/Prev_EventlistButton.png"></img>'
        data-vis-attrs="eventlistInstance[0]/instance,eventlist;src/image;imageHeight/slider,0,200,1;alt;text[PDF];no_style/checkbox">
    <div
        class="vis-widget ui-widget ui-button ui-corner-all <%== this.data.attr('class') %>"
        style="width: 100px; height: 37px; z-index: 1;"
        id="<%= this.data.attr('wid') %>"
        <%= (el) -> vis.binds.eventlist.button(el, this.data.wid, this.view, this.data, this.style) %>
    >
        <div class="vis-widget-body"><img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %></div>
    </div>
</script>
<!-- --------------eventlist.html--- END -->
<!-- --------------google-fonts.html--- START -->
<!--
ioBroker.vis google fonts Widget-Set

version: "1.0.0"

Copyright 2015-2021 bluefox<dogafox@gmail.com>

-->
<style>
/* following text generated automatically -- START STYLE--*/
@font-face {
	font-family: Alegreya-Black;
	src: url(widgets/google-fonts/fonts/Alegreya/Alegreya-Black.ttf);
}
@font-face {
	font-family: Alegreya-BlackItalic;
	src: url(widgets/google-fonts/fonts/Alegreya/Alegreya-BlackItalic.ttf);
}
@font-face {
	font-family: Alegreya-Bold;
	src: url(widgets/google-fonts/fonts/Alegreya/Alegreya-Bold.ttf);
}
@font-face {
	font-family: Alegreya-BoldItalic;
	src: url(widgets/google-fonts/fonts/Alegreya/Alegreya-BoldItalic.ttf);
}
@font-face {
	font-family: Alegreya-Italic;
	src: url(widgets/google-fonts/fonts/Alegreya/Alegreya-Italic.ttf);
}
@font-face {
	font-family: Alegreya-Regular;
	src: url(widgets/google-fonts/fonts/Alegreya/Alegreya-Regular.ttf);
}
@font-face {
	font-family: Anton;
	src: url(widgets/google-fonts/fonts/Anton/Anton.ttf);
}
@font-face {
	font-family: Arimo-Bold;
	src: url(widgets/google-fonts/fonts/Arimo/Arimo-Bold.ttf);
}
@font-face {
	font-family: Arimo-BoldItalic;
	src: url(widgets/google-fonts/fonts/Arimo/Arimo-BoldItalic.ttf);
}
@font-face {
	font-family: Arimo-Italic;
	src: url(widgets/google-fonts/fonts/Arimo/Arimo-Italic.ttf);
}
@font-face {
	font-family: Arimo-Regular;
	src: url(widgets/google-fonts/fonts/Arimo/Arimo-Regular.ttf);
}
@font-face {
	font-family: BadScript-Regular;
	src: url(widgets/google-fonts/fonts/Bad_Script/BadScript-Regular.ttf);
}
@font-face {
	font-family: Bangers;
	src: url(widgets/google-fonts/fonts/Bangers/Bangers.ttf);
}
@font-face {
	font-family: Candal;
	src: url(widgets/google-fonts/fonts/Candal/Candal.ttf);
}
@font-face {
	font-family: Comfortaa-Bold;
	src: url(widgets/google-fonts/fonts/Comfortaa/Comfortaa-Bold.ttf);
}
@font-face {
	font-family: Comfortaa-Light;
	src: url(widgets/google-fonts/fonts/Comfortaa/Comfortaa-Light.ttf);
}
@font-face {
	font-family: Comfortaa-Regular;
	src: url(widgets/google-fonts/fonts/Comfortaa/Comfortaa-Regular.ttf);
}
@font-face {
	font-family: DancingScript-Bold;
	src: url(widgets/google-fonts/fonts/Dancing_Script/DancingScript-Bold.ttf);
}
@font-face {
	font-family: DancingScript-Regular;
	src: url(widgets/google-fonts/fonts/Dancing_Script/DancingScript-Regular.ttf);
}
@font-face {
	font-family: IndieFlower;
	src: url(widgets/google-fonts/fonts/Indie_Flower/IndieFlower.ttf);
}
@font-face {
	font-family: Jura-DemiBold;
	src: url(widgets/google-fonts/fonts/Jura/Jura-DemiBold.ttf);
}
@font-face {
	font-family: Jura-Light;
	src: url(widgets/google-fonts/fonts/Jura/Jura-Light.ttf);
}
@font-face {
	font-family: Jura-Medium;
	src: url(widgets/google-fonts/fonts/Jura/Jura-Medium.ttf);
}
@font-face {
	font-family: Jura-Regular;
	src: url(widgets/google-fonts/fonts/Jura/Jura-Regular.ttf);
}
@font-face {
	font-family: Lobster-Regular;
	src: url(widgets/google-fonts/fonts/Lobster/Lobster-Regular.ttf);
}
@font-face {
	font-family: MarckScript-Regular;
	src: url(widgets/google-fonts/fonts/Marck_Script/MarckScript-Regular.ttf);
}
@font-face {
	font-family: Neucha;
	src: url(widgets/google-fonts/fonts/Neucha/Neucha.ttf);
}
@font-face {
	font-family: OpenSans-CondBold;
	src: url(widgets/google-fonts/fonts/Open_Sans_Condensed/OpenSans-CondBold.ttf);
}
@font-face {
	font-family: OpenSans-CondLight;
	src: url(widgets/google-fonts/fonts/Open_Sans_Condensed/OpenSans-CondLight.ttf);
}
@font-face {
	font-family: OpenSans-CondLightItalic;
	src: url(widgets/google-fonts/fonts/Open_Sans_Condensed/OpenSans-CondLightItalic.ttf);
}
@font-face {
	font-family: Pacifico;
	src: url(widgets/google-fonts/fonts/Pacifico/Pacifico.ttf);
}
@font-face {
	font-family: Play-Bold;
	src: url(widgets/google-fonts/fonts/Play/Play-Bold.ttf);
}
@font-face {
	font-family: Play-Regular;
	src: url(widgets/google-fonts/fonts/Play/Play-Regular.ttf);
}
@font-face {
	font-family: PoiretOne-Regular;
	src: url(widgets/google-fonts/fonts/Poiret_One/PoiretOne-Regular.ttf);
}
@font-face {
	font-family: PressStart2P-Regular;
	src: url(widgets/google-fonts/fonts/Press_Start_2P/PressStart2P-Regular.ttf);
}
@font-face {
	font-family: RobotoCondensed-Bold;
	src: url(widgets/google-fonts/fonts/Roboto_Condensed/RobotoCondensed-Bold.ttf);
}
@font-face {
	font-family: RobotoCondensed-BoldItalic;
	src: url(widgets/google-fonts/fonts/Roboto_Condensed/RobotoCondensed-BoldItalic.ttf);
}
@font-face {
	font-family: RobotoCondensed-Italic;
	src: url(widgets/google-fonts/fonts/Roboto_Condensed/RobotoCondensed-Italic.ttf);
}
@font-face {
	font-family: RobotoCondensed-Light;
	src: url(widgets/google-fonts/fonts/Roboto_Condensed/RobotoCondensed-Light.ttf);
}
@font-face {
	font-family: RobotoCondensed-LightItalic;
	src: url(widgets/google-fonts/fonts/Roboto_Condensed/RobotoCondensed-LightItalic.ttf);
}
@font-face {
	font-family: RobotoCondensed-Regular;
	src: url(widgets/google-fonts/fonts/Roboto_Condensed/RobotoCondensed-Regular.ttf);
}
@font-face {
	font-family: RubikMonoOne-Regular;
	src: url(widgets/google-fonts/fonts/Rubik_Mono_One/RubikMonoOne-Regular.ttf);
}
@font-face {
	font-family: RubikOne-Regular;
	src: url(widgets/google-fonts/fonts/Rubik_One/RubikOne-Regular.ttf);
}
@font-face {
	font-family: RuslanDisplay;
	src: url(widgets/google-fonts/fonts/Ruslan_Display/RuslanDisplay.ttf);
}
@font-face {
	font-family: RussoOne-Regular;
	src: url(widgets/google-fonts/fonts/Russo_One/RussoOne-Regular.ttf);
}
@font-face {
	font-family: ShadowsIntoLight;
	src: url(widgets/google-fonts/fonts/Shadows_Into_Light/ShadowsIntoLight.ttf);
}
@font-face {
	font-family: SigmarOne;
	src: url(widgets/google-fonts/fonts/Sigmar_One/SigmarOne.ttf);
}
@font-face {
	font-family: StalinistOne-Regular;
	src: url(widgets/google-fonts/fonts/Stalinist_One/StalinistOne-Regular.ttf);
}
@font-face {
	font-family: Ubuntu-Bold;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-Bold.ttf);
}
@font-face {
	font-family: Ubuntu-BoldItalic;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-BoldItalic.ttf);
}
@font-face {
	font-family: Ubuntu-Italic;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-Italic.ttf);
}
@font-face {
	font-family: Ubuntu-Light;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-Light.ttf);
}
@font-face {
	font-family: Ubuntu-LightItalic;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-LightItalic.ttf);
}
@font-face {
	font-family: Ubuntu-Medium;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-Medium.ttf);
}
@font-face {
	font-family: Ubuntu-MediumItalic;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-MediumItalic.ttf);
}
@font-face {
	font-family: Ubuntu-Regular;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-Regular.ttf);
}

/* following text generated automatically -- END STYLE--*/
</style>


<script>
    "use strict";
    if (vis.editMode) {
        var fonts =
/* following text generated automatically -- START LIST--*/
[
    "Alegreya-Black",
    "Alegreya-BlackItalic",
    "Alegreya-Bold",
    "Alegreya-BoldItalic",
    "Alegreya-Italic",
    "Alegreya-Regular",
    "Anton",
    "Arimo-Bold",
    "Arimo-BoldItalic",
    "Arimo-Italic",
    "Arimo-Regular",
    "BadScript-Regular",
    "Bangers",
    "Candal",
    "Comfortaa-Bold",
    "Comfortaa-Light",
    "Comfortaa-Regular",
    "DancingScript-Bold",
    "DancingScript-Regular",
    "IndieFlower",
    "Jura-DemiBold",
    "Jura-Light",
    "Jura-Medium",
    "Jura-Regular",
    "Lobster-Regular",
    "MarckScript-Regular",
    "Neucha",
    "OpenSans-CondBold",
    "OpenSans-CondLight",
    "OpenSans-CondLightItalic",
    "Pacifico",
    "Play-Bold",
    "Play-Regular",
    "PoiretOne-Regular",
    "PressStart2P-Regular",
    "RobotoCondensed-Bold",
    "RobotoCondensed-BoldItalic",
    "RobotoCondensed-Italic",
    "RobotoCondensed-Light",
    "RobotoCondensed-LightItalic",
    "RobotoCondensed-Regular",
    "RubikMonoOne-Regular",
    "RubikOne-Regular",
    "RuslanDisplay",
    "RussoOne-Regular",
    "ShadowsIntoLight",
    "SigmarOne",
    "StalinistOne-Regular",
    "Ubuntu-Bold",
    "Ubuntu-BoldItalic",
    "Ubuntu-Italic",
    "Ubuntu-Light",
    "Ubuntu-LightItalic",
    "Ubuntu-Medium",
    "Ubuntu-MediumItalic",
    "Ubuntu-Regular"
]
/* following text generated automatically -- END LIST--*/
                ;
        // wait till visEditInspect loaded
        setTimeout(function () {
            for (var f = 0; f < fonts.length; f++) {
                vis.addFont(fonts[f]);
            }
        }, 100);
        vis.binds['google-fonts'] = {
            version: "0.0.1",
            showVersion: function () {
                if (vis.binds['google-fonts'].version) {
                    console.log('Version vis-google-fonts: ' + vis.binds['google-fonts'].version);
                    vis.binds['google-fonts'].version = null;
                }
            }
        };
        vis.binds['google-fonts'].showVersion();
    }
</script>

<!-- --------------google-fonts.html--- END -->
<!-- --------------hqwidgets.html--- START -->
<!--
    ioBroker.vis high quality Widget-Set

    version: "1.1.9"

    Copyright 6'2014-2021 bluefox <dogafox@gmail.com>

-->
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/hqwidgets.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/hqwidgetsButtons.css"/>
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/checkbox.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/glossy.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-car.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-default.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-digital.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-minimal.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-plaza.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-slot-machine.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-train-station.css" />

<script type="text/javascript" src="widgets/hqwidgets/js/jquery.knob.js"></script>
<script type="text/javascript" src="widgets/hqwidgets/js/odometer.min.js"></script>
<script type="text/javascript" src="widgets/hqwidgets/js/hqwidgets.js"></script>

<style>
        .odometer-leading .odometer-inside .odometer-digit:first-child,
        /*, .odometer-leading .odometer-inside .odometer-formatting-mark:nth-child(2),*/
        .odometer-leading .odometer-inside .odometer-digit:last-child {
            display: none
        }
</style>

<script id="tplHqButton"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="On/Off"
        data-vis-update-style="true"
        data-vis-type="ctrl,bool,button,state"
        data-vis-prev='<div id="prev_tplHqButton" style="position: relative; text-align: initial;padding: 10px !important"><div class="vis-widget_prev vis-hq-button-base" style="overflow: visible; width: 64px; height: 64px; border-radius: 64px; left: 543px; top: 37px; position: absolute;"><div class="vis-hq-main vis-hq-button-base-on" style="z-index: 1; border-radius: 64px;"><div class="vis-hq-middle"><table class="vis-hq-table hq-no-space" style="position: absolute; left: 4px; top: 2px;"><tbody><tr class="hq-no-space"><td class="hq-no-space"><div class="vis-hq-icon" style="text-align: center;"><img class="vis-hq-icon-img" style="height: 56px; width: auto;" src="img/bulb_off.png"></div></td></tr></tbody></table></div></div></div></div>'
        data-vis-attrs="oid[nothing_selected]/id/changedButtonId;oid-working;oid-battery;oid-signal;readOnly/checkbox;"
        data-vis-attrs0="group.value;min[false];max[true];pushButton/checkbox;"
        data-vis-attrs1="group.center;caption;captionOn;iconName[img~bulb_off.png]/image;iconOn/image;btIconWidth[56]/slider,0,400,1;offsetAuto[true]/checkbox;leftOffset[15]/slider,0,100,1;topOffset[55]/slider,0,100,1;"
        data-vis-attrs2="group.leftRight;hoursLastAction/nselect,,1,2,3,6,12,24,1024;timeAsInterval[true]/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY/MM/DD hh:mm:ss,hh:mm:ss,hh:mm;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;infoRight;infoFontRightSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;infoRightPaddingLeft/slider,0,100,1;infoRightPaddingRight[15]/slider,0,100,1;"
        data-vis-attrs3="group.styles;styleNormal/style,hqwidgetsButtons glossy,-button,background;styleActive/style,hqwidgetsButtons glossy,-button,background;usejQueryStyle/checkbox;changeEffect/nselect,,waves,wobble,tada,swing,shake,rubberBand,pulse,flash,bounce;waveColor/color;testActive/checkbox;"
        data-vis-attrs4="group.ccontrol;urlTrue;urlFalse;oidTrue/id;oidFalse/id;oidTrueValue;oidFalseValue;"
        data-vis-filter="HM-LC-Sw1-Pl,HM-LC-Sw1-FM,HM-Dis-TD-T,HM-LC-Sw2-FM,HM-LC-Sw1PBU-FM,HM-LC-Sw1-SM,HM-LC-Sw1-FM,HM-LC-Sw2-FM,HM-LC-Sw4-PCB,HM-LC-Sw4-SM,HM-LC-Sw4-DR,HM-LC-Sw4-WM,HM-Sec-SFA-SM,HM-OU-CF-Pl,HM-OU-CFM-Pl,HMW-LC-Sw2-DR,HM-LC-Sw1-PB-FM,HM-LC-Sw2-PB-FM,HMW-IO-12-Sw14-DR,HMW-IO-12-Sw7-DR,HM-ES-PMSw1-Pl">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px; border-radius: 64px" id="<%= this.data.attr('wid') %>"><%
         vis.binds.hqwidgets.button.init(this.data.wid, this.view, this.data, this.style);
    %></div>
</script>

<script id="tplHqDimmer"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="Dimmer"
        data-vis-type="ctrl,dimmer,button"
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_hqwidgetsDimmer.png"></img>'
        data-vis-update-style="true"
        data-vis-attrs="oid[nothing_selected]/id/changedButtonId;oid-working;oid-battery;oid-signal;"
        data-vis-attrs0="group.value;unit[%];min[0];max[100];digits[0]/number;step[1];is_comma[true]/checkbox;"
        data-vis-attrs1="group.center;caption;iconName[img~bulb_off.png]/image;iconOn/image;btIconWidth[56]/slider,0,400,1;offsetAuto[true]/checkbox;leftOffset[15]/slider,0,100,1;topOffset[55]/slider,0,100,1;circleWidth[50]/slider,1,200,1;showValue[true]/checkbox;alwaysShow/checkbox;"
        data-vis-attrs2="group.leftRight;hoursLastAction/nselect,,1,2,3,6,12,24,1024;timeAsInterval[true]/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY/MM/DD hh:mm:ss,hh:mm:ss,hh:mm;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;infoFontRightSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;infoRightPaddingLeft/slider,0,100,1;infoRightPaddingRight[15]/slider,0,100,1;"
        data-vis-attrs3="group.styles;styleNormal/style,hqwidgetsButtons glossy,-button,background;styleActive/style,hqwidgetsButtons glossy,-button,background;usejQueryStyle/checkbox;changeEffect/nselect,,waves,wobble,tada,swing,shake,rubberBand,pulse,flash,bounce;waveColor/color;testActive/checkbox"
        data-vis-filter="light.dimmer">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px; border-radius: 64px" id="<%= this.data.attr('wid') %>"><%
        vis.binds.hqwidgets.button.init(this.data.wid, this.view, this.data, this.style, 'number');
    %></div>
</script>

<script id="tplHqInTemp"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="Inner temperature"
        data-vis-type="ctrl,temperature"
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_hqwidgetsInTemp.png"></img>'
        data-vis-update-style="true"
        data-vis-attrs="oid[nothing_selected]/id,level.temperature/changedTempId;oid-humidity/id,value.humidity;oid-actual/id,value.temperature/changedTemperatureId;oid-drive/id,value.valve;valveBinary/checkbox;valve1/checkbox;oid-battery/id,indicator.battery;"
        data-vis-attrs0="group.value;unit[°C];min[6];max[30];digits[0]/number;step[1];is_comma[true]/checkbox;"
        data-vis-attrs1="group.center;caption;iconName[img~Heating.png]/image;btIconWidth[45]/slider,0,400,1;offsetAuto[true]/checkbox;leftOffset[25]/slider,0,100,1;topOffset[55]/slider,0,100,1;circleWidth[50]/slider,1,100,1;showValue[true]/checkbox;alwaysShow/checkbox;midTextColor/color;"
        data-vis-attrs2="group.leftRight;hoursLastAction/nselect,,1,2,3,6,12,24,1024;timeAsInterval[true]/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY/MM/DD hh:mm:ss,hh:mm:ss,hh:mm;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;infoFontRightSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;infoRightPaddingLeft/slider,0,100,1;infoRightPaddingRight[15]/slider,0,100,1;"
        data-vis-attrs3="group.styles;styleNormal[hq-button-base-intemp]/style,hqwidgetsButtons,-button,background;usejQueryStyle/checkbox;changeEffect/nselect,,waves,wobble,tada,swing,shake,rubberBand,pulse,flash,bounce;waveColor/color;testActive/checkbox;"
        data-vis-attrs4="group.chart;url;dialog_title;dialog_width;dialog_height;dialog_effect/effect;dialog_timeout/number,0,3600000,100;dialog_modal/checkbox;dialog_open/checkbox"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px; border-radius: 64px" id="<%= this.data.attr('wid') %>"><%
        this.data.temperature = true;
        vis.binds.hqwidgets.button.init(this.data.wid, this.view, this.data, this.style, 'number');
    %></div>
</script>

<script id="tplHqOutTemp"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="Outdoor temperature"
        data-vis-type="value,temperature"
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_hqwidgetsOutTemp.png"></img>'
        data-vis-update-style="true"
        data-vis-attrs="oid-actual/id,value.temperature/changedTempId;oid-humidity/id,value.humidity;oid-battery/id,indicator.battery;"
        data-vis-attrs0="group.value;unit[°C];min[6];max[30];digits[0]/number;step[1];is_comma[true]/checkbox;"
        data-vis-attrs1="group.center;caption;iconName[img~Heating.png]/image;btIconWidth[45]/slider,0,400,1;offsetAuto[true]/checkbox;leftOffset[25]/slider,0,100,1;topOffset[55]/slider,0,100,1;circleWidth[50]/slider,1,100,1;showValue[true]/checkbox;alwaysShow/checkbox;midTextColor/color;"
        data-vis-attrs2="group.leftRight;hoursLastAction/nselect,,1,2,3,6,12,24,1024;timeAsInterval[true]/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY/MM/DD hh:mm:ss,hh:mm:ss,hh:mm;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;infoFontRightSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;infoRightPaddingLeft/slider,0,100,1;infoRightPaddingRight[15]/slider,0,100,1;"
        data-vis-attrs3="group.styles;styleNormal[hq-button-base-outtemp]/style,hqwidgetsButtons,-button,background;usejQueryStyle/checkbox;changeEffect/nselect,,waves,wobble,tada,swing,shake,rubberBand,pulse,flash,bounce;waveColor/color;testActive/checkbox;"
        data-vis-attrs4="group.chart;url;dialog_title;dialog_width;dialog_height;dialog_effect/effect;dialog_timeout/number,0,3600000,100;dialog_modal/checkbox;dialog_open/checkbox"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px; border-radius: 64px" id="<%= this.data.attr('wid') %>"><%
        this.data.temperature = true;
        vis.binds.hqwidgets.button.init(this.data.wid, this.view, this.data, this.style, 'number');
    %></div>
</script>

<script id="tplHqShutter"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-type="ctrl;window;shutter"
        data-vis-name="Window and Shutter"
        data-vis-prev='<div id="prev_tplHqShutter" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev hq-blind-base vis-hq-button-base" style="overflow: visible; width: 110px; height: 90px; left: 109px; top: 74px; position: absolute; padding: 3px 4px 2px;"><table class="hq-blind hq-no-space" style="width: 100%; height: 100%"><tbody><tr><td><div class="hq-blind-blind1" style="border-width: 3px;border-color: #a9a7a8;"><div class="hq-blind-blind2" style="border-width: 3px; "><div class="hq-blind-blind3"><table class="hq-no-space" style="width: 100%; height: 100%; position: absolute"><tbody><tr class="hq-no-space hq-blind-position" style="height: 20%"><td class="hq-no-space hq-blind-blind"></td></tr><tr class="hq-no-space"><td class="hq-no-space"></td></tr></tbody></table><div class="hq-blind-blind4" style="border-width: 3px;border-color: #a5aaad;"><div class="hq-blind-handle hq-blind-handle-bg" style="border-width: 1px;top: 50%; width: 3px; height: 15%;left: calc(100% - 5px);"></div></div></div></div></div></td><td><div class="hq-blind-blind1" style="border-width: 3px;border-color: #a9a7a8;"><div class="hq-blind-blind2" style="border-width: 3px; "><div class="hq-blind-blind3"><table class="hq-no-space" style="width: 100%; height: 100%; position: absolute"><tbody><tr class="hq-no-space hq-blind-position" style="height: 20%"><td class="hq-no-space hq-blind-blind"></td></tr><tr class="hq-no-space"><td class="hq-no-space"></td></tr></tbody></table><div class="hq-blind-blind4 hq-blind-blind4-opened-left" style="border-width: 3px;border-color: #a5aaad;"><div class="hq-blind-handle hq-blind-handle-bg" style="border-width: 1px;top: 50%; width: 3px; height: 15%;-moz-transform-origin: 3px 3px;-ms-transform-origin: 3px 3px;-o-transform-origin: 3px 3px;-webkit-transform-origin: 3px 3px;transform-origin: 3px 3px;-moz-transform: rotate(-90deg);-ms-transform: rotate(-90deg);-o-transform: rotate(-90deg);-webkit-transform: rotate(-90deg);transform: rotate(-90deg);"></div></div></div></div></div></td></tr></tbody></table></div></div>'
        data-vis-attrs="oid/id,level.blind/changedWindowId;oid-working/id,indicator.working;min[0];max[100];border_width/slider,0,10,1;slide_count[1]/nselect,1,2,3,4,5,6;invert/checkbox;hide_timeout[2000];noAnimate/checkbox;popupHorizontalPos[center]/select,top,center,bottom;popupVerticalPos[center]/select,left,center,right;"
        data-vis-attrs0="group.leftRight;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;show_value/checkbox;infoFontRightSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;infoRightPaddingLeft/slider,0,100,1;infoRightPaddingRight[15]/slider,0,100,1;"
        data-vis-attrs1="group.slides/byindex;slide_type(1-slide_count)/select,,left,right,top,bottom;oid-slide-sensor(1-slide_count)/id/changedSensorId;oid-slide-sensor-lowbat(1-slide_count)/id,indicator.battery;oid-slide-handle(1-slide_count)/id/changedSensorId;oid-slide-handle-lowbat(1-slide_count)/id,indicator.battery;"
        >
    <div class="vis-widget hq-blind-base <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px" id="<%= this.data.attr('wid') %>"><%
        vis.binds.hqwidgets.window.init(this.data.wid, this.view, this.data, this.style);
    %></div>
</script>

<script id="tplHqDoor"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-type="state;door"
        data-vis-name="Door"
        data-vis-prev='<div id="prev_tplHqDoor" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev hq-blind-base vis-hq-button-base" style="overflow: visible; width: 47px; height: 93px; padding: 3px 4px 2px;"><table class="vis-hq-main vis-hq-door vis-hq-no-space" style="border: 2px #8E8D8D solid;"><tbody><tr class="vis-hq-no-space"><td class="vis-hq-no-space vis-hq-door-empty-right"></td><td class="vis-hq-no-space vis-hq-door-sheet" style="width: 100%;"><div class="vis-hq-door-handle" style="left: 75%;"></div></td><td class="vis-hq-no-space vis-hq-door-empty-left" style="width: 0px; background: rgb(81, 81, 81);"></td></tr></tbody></table></div></div></div>'
        data-vis-attrs="oid/id,state/changedButtonId;oid-battery/id,indicator.battery;border_width/slider,0,10,1;invert/checkbox;door_type/select,,left,right;noAnimate/checkbox;"
        data-vis-attrs0="group.leftRight;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;"
        >
    <div class="vis-widget hq-blind-base <%== this.data.attr('class') %>" style="overflow:visible; width: 50px; height: 100px" id="<%= this.data.attr('wid') %>"><%
        vis.binds.hqwidgets.door.init(this.data.wid, this.view, this.data, this.style);
    %></div>
</script>

<script id="tplHqLock"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplHqLock" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-hq-lock-base vis-hq-button-base hq-button-no-background" style="overflow: visible; width: 30px; height: 30px;" ><img src="widgets/hqwidgets/img/lockUnlocked.png" class="vis-hq-lock1" style="width: 100%; height:100%;"></div></div>'
        data-vis-set="hqwidgets"
        data-vis-type="control;lock"
        data-vis-name="Lock"
        data-vis-attrs="oid/id,state/changedLockId;oid-open/id;oid-battery/id,indicator.battery;noAnimate/checkbox;"
        data-vis-attrs0="group.image;closedIcon[widgets~hqwidgets~img~lockLocked.png]/image;openedIcon[widgets~hqwidgets~img~lockUnlocked.png]/image;"
        data-vis-attrs1="group.popup;popupRadius[75]/slider,50,150,1;buttonRadius[50]/slider,0,150,1;closeIcon[widgets~hqwidgets~img~lockLocked.png]/image;closeValue;closeStyle/style,hqwidgetsButtons glossy,-button,background;"
        data-vis-attrs2="openIcon[widgets~hqwidgets~img~lockUnlocked.png]/image;openValue;openStyle/style,hqwidgetsButtons glossy,-button,background;"
        data-vis-attrs3="openDoorIcon[widgets~hqwidgets~img~openDoor.png]/image;openDoorValue;openDoorStyle/style,hqwidgetsButtons glossy,-button,background;showTimeout[5000]/slider,0,30000,100;"
        data-vis-attrs4="group.leftRight;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;infoFontRightSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;infoRightPaddingLeft/slider,0,100,1;infoRightPaddingRight[15]/slider,0,100,1;"
        data-vis-attrs5="group.styles;styleNormal[hq-button-no-background]/style,hqwidgetsButtons glossy,-button,background;styleActive[hq-button-no-background]/style,hqwidgetsButtons glossy,-button,background;usejQueryStyle/checkbox;changeEffect/nselect,,waves,wobble,tada,swing,shake,rubberBand,pulse,flash,bounce;waveColor/color;testActive/checkbox;"
        >
    <div class="vis-widget vis-hq-lock-base <%== this.data.attr('class') %>" style="overflow:visible; width: 30px; height: 30px" id="<%= this.data.attr('wid') %>"><%
        vis.binds.hqwidgets.lock.init(this.data.wid, this.view, this.data, this.style);
    %></div>
</script>


<!--script type="text/ejs" id="tplHqText" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Text" data-vis-render-visible="true" data-vis-attrs="hqoptions">
    <%
    if (this && this.data && this.data.attr) {
        if (this.data.attr('hqoptions')){
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
        }
        else {
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqText", this.view);
        }
    }
    %>
</script>
<script type="text/ejs" id="tplHqInfo" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Info" data-vis-render-visible="true" data-vis-attrs="hm_id;hqoptions">
    <%
    if (this && this.data && this.data.attr) {
        if (this.data.attr('hqoptions')){
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
        }
        else {
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqInfo", this.view);
        }
    }
    %>
</script>
<script type="text/ejs" id="tplHqImage" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Image" data-vis-render-visible="true" data-vis-attrs="hqoptions">
    <%
    if (this && this.data && this.data.attr) {
        if (this.data.attr('hqoptions')){
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
        }
        else {
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqImage", this.view);
        }
    }
    %>
</script>
<script type="text/ejs" id="tplHqCam" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="IpCamera" data-vis-render-visible="true" data-vis-attrs="hm_id;hqoptions" data-hqwidgets-filter="HM-OU-CFM-Pl,HM-Sec-SFA-SM,HM-OU-CF-Pl,HM-Sec-SC,HM-SCI-3-FM,HMW-Sen-SC-12-DR,HMW-IO-12-Sw14-DR;.STATE,.OPEN,HM-Sec-Key-S,HM-LC-Sw4-WM,HM-LC-Sw1-Pl,HM-LC-SW1-FM,HM-LC-Sw2-FM,HM-LC-Sw1-SM,HM-LC-Sw4-PCB,HM-LC-Sw4-PCB,HM-LC-Sw4-SM,HM-LC-Sw1-BA-PCB">
    <%
    if (this && this.data && this.data.attr) {
        if (this.data.attr('hqoptions')){
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
        }
        else {
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqCam", this.view);
        }
    }
    %>
</script>
<script type="text/ejs" id="tplHqGong" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Gong" data-vis-render-visible="true" data-vis-attrs="hm_id;hqoptions" data-hqwidgets-filter="HM-OU-CFM-Pl,HM-Sec-SFA-SM,HM-OU-CF-Pl,HM-Sec-SC,HM-SCI-3-FM,HMW-Sen-SC-12-DR,HMW-IO-12-Sw14-DR;.STATE,.OPEN,HM-Sec-Key-S,HM-LC-Sw4-WM,HM-LC-Sw1-Pl,HM-LC-SW1-FM,HM-LC-Sw2-FM,HM-LC-Sw1-SM,HM-LC-Sw4-PCB,HM-LC-Sw4-SM,HM-LC-Sw1-BA-PCB">
    <%
    if (this && this.data && this.data.attr) {
        if (this.data.attr('hqoptions')){
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
        }
        else {
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqGong", this.view);
        }
    }
    %>
</script>
<script type="text/ejs" id="tplHqGauge" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Gauge" data-vis-render-visible="true" data-vis-attrs="hm_id;hqoptions">
    <%
    if (this && this.data && this.data.attr) {
		if (this.data.attr('hqoptions')){
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
		}
		else {
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqGauge", this.view);
		}
    }
    %>
</script>
<script type="text/ejs" id="tplHqMotion" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Motion Detector" data-vis-render-visible="true" data-vis-attrs="hm_id;hqoptions" data-hqwidgets-filter=".STATE,.MOTION;">
    <%
    if (this && this.data && this.data.attr) {
		if (this.data.attr('hqoptions')){
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
		}
		else {
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqMotion", this.view);
		}
    }
    %>
</script>
<script type="text/ejs" id="tplHqLowbat" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Battery Indicator" data-vis-render-visible="true" data-vis-attrs="hqoptions" data-hqwidgets-filter=".LOWBAT">
    <%
    if (this && this.data && this.data.attr) {
        if (this.data.attr('hqoptions')){
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
        }
        else {
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqLowbat", this.view);
        }
    }
    %>
</script>
<script type="text/ejs" id="tplHqIp" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Ping device" data-vis-render-visible="true" data-vis-attrs="hqoptions" data-hqwidgets-filter="PING">
    <%
    if (this && this.data && this.data.attr) {
		if (this.data.attr('hqoptions')){
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
		} else {
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqIp", this.view);
		}
    }
    %>
</script>
<script type="text/ejs" id="tplHqCharts" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Charts" data-vis-render-visible="true" data-vis-attrs="hqoptions">
    <%
    if (this && this.data && this.data.attr) {
		if (this.data.attr('hqoptions')){
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
		} else {
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqCharts", this.view);
		}
    }
    %>
</script>
<script type="text/ejs" id="tplHqEventlist" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Eventlist" data-vis-render-visible="true" data-vis-attrs="hqoptions">
    <%
    if (this && this.data && this.data.attr) {
		if (this.data.attr('hqoptions')){
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
		} else {
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqEventlist", this.view);
		}
    }
    %>
</script-->

<script id="tplHqCheckbox"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="Checkbox"
        data-vis-type="ctrl,checkbox"
        data-vis-prev='<div id="prev_tplHqCheckbox" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="overflow: visible; width: 108px; height: 35px"><div class="checkbox-small-orange-wrap"><div class="checkbox-small-orange-button"><input type="checkbox" style="display: none;"></div></div></div></div>'
        data-vis-update-style="true"
        data-vis-attrs="oid[nothing_selected]/id;val_false[false];val_true[true];staticValue;"
        data-vis-attrs0="checkboxSize[big]/select,big,small;checkboxColor[grey]/select,orange,blue,green,grey;checkboxColorOn[orange]/select,orange,blue,green,grey;readOnly/checkbox"
    >
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 216px; height: 68px" id="<%= this.data.attr('wid') %>"  data-vis-resizable='{"disabled":true, "handles":"e"}'><%
            vis.binds.hqwidgets.checkbox.init(this.data.wid, this.view, this.data, this.style);
    %></div>
</script>

<script id="tplHqCircle"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="CircleKnob"
        data-vis-update-style="true"
        data-vis-type="ctrl,number,dimmer,knob"
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_hqwidgetsCircleKnob.png"></img>'
        data-vis-attrs="oid[nothing_selected]/id/changedButtonId;oid-working;oid-battery;oid-signal;"
        data-vis-attrs0="group.value;unit;min[0];max[100];digits[0]/number;step[1];is_comma[true]/checkbox;readOnly/checkbox;"
        data-vis-attrs1="group.center;caption;hideNumber/checkbox;"
        data-vis-attrs2="group.arc;angleOffset/slider,0,360,1;angleArc/slider,0,360,1;displayPrevious[true]/checkbox;"
        data-vis-attrs3="group.style;cursor/slider,1,350,1;thickness/slider,0.05,1,0.05;color/color;bgcolor/color;linecap/checkbox;anticlockwise/checkbox"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px" id="<%= this.data.attr('wid') %>"><%
        vis.binds.hqwidgets.circle.init(this.data.wid, this.view, this.data);
        %><input type="text" style="display: none"/></div>
</script>
<script id="tplHqOdometer"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="Odometer"
        data-vis-beta="true"
        data-vis-update-style="true"
        data-vis-type="val,number"
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_hqOdometer.png"></img>'
        data-vis-attrs="oid;style[car]/nselect,car,default,digital,minimal,plaza,slot-machine,train-station;group.extended;format[(ddd),dd];factor[1];leadingZeros[true]/checkbox"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 125px; height: 42px; font-size: 24px" id="<%= this.data.attr('wid') %>"></div>
    <% vis.binds.hqwidgets.odometer(this.view, this.data) %>
</script>

<!-- --------------hqwidgets.html--- END -->
<!-- --------------jqplot.html--- START -->
<link rel="stylesheet" type="text/css" href="widgets/jqplot/css/jquery.jqplot.min.css" />

<script type="text/javascript" src="widgets/jqplot/js/jquery.jqplot.min.js"></script>

<script type="text/javascript">

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            "background":           {"en": "Background",            "de": "Hintergrund",                    "ru": "Фон"},
            "group_ticks":          {"en": "Ticks",                 "de": "Tick",                           "ru": "Штрихи"},
            "ticks":                {"en": "Ticks-Namen",           "de": "Tick-Beschriftungen",            "ru": "Подписи штрихов"},
            "ticks_tooltip":        {"en": "Divide with semicolon, e.g '10;50;70'", "de": "Mit Semikolon trennen, z.B. '10;50;70'", "ru": "Разделять точкой запятой, например '10;50;70'"},
            "showTickLabels":       {"en": "Show tick labels",      "de": "Zeige Tick-Beschriftungen",      "ru": "Показать подписи"},
            "tickPadding":          {"en": "Tick padding",          "de": "Tick-Abstand",                   "ru": "Отступ штрихов"},
            "group_intervals":      {"en": "Intervals",             "de": "Intervalle",                     "ru": "Интервалы"},
            "intervals":            {"en": "Intervals",             "de": "Intervalle",                     "ru": "Отрезки"},
            "intervals_tooltip":    {"en": "Divide with semicolon, e.g '10;50;70'", "de": "Mit Semikolon trennen, z.B. ''10;50;70'", "ru": "Разделять точкой запятой, например '10;50;70'"},
            "intervalColors":       {"en": "Interval colors",       "de": "Intervallfarben",                "ru": "Цвета интервалов"},
            "intervalColors_tooltip": {"en": "Divide with semicolon, e.g 'green;#0000FF;red'", "de": "Mit Semikolon trennen, z.B. 'green;#0000FF;red'", "ru": "Разделять точкой запятой, например 'green;#0000FF;red'"},
            "intervalInnerRadius":  {"en": "Inner interval raduis", "de": "Intervall-Radius innen",         "ru": "Внутренний радиус интервалов"},
            "intervalOuterRadius":  {"en": "Outer interval radius", "de": "Intervall-Radius außen",         "ru": "Внешний радиус интервалов"},
            "diameter":             {"en": "Diameter",              "de": "Durchmesser",                    "ru": "Диаметер"},
            "padding":              {"en": "Padding",               "de": "Abstand",                        "ru": "Отступ"},
            "group_shadow":         {"en": "Shadow",                "de": "Schatten",                       "ru": "Тень"},
            "shadowOffset":         {"en": "shadowOffset",          "de": "Schatten offset",                "ru": "Сдвиг тени"},
            "shadowAlpha":          {"en": "Shadow transparence",   "de": "Schatten Alpha",                 "ru": "Прозрачость тени"},
            "shadowDepth":          {"en": "Shadow depth",          "de": "Schattentiefe",                  "ru": "Глубина тени"},
            "group_ring":           {"en": "Ring",                  "de": "Rand",                           "ru": "Кайма"},
            "ringColor":            {"en": "Ring color",            "de": "Randfarbe",                      "ru": "Цвет окантовки"},
            "ringWidth":            {"en": "Ring width",            "de": "Randbreite",                     "ru": "Ширина окантовки"},
            "group_needle":         {"en": "Needle",                "de": "Zeiger",                         "ru": "Стрелка"},
            "needleThickness":      {"en": "Needle thickness",      "de": "Zeigerdicke",                    "ru": "Ширина стрелки"},
            "needlePad":            {"en": "Needle pad",            "de": "Zeigeroffset",                   "ru": "Радиус основания"},
            "hubRadius":            {"en": "Hub radius",            "de": "Zeigerbasis-Radius",             "ru": "Основание стрелки"}
        });
    }

    vis.binds.jqplot = {
        gauge: function (el, data) {
            var $this = $(el).find('.jqplot-gauge');

            var id = $(el).attr('id');
            if (id && id.match(/_removed$/)) {
                return;
            }

            if (!$this.length || !$this.is(':visible')) {
                setTimeout(function () {
                    vis.binds.jqplot.gauge(el, data);
                }, 100);
                return;
            }

            if (!data) return;

            var options = {
                title: data.title,
                seriesDefaults: {
                    rendererOptions: {
                        min:            (data.min ? parseFloat(data.min) : undefined),
                        max:            (data.max ? parseFloat(data.max) : undefined),
                        ticks:          (data.ticks ? jQuery.map(data.ticks.split(';'), Number) : undefined),
                        intervals:      (data.intervals ? jQuery.map(data.intervals.split(';'), Number) : undefined),
                        intervalColors: (data.intervalColors ? data.intervalColors.split(';') : undefined),
                        label:          data.label,
                        showTickLabels: ((data.showTickLabels === 'false' || data.showTickLabels === false) ? false : undefined),
                        intervalInnerRadius: (!data.intervalInnerRadius ? undefined : parseInt(data.intervalInnerRadius, 10)),
                        intervalOuterRadius: (!data.intervalOuterRadius ? undefined : parseInt(data.intervalOuterRadius, 10)),
                        diameter:       (!data.diameter ? undefined : parseInt(data.diameter, 10)),
                        padding:        (!data.padding ? undefined : parseInt(data.padding, 10)),
                        shadowOffset:   (!data.shadowOffset ? undefined : parseInt(data.shadowOffset, 10)),
                        shadowAlpha:    (!data.shadowAlpha ? undefined : parseInt(data.shadowAlpha, 10)),
                        shadowDepth:    (!data.shadowDepth ? undefined : parseInt(data.shadowDepth, 10)),
                        background:     data.background, ringColor: data.ringColor,
                        tickColor:      data.tickColor,
                        ringWidth:      (!data.ringWidth ? undefined : parseInt(data.ringWidth, 10)),
                        hubRadius:      (!data.hubRadius ? undefined : parseInt(data.hubRadius, 10)),
                        tickPadding:    (!data.tickPadding ? undefined : parseInt(data.tickPadding, 10)),
                        needleThickness: (!data.needleThickness ? undefined : parseInt(data.needleThickness, 10)),
                        needlePad:      (!data.needlePad ? undefined : parseInt(data.needlePad, 10))
                    }
                }
            };
            if (options.seriesDefaults.rendererOptions.ticks && options.seriesDefaults.rendererOptions.ticks.length === 1) {
                options.seriesDefaults.rendererOptions.ticks[1] = options.seriesDefaults.rendererOptions.ticks[0];
            }

            $(el).data('options', data);
            $this.html('');

            try {
                var jqplotOptions = $.extend(true, {
                    title: {show: false},
                    grid: {
                        background: 'transparent'
                    },
                    seriesDefaults: {
                        renderer: $.jqplot.MeterGaugeRenderer,
                        rendererOptions: {
                            min: 0,
                            max: 100
                        }
                    }
                }, options);

                var oid = $this.attr('data-oid');
                var series;
                if (oid !== 'nothing_selected' && vis.states[oid + '.val'] !== undefined) {
                    series = [[vis.states[oid + '.val']]];
                } else {
                    series = [[1, 0]];
                }

                function onChange(e, newVal/* , oldVal */) {
                    plot.series[0].data = [[1, newVal]];
                    plot.redraw();
                }

                var bound = [];

                if (oid) {
                    vis.states.bind(oid + '.val', onChange);
                    bound.push(oid + '.val');
                }
                var plot = $.jqplot($this.attr('id'), series, jqplotOptions);

                if (bound.length) {
                    // remember all ids, that bound
                    $(el).data('bound', bound);
                    // remember bind handler
                    $(el).data('bindHandler', onChange);
                }
            } catch(e) {
                servConn.logError('Cannot render widget jqplot: ' + e);
            }

            if (vis.editMode) {
                $(el).resize(function () {
                    var timer = $(this).data('timer');
                    if (timer) {
                        clearTimeout(timer);
                    }
                    var that = this;
                    $(this).data('timer', setTimeout(function () {
                        $(that).data('timer', null);
                        $('#' + $(that).attr('id') + '_gauge').html('');
                        vis.binds.jqplot.gauge(that, $(that).data('options'));
                    }, 300));
                });

                $(el).data('destroy', function (id, $widget) {
                    $widget.off('resize');
                });
            }
        }
    };
</script>

<script type="text/ejs"
        id="tplJqplotGauge"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/jqplot/img/Prev_MeterGauge.png"></img>'
        data-vis-set="jqplot"
        data-vis-type="number"
        data-vis-name="MeterGauge"
        data-vis-attrs="oid;title;min/number;max/number;label;background/color;padding/slider,0,50,1;group.ticks;ticks;showTickLabels[true]/checkbox;tickPadding/slider,0,50,1;group.intervals;intervals;intervalColors;intervalInnerRadius/slider,0,550,1;intervalOuterRadius/slider,0,550,1;group.shadow;shadowOffset/slider,0,50,1;shadowAlpha/slider,0,1,0.05;shadowDepth/slider,0,50,1;group.ring;ringColor/color;ringWidth/slider,0,150,1;group.needle;needleThickness/slider,0,50,1;needlePad/slider,0,150,1;hubRadius/slider,0,150,1"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:460px; height:280px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.jqplot.gauge(el, data) %>>
        <div class="vis-widget-body" style="width: 100%; height: 100%">
            <div class="jqplot-gauge" id="_<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" style="width: 100%; height: 100%"/>
        </div>
    </div>
</script>

<!-- --------------jqplot.html--- END -->
<!-- --------------jqui.html--- START -->
<link rel="stylesheet" href="lib/css/jquery-ui-timepicker-addon-1.6.3.css" />
<script type="text/javascript" src="lib/js/jquery-ui-timepicker-addon-1.6.3.js"></script>
<style>
    #ui-datepicker-div {
        z-index: 999 !important;
    }
</style>
<script type="text/javascript">
    'use strict';

    if (vis.editMode) {
        $.extend(systemDictionary, {
            "group_dialog":     {"en": 'Dialog',            "de": "Dialog",                 "ru": "Диалог"},
            "buttontext":       {"en": "Button text",       "de": "Knopftext",              "ru": "Надпись на кнопке"},
            "href":             {"en": "Link",              "de": "Link",                   "ru": "Ссылка"},
            "href_tooltip":     {"en": "Like 'http://google.com'", "de": "Wie 'http://google.com'", "ru": "Например 'http://google.com'"},
            "target":           {"en": "target",            "de": "target",                 "ru": "target"},
            "dialog_height":    {"en": "Dialog height",     "de": "Dialoghöhe",             "ru": "Высота окна"},
            "dialog_width":     {"en": "Dialog width",      "de": "Dialogbreite",           "ru": "Ширина окна"},
            "alt":              {"en": "Tooltip (alt)",     "de": "Tooltip (alt)",          "ru": "Всплывающая подсказка (alt)"},
            "text":             {"en": "Text",              "de": "Text",                   "ru": "Текст"},
            "invert_icon":      {"en": "Invert image",      "de": "Invertiere das Bild",    "ru": "Инвертировать картинку"},
            "html_dialog":      {"en": "HTML in dialog",    "de": "HTML im Dialog",         "ru": "HTML в диалоговом окне"},
            "preload":          {"en": "Prerender dialog",  "de": "Prerender Dialog",       "ru": "Рендер содержания в начале"},
            "closeOnClick":     {"en": "Close by click on dialog",  "de": "Anklicken zum Schliessen",       "ru": "Закрыть по нажатию в любом месте"},
            "preload_tooltip":  {
                "en": "If true, the content of dialog will be created at start of view.\x0AIf false, the content will be created during opening of dialog.\x0AWebcams or dynamic content require 'prerender'=false",
                "de": "Falls true, wird Inhalt vom Dialog sofort am Anfang gerendert.\x0AFalls false, erst beim Anzeigen vom Dialog.\x0AWebcams oder dynamischer Inhalt müssen prerender auf false haben",
                "ru": "Если да, то рендер содержания будет в самом начале.\x0AЕсли нет, то при показе диалога.\x0AWebCams или динамическое содержание требуют значение false."
            },
            "persistent":       {"en": "Persistent",        "de": "Dauernd",                "ru": "Существует постоянно"},
            "persistent_tooltip":  {
                "en": "If true, the dialog will be created at start and can\x0Abe shown by external command 'dialogOpen'.",
                "de": "Falls true, wird der Dialog sofort am Anfang erzeugtx0Aund kann mit dem Befehl 'dialogOpen' angezeigt werden.",
                "ru": "Если да, то диалог будет создан в самом начале и\x0Aможет быть вызван внешней командой 'dialogOpen'."
            },
            "src_true":         {"en": "Icon by ON",         "de": "Icon bei AN",           "ru": "Иконка при ВКЛ"},
            "alt_true":         {"en": "Tooltip by ON",      "de": "Tooltip bei AN",        "ru": "Подсказка при ВКЛ"},
            "src_false":        {"en": "Icon by OFF",        "de": "Icon bei AUS",          "ru": "Иконка при ВЫКЛ"},
            "alt_false":        {"en": "Tooltip by OFF",     "de": "Tooltip bei AUS",       "ru": "Подсказка при ВЫКЛ"},
            "timeOnly":         {"en": "Time only",          "de": "Nur Zeit",              "ru": "Только время"},
            "hideSeconds":      {"en": "Hide seconds",       "de": "Keine Sekunden",        "ru": "спрятать секунды"},
            "stepMinute":       {"en": "Step size minutes",  "de": "Schrittweite Minuten",  "ru": "размер шага минуты"},
            "showGrid":         {"en": "Show grid",          "de": "Zeige Raster",          "ru": "показать сетку"},
            "inverted":         {"en": "Inverted value",     "de": "Wert invertiert",       "ru": "Иневртировать значение"},
            "submitmethod":     {"en": "Submit method",      "de": "Sendemethode",          "ru": "Метод"},
            "click_id":         {"en": "Control ID",         "de": "Steuer-ID",             "ru": "Контроль-ID"},
            "click_value":      {"en": "Control value",      "de": "Steuerwert",            "ru": "Контроль-значение"},
            "false_text":       {"en": "Text inactive",      "de": "Inaktiv-Text",          "ru": "Неактивный текст"},
            "true_text":        {"en": "Text active",        "de": "Aktiv-Text",            "ru": "Активный текст"},
            "false_src":        {"en": "Icon inactive",      "de": "Inaktiv-Bild",          "ru": "Неактивная картинка"},
            "true_src":         {"en": "Icon active",        "de": "Aktiv-Bild",            "ru": "Активная картинка"},
            "false_alt":        {"en": "Tooltip inactive",   "de": "Inaktiv-Tooltip",       "ru": "Неактивная подсказка"},
            "true_alt":         {"en": "Tooltip active",     "de": "Aktiv-Tooltip",         "ru": "Активная подсказка"},
            "dialog_top":       {"en": "Top",                "de": "Position oben",         "ru": "Позиция сверху"},
            "dialog_left":      {"en": "Left",               "de": "Position links",        "ru": "Позиция слева"},
            "overflowX":        {"en": "Overflow X",         "de": "Overflow X",            "ru": "Overflow X"},
            "overflowY":        {"en": "Overflow Y",         "de": "Overflow Y",            "ru": "Overflow Y"},
            "noHeader":         {"en": "Hide header",        "de": "Kopfzeile verbergen",   "ru": "Скрыть заголовок"},
            "setId":            {"en": "Set Object ID",      "de": "Setze Objekt-ID",       "ru": "Записать в Объект с ID"},
            "setId_tooltip":    {
                "en": "By opening of dialog the Object ID\x0Awill be set with given value.",
                "de": "Beim Öffnen des Dialogs wird die Object ID\x0Amit dem eingegebenen Wert gesetzt.",
                "ru": "При открытии диалога в объект с этим ID будет записано значение"
            },
            "setValue":         {"en": "Set value",          "de": "Setze Wert",            "ru": "Записываемое значение"},
            "oid-2":            {"en": "OID Range max.",     "de": "OID Bereich max.",      "ru": "ID Объекта макс"},
            "oid-2-working":    {"en": "OID Working max.",   "de": "OID Working max.",      "ru": "ID working макс"},
            "asString":         {"en": "As string",          "de": "Als String",            "ru": "Строковое значение"},
            "values":           {"en": "Values",             "de": "Werte",                 "ru": "Значения"},
            "values_tooltip":   {
                "en": "Values divided by semicolon:\x0A0;1;2",
                "de": "Werte sind mit Semikolon getrennt:\x0A0;1;2",
                "ru": "Значения разделены точкой с запятой:\x0A0;1;2"
            },
            "texts":            {"en": "Texts",             "de": "Texte",                  "ru": "Тексты"},
            "height":           {"en": "Height",            "de": "Höhe",                   "ru": "Высота"},
            "no_style":         {"en": "No jQuery style",   "de": "Ohne jQuery Stil",       "ru": "Без стиля jQuery"},
            "Password":         {"en": "Password",          "de": "Kennwort",               "ru": "Пароль"},
            "imageHeight":      {"en": "Image height %",    "de": "Bildhöhe in %",          "ru": "Высота иконки в %"},
            "autoclose":        {"en": "Auto close (ms)",   "de": "Auto-Zu (ms)",           "ru": "Автозакрытие (мс)"},
            "modal":            {"en": "Modal",             "de": "Modal",                  "ru": "Модальное"},
            "texts_tooltip":   {
                "en": "Texts divided by semicolon:\x0AOn;Off;Auto",
                "de": "Texte sind mit Semikolon getrennt:\x0AAn;Aus;Auto",
                "ru": "Тексты разделены точкой с запятой:\x0AВкл;Выкл;Авто"
            }
        });
    }
    $.extend(systemDictionary, {
        "Password": {"en": "Password", "de": "Kennwort", "ru": "Пароль"}
    });

    vis.navChangeCallbacks.push(function (view) {
        $('.jqui-nav-state').each(function () {
            var $this = $(this);
            if ($this.attr('data-vis-nav') === view) {
                $this.removeClass('ui-state-default');
                $this.addClass('ui-state-active');
            } else {
                $this.addClass('ui-state-default');
                $this.removeClass('ui-state-active');
            }
        });
    });

    vis.binds.jqueryui = {
        navigationActive: function (el, nav_view) {
            var $this = $(el);
            if (window.location.hash.slice(1) === nav_view) {
                $this.removeClass('ui-state-default').addClass('ui-state-active');
            }
        },
        months: {
            "en": ['January', 'February', 'March', 'April',  'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
            "de": ['Januar',  'Februar',  'März',  'April',  'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],
            "ru": ['Январь',  'Февраль',  'Март',  'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь',  'Октябрь', 'Ноябрь',   'Декабрь']
        },
        shortMonths: {
            "en": ['Jan', 'Feb', 'Mar',  'Apr', 'May', 'Jun',  'Jul',  'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            "de": ['Jan', 'Feb', 'Mär',  'Apr', 'Mai', 'Jun',  'Jul',  'Aug', 'Sep', 'Okt', 'Nov', 'Dez'],
            "ru": ['Янв', 'Фев', 'Март', 'Апр', 'Май', 'Июня', 'Июля', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек']
        },
        weekDays: {
            "en": ['Sunday',      'Monday',      'Tuesday',  'Wednesday', 'Thursday',   'Friday',  'Saturday'],
            "de": ['Sonntag',     'Montag',      'Dienstag', 'Mittwoch',  'Donnerstag', 'Freitag', 'Samstag'],
            "ru": ['Воскресение', 'Понедельник', 'Вторник',  'Среда',     'Четверг',    'Пятница', 'Суббота']
        },
        shortWeekDays: {
            "en": ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],
            "de": ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"],
            "ru": ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб']
        },
        currentText: {
            "en": 'Now',
            "de": 'Jetzt',
            "ru": 'Сейчас'
        },
        closeText: {
            "en": 'Close',
            "de": 'Schließen',
            "ru": 'Закрыть'
        },
        timeText: {
            "en": 'Time',
            "de": 'Zeit',
            "ru": 'Время'
        },
        hourText: {
            "en": 'Hour',
            "de": 'Std',
            "ru": 'Час'
        },
        minuteText: {
            "en": 'Min',
            "de": 'Min',
            "ru": 'Мин'
        },
        secondText: {
            "en": 'Sec',
            "de": 'Sek',
            "ru": 'Сек'
        },
        timeOnlyTitle: {
            "en": 'Choose Time',
            "de": 'Zeit auswählen',
            "ru": 'Установите время'
        },
        activeHelper: function ($this, val, min, max, value, reverse) {
            if (val === true  || val === 'true')  val = max;
            if (val === false || val === 'false') val = min;

            if (max === undefined || max === '' || max === null) {
                max = 1;
                min = 0;
                val = (val === 'false' || val === false || val === 0 || val === '0' || val === '' || val === null || val === undefined) ? min : max;
            }

            if (reverse) {
                if (val == max) {
                    val = min;
                } else {
                    val = max;
                }
            }

            if (value === undefined && val > min && val !== true) {
                val = parseFloat(val) || 0;
            }

            if ((value === undefined && val > min) || (value !== undefined && val == value)) {
                $this.addClass('ui-state-active');
            } else {
                $this.removeClass('ui-state-active');
            }
        },
        active: function (el, reverse, _value) {
            var $this = $(el);
            var oid = $this.data('oid');
            var max = $this.data('max') || 1;
            var min = $this.data('min') || 0;

            function onChange(e, newVal) {
                vis.binds.jqueryui.activeHelper($this, newVal, min, max, _value, reverse);
            }

            if (oid) {
                // remember all ids, that bound
                $this.parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                vis.states.bind(oid + '.val', onChange);
                vis.binds.jqueryui.activeHelper($this, vis.states.attr(oid + '.val'), min, max, _value, reverse);
            }
        },
        classes: function (el, reverse, _value) {
            var $this = $(el);
            if (!$this.data('no-style')) {
                $this.hover(function () {
                    $this.addClass('ui-state-hover');
                }, function () {
                    $this.removeClass('ui-state-hover');
                });
            } else {
                $this.removeClass('ui-widget ui-corner-all ui-state-default');
            }

            $this.css({position: 'absolute'});
            vis.binds.jqueryui.active(el, reverse, _value);
        },
        dialog: function (el, options, persistent, preload, html, closeOnClick) {
            var $dlg = $(el).parent().find('div.vis-widget-dialog');
            $dlg.data('preload', (!preload || preload === 'false') && !$dlg.html().replace(/\s/g, ''));
            $('[aria-describedby="' + $dlg.attr('id') + '"]').remove();

            options.width     = options.width  || options.dialog_width;
            options.height    = options.height || options.dialog_height;
            options.top       = options.top    || options.dialog_top;
            options.left      = options.left   || options.dialog_left;
            options.minHeight = options.height;
            options.minWidth  = options.width;

            // Show dialog in edit mode too
            if (1 || !vis.editMode) {
                $(el).parent().find('div.vis-widget-body').on('click touchend', function (event) {
                    event.stopPropagation();
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    if ($dlg.data('preload')) $dlg.html(html);

                    if (persistent) {
                        if (options.setId) {
                            vis.setValue(options.setId, options.setValue);
                        }
                        $dlg.dialog('open');
                        $dlg.parent().css('z-index', 998);
                        $dlg.parent().find('.ui-widget-header button .ui-button-text').html('');
                        if (options.minHeight)   $dlg.css('min-height', options.minHeight);
                        if (options.minWidth)    $dlg.css('min-width', options.minWidth);
                        if (options.top  || options.top  === 0 || options.top  === '0') $dlg.parent().css('top',  options.top);
                        if (options.left || options.left === 0 || options.left === '0') $dlg.parent().css('left', options.left);
                        if (options.overflowX) $dlg.css('overflow-x', options.overflowX);
                        if (options.overflowY) $dlg.css('overflow-y', options.overflowY);
                        if (options.noHeader) {
                            $dlg.parent().find('.ui-dialog-titlebar').css({background: 'rgba(0,0,0,0)', border: 0, color: 'rgba(0,0,0,0)'});
                            $dlg.parent().find('.ui-dialog-title').html('&nbsp;');
                        }
                        $dlg.parent().find('.ui-state-focus').blur();
                    } else {
                        $dlg.dialog($.extend({
                            autoOpen: true,
                            open: function () {
                                $(this).parent().find('.ui-widget-header button .ui-button-text').html('');
                                if (options.setId) vis.setValue(options.setId, options.setValue);
                                $(this).parent().css('z-index', 998);
                                if (options.minHeight)   $(this).css('min-height', options.minHeight);
                                if (options.minWidth)    $(this).css('min-width', options.minWidth);
                                if (options.top  || options.top  === 0 || options.top  === '0') $(this).parent().css('top',  options.top);
                                if (options.left || options.left === 0 || options.left === '0') $(this).parent().css('left', options.left);
                                if (options.overflowX) $(this).css('overflow-x', options.overflowX);
                                if (options.overflowY) $(this).css('overflow-y', options.overflowY);
                                if (options.noHeader) {
                                    $dlg.parent().find('.ui-dialog-titlebar').css({background: 'rgba(0,0,0,0)', border: 0, color: 'rgba(0,0,0,0)'});
                                    $dlg.parent().find('.ui-dialog-title').html('&nbsp;');
                                }
                                $(this).parent().find('.ui-state-focus').blur();
                                //touchscreen fix
                                var $closeButton = $(this).parent().find('button.ui-dialog-titlebar-close');
                                $closeButton.off('touchend').on('touchend', function (event) {
                                    event.stopPropagation();
                                    $dlg.dialog('close');
                                    return false;
                                });
                            },
                            close: function () {
                                if ($dlg.data('timer')) { clearTimeout($dlg.data('timer')); $dlg.data('timer', null)};
                                $dlg.dialog('destroy');
                                // Destroy content if not preloaded
                                if ($dlg.data('preload')) $dlg.html('');
                            }
                        }, options));

                        $dlg.data('inited', true);

                        if (closeOnClick) {
                            $dlg.off('click touchstart touchend').on('click touchend', function (event) {
                                event.stopPropagation();
                                $dlg.dialog('close');
                                return false;
                            });
                        }
                    }
                    return false;
                });
            }
            if (persistent) {
                $dlg.dialog($.extend({
                    autoOpen: false,
                    open: function () {
                        $dlg.parent().css({'z-index': 1000});
                        if ($dlg.data('preload')) $dlg.html(html);
                        //touchscreen fix
                        var $closeButton = $(this).parent().find('button.ui-dialog-titlebar-close');
                        $closeButton.off('touchend').on('touchend', function (event) {
                            event.stopPropagation();
                            $dlg.dialog('close');
                            return false;
                        });
                    },
                    close: function () {
                        if ($dlg.data('timer')) {
                            clearTimeout($dlg.data('timer'));
                            $dlg.data('timer', null);
                        }
                        // Destroy content if not preloaded
                        if ($dlg.data('preload')) $dlg.html('');
                    }
                }, options));

                $dlg.data('inited', true);

                if (closeOnClick) {
                    $dlg.off('click touchstart touchend').on('click touchend', function (event) {
                        event.stopPropagation();
                        $dlg.dialog('close');
                        return false;
                    });
                }
            }
        },
        dialogContainer: function (el, options, persistent, preload) {
            var $dlg = $(el).parent().find('div.vis-widget-dialog');

            var id = $(el).parent().attr('id');
            if (id && id.match(/_removed$/)) {
                return;
            }

            if (!$dlg.length) {
                setTimeout(function () {
                    vis.binds.jqueryui.dialogContainer(el, options, persistent, preload);
                }, 200);
                return;
            }

            options.width     = options.dialog_width;
            options.height    = options.dialog_height;
            options.top       = options.dialog_top;
            options.left      = options.dialog_left;
            options.minHeight = options.height;
            options.minWidth  = options.width;

            $dlg.dialog($.extend({
                autoOpen: false,
                open: function () {
                    $(this).parent().find('.ui-widget-header button .ui-button-text').html('');
                    $(this).parent().css('z-index', 998);
                    //touchscreen fix
                    $dlg.find('.vis-view-container').each(function () {
                        var cview = $(this).attr('data-vis-contains');
                        if (!vis.views[cview]) {
                            $(this).append('error: view not found.');
                            return false;
                        } else if (cview === vis.activeView) {
                            $(this).append('error: view container recursion.');
                            return false;
                        }
                        var $this = this;
                        vis.renderView(cview, cview, false, function (_view) {
                            $('#visview_' + _view)
                                    .appendTo($this)
                                    .show();
                        });
                    });

                    if (options.setId) vis.setValue(options.setId, options.setValue);
                    var $id =  $(this);
                    if (options.minHeight)   $id.css('min-height', options.minHeight);
                    if (options.minWidth)    $id.css('min-width',  options.minWidth);
                    if (options.top  || options.top  === 0 || options.top  === '0') $id.parent().css('top',  options.top);
                    if (options.left || options.left === 0 || options.left === '0') $id.parent().css('left', options.left);
                    if (options.overflowX) $id.css('overflow-x', options.overflowX);
                    if (options.overflowY) $id.css('overflow-y', options.overflowY);
                    if (options.noHeader) {
                        $id.parent().find('.ui-dialog-titlebar').css({background: 'rgba(0,0,0,0)', border: 0, color: 'rgba(0,0,0,0)'});
                        $id.parent().find('.ui-dialog-title').html('&nbsp;');
                    }
                    $id.parent().find('.ui-state-focus').blur();

                    var $closeButton = $(this).parent().find('button.ui-dialog-titlebar-close');
                    $closeButton.off('touchend').on('touchend', function (event) {
                        event.stopPropagation();
                        $dlg.dialog('close');
                        var $view = $dlg.find('.vis-view');
                        if (!$view.data('persistent')) {
                            vis.destroyView($view.data('view'), $view.data('view'));
                        }
                        return false;
                    });
                },
                close: function () {
                    if ($dlg.data('timer')) {
                        clearTimeout($dlg.data('timer'));
                        $dlg.data('timer', null);
                    }
                    vis.destroyUnusedViews();
                }
            }, options));

            if (persistent) $dlg.find('.vis-view-container').data('persistent', persistent);

            if (!vis.editMode) {
                $(el).parent().find('div.vis-widget-body').on('click touchend', function (event) {
                    event.stopPropagation();
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    var $id =  $('#' + $(this).parent().attr('id') + '_dialog');
                    $id.dialog('open');
                    return false;
                });
            } else {
                $(el).parent().find('div.vis-widget-body').show();
            }
        },
        dialogAutoClose: function (el, timeout) {
            if (timeout === true || timeout === 'true') timeout = 10000;
            if (timeout === null || timeout === undefined || timeout === '') return;
            timeout = parseInt(timeout, 10);
            if (timeout < 60) {
                // may be this is seconds
                timeout *= 1000;
            }
            if (!timeout) timeout = 1000;

            var $dialog = $('#' + $(el).parent().attr('id') + '_dialog');

            var id = $(el).parent().attr('id');
            if (id && id.match(/_removed$/)) {
                return;
            }

            if (!$dialog.length) {
                setTimeout(function () {
                    vis.binds.jqueryui.dialogAutoClose(el, timeout);
                }, 200);
                return;
            }

            $dialog.on('dialogopen', function () {
                $dialog.find('input').on('click', function () {
                    var timer = $dialog.data('timer');
                    if (timer) clearTimeout(timer);
                    $dialog.data('timer', setTimeout(function () {
                        $dialog.data('timer', null);
                        $dialog.dialog('close');
                    }, timeout));
                });
                $dialog.data('timer', setTimeout(function () {
                    $dialog.data('timer', null);
                    $dialog.dialog('close');
                }, timeout));
            });
        },
        dialogClose: function (el, options) {
            if (!$(el).data('no-style')) {
                setTimeout(function () {
                    $(el).button({
                        icons: {
                            primary: options.iconClass ? 'ui-icon-' + options.iconClass : null
                        }
                    });
                }, 0);
            }
            $(el).click(function () {
                if (options.dlgName) {
                    $('#' + options.dlgName + '_dialog').dialog('close');
                } else {
                    var $parent = $(this).parent().parent().parent();
                    var $dlg = $parent.find('.vis-widget-dialog');
                    if ($dlg.length) {
                        $dlg.dialog('close');
                        return;
                    }
                    $parent = $parent.parent();
                    $dlg = $parent.find('.vis-widget-dialog');
                    if ($dlg.length) {
                        $dlg.dialog('close');
                        return;
                    }
                    $parent = $parent.parent();
                    $dlg = $parent.find('.vis-widget-dialog');
                    if ($dlg.length) {
                        $dlg.dialog('close');
                        return;
                    }
                    $parent = $parent.parent();
                    $dlg = $parent.find('.vis-widget-dialog');
                    if ($dlg.length) {
                        $dlg.dialog('close');
                        return;
                    }
                }
            });
        },
        input: function (el, options, asString) {
            var $this  = $(el);
            var oid    = $this.attr('data-oid');
            var digits = options;
            asString = asString === 'true' || asString === true;
            if (!$this.data('no-style')) {
                $this.button().addClass('ui-state-default');
            } else {
                $this.removeClass('ui-widget ui-corner-all ui-state-default');
            }
            $this.css({
                'font':       'inherit',
                //'color' :   'inherit',
                'text-align': 'left',
                'outline':    'none',
                'cursor':     'text',
                height:       '50%'
            }).change(function () {
                vis.setValue(oid, $(this).val());
            });

            function onChange(e, newVal) {
                if (!asString && digits && digits !== '') {
                    newVal = parseFloat(newVal).toFixed(digits);
                }

                $this.val(newVal);
            }
            var val = '';
            if (oid) {
                vis.states.bind(oid + '.val', onChange);
                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                val = vis.states[oid + '.val'];
                if (!asString && digits && digits !== '') {
                    val = parseFloat(vis.states[oid + '.val']).toFixed(digits);
                }
            }
            $this.val(val);
        },
        inputDate: function (el, options) {
            var $this = $(el);
            var oid = $this.attr('data-oid');
            var datepickerOptions = $.extend(true, {
                dateFormat:      'yy-mm-dd',
                monthNamesShort: vis.binds.jqueryui.shortMonths[vis.language],
                monthNames:      vis.binds.jqueryui.months[vis.language],
                dayNamesMin:     vis.binds.jqueryui.shortWeekDays[vis.language],
                showAnim:        'fadeIn',
                firstDay: 1,
                currentText:     vis.binds.jqueryui.currentText[vis.language],
                closeText:       vis.binds.jqueryui.closeText[vis.language]

            }, options);

            $this.addClass('ui-widget ui-button ui-corner-all ui-state-default')
                    .css({
                        font:       'inherit',
                        //'color' :   'inherit',
                        'text-align': 'left',
                        outline:    'none',
                        cursor:     'text',
                        height:     '95%'
                    });

            if (!vis.editMode) $this.datepicker(datepickerOptions);

            function onChange(e, newVal) {
                $this.val(newVal);
            }

            if (oid) {
                $this.change(function () {
                    vis.setValue(oid, $(this).val());
                });

                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                $this.val(vis.states.attr(oid + '.val'));
            }
        },
        inputDatetime: function (el, options) {
            var $this = $(el);
            var oid = $this.attr('data-oid');
            var timeFormat = options.showSecond ? 'HH:mm:ss' : 'HH:mm';
            var hourGrid = options.showGrid ? 6 : 0;
            var minuteGrid = options.showGrid ? options.stepMinute : 0;
            if (minuteGrid < 10) {minuteGrid = 10;}
            var secondGrid = options.showGrid ? 15 : 0;
            var timepickerOptions = $.extend(true, {
                dateFormat:      'yy-mm-dd',
                monthNamesShort: vis.binds.jqueryui.shortMonths[vis.language],
                monthNames:      vis.binds.jqueryui.months[vis.language],
                dayNamesMin:     vis.binds.jqueryui.shortWeekDays[vis.language],
                showAnim:        'fadeIn',
                firstDay:        1,
                timeText:        vis.binds.jqueryui.timeText[vis.language],
                hourText:        vis.binds.jqueryui.hourText[vis.language],
                minuteText:      vis.binds.jqueryui.minuteText[vis.language],
                secondText:      vis.binds.jqueryui.secondText[vis.language],
                currentText:     vis.binds.jqueryui.currentText[vis.language],
                closeText:       vis.binds.jqueryui.closeText[vis.language],
                timeOnlyTitle:   vis.binds.jqueryui.timeOnlyTitle[vis.language],
                minuteGrid:      minuteGrid,
                hourGrid:        hourGrid,
                secondGrid:      secondGrid,
                timeOnly:        false,
                showSecond:      true,
                timeFormat:      timeFormat,
                pickerTimeFormat: timeFormat
            }, options);
            $this.addClass('ui-state-default')
                    .css({
                        font:       'inherit',
                        //color:    'inherit',
                        'text-align': 'left',
                        outline:    'none',
                        cursor:     'text',
                        height:     '95%'
                    });
            // Store options
            $this[0].__options = options;

            if (!vis.editMode) {
                $this.datetimepicker(timepickerOptions).button();
            } else {
                $this.addClass('ui-widget ui-button ui-corner-all');
            }


            function onChange(e, newVal) {
                $this.val(newVal);
            }

            if (oid) {
                $this.change(function () {
                    var $this = $(this);
                    var val = $this.val();
                    /*if ($this[0].__options && !$this[0].__options.showSecond) {
                     var vals = val.split(':');
                     if (vals.length === 3) {
                     val = vals[0] + ":" + vals[1];
                     }
                     }*/
                    vis.setValue(oid, val);
                });
                vis.states.bind(oid + '.val', onChange);
                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                $this.val(vis.states.attr(oid + '.val'));
            }
        },
        inputset: function (el, options, asString) {
            var digits    = options;
            var $this     = $(el);
            var input     = '#' + $this.attr('id').slice(0, -3) + 'input';
            var noJsStyle = $(el).data('no-style');
            var oid = $this.attr('data-oid');
            asString = asString === 'true' || asString === true;
            if (!noJsStyle) $this.button();

            $this.css({'padding-left': 5, 'padding-right': 5});

            if (!vis.editMode) {
                $this.on('click touchstart', function () {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    vis.setValue(oid, $(input).val());
                });

                // send text on enter
                setTimeout(function () {
                    $(input).keydown(function (e) {
                        if (e.keyCode === 13) vis.setValue(oid, $(this).val());
                    });
                }, 100);
            }

            if (!noJsStyle) $this.prev().button();

            $this.prev().addClass('ui-state-default')
                    .css({
                        font:            'inherit',
                        'padding-left':  5,
                        'padding-right': 5,
                        //'color' :   'inherit',
                        'text-align':   'left',
                        outline:        'none',
                        cursor:         'text',
                        height:         '95%'
                    });

            function onChange(e, newVal) {
                if (!asString && digits && digits !== '') {
                    newVal = parseFloat(newVal).toFixed(digits);
                }
                $(input).val(newVal);
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);
                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                var newVal = vis.states[oid + '.val'];
                if (!asString && digits && digits !== '') newVal = parseFloat(newVal).toFixed(digits);
                $(input).val(newVal);
            }
        },
        multiselect: function (el, options, isOpen) {
            var $this = $(el);
            var oid = $this.attr('data-oid');
            var noJsStyle = $this.attr('data-no-style');
            if (oid) $this.val(vis.states[oid + '.val']);

            if (noJsStyle !== true && noJsStyle !== 'true') {
                $this.multiselect($.extend({
                    minWidth:         $this.parent().parent().width() - 7,
                    multiple:         false,
                    header:           false,
                    noneSelectedText: false,
                    selectedList:     1
                }, options)).change(function () {
                    var val = $this.val();
                    if (parseFloat(val).toString() == val) val = parseFloat(val);
                    if (val === 'true')  val = true;
                    if (val === 'false') val = false;
                    if (!vis.editMode) vis.setValue(oid, val);
                });
            } else {
                $this.change(function () {
                    var val = $this.val();
                    if (parseFloat(val).toString() == val) val = parseFloat(val);
                    if (val === 'true') val = true;
                    if (val === 'false') val = false;
                    if (!vis.editMode) vis.setValue(oid, val);
                });
            }

            $this.val(vis.states[oid + '.val']);
            $this.prop('disabled', vis.editMode);
            if (noJsStyle !== true && noJsStyle !== 'true') {
                $this.multiselect('refresh');
            }
            var id =  $this.attr('id');

            function onChange(e, newVal) {
                var $select = $('#' + id);
                $select.val(newVal);
                if (noJsStyle !== true && noJsStyle !== 'true') {
                    $select.multiselect('refresh');
                }
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);
                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);
            }

            if (vis.editMode) {
                if (noJsStyle !== true && noJsStyle !== 'true' && isOpen) {
                    $this.multiselect('open');
                }

                vis.bindWidgetClick($this.attr('data-view'), $this.attr('id').replace('_multiselect', ''));
                $this.parent().parent().resize(function () {
                    if (noJsStyle !== true && noJsStyle !== 'true') {
                        $('#' + id).multiselect('option', 'minWidth', $(this).width() - 7);
                    }
                }).data('destroy', function (id, $widget) {
                    $widget.off('resize');
                });
            }
        },
        slider: function (el, options) {
            var $this       = $(el);
            var oid         = $this.attr('data-oid');
            var oid2        = $this.attr('data-oid2');
            var oid_val     = 0;
            var oid2_val    = 0;
            var wid         = $this.attr('data-oid-working');
            var wid2        = $this.attr('data-oid2-working');

            var settings    = $.extend({
                range:  !!oid2,
                min:    0,
                max:    100,
                step:   1,
                value:  parseFloat(vis.states.attr(oid + '.val')),
                slide:  function (e, ui) {
                    if (options.submitmethod !== 'stop') {
                      // Slider -> Observable
                      if (oid2) {
                        if (options.inverted) {
                          ui.values[0] = (settings.max - ui.values[0]) + settings.min;
                          ui.values[1] = (settings.max - ui.values[1]) + settings.min;
                        }

                        oid && vis.setValue(oid, ui.values[0]); //.toFixed(6));
                        vis.setValue(oid2, ui.values[1]); //.toFixed(6));
                      } else if (oid) {
                        if (options.inverted) ui.value = (settings.max - ui.value) + settings.min;
                        vis.setValue(oid, ui.value); //.toFixed(6));
                      }
                    }

                },
                stop: function (e, ui) {
                  if (options.submitmethod === 'stop') {
                    if (oid2) {
                      if (options.inverted) {
                        ui.values[0] = (settings.max - ui.values[0]) + settings.min;
                        ui.values[1] = (settings.max - ui.values[1]) + settings.min;
                      }

                      oid && vis.setValue(oid, ui.values[0]); //.toFixed(6));
                      vis.setValue(oid2, ui.values[1]); //.toFixed(6));
                    } else if (oid) {
                      if (options.inverted) ui.value = (settings.max - ui.value) + settings.min;
                      vis.setValue(oid, ui.value); //.toFixed(6));
                    }
                  }
                }
            }, options);

            settings.inverted = (settings.inverted === 'true' || settings.inverted === true);

            if (isNaN(settings.value)) settings.value = 0;
            if (isNaN(settings.min))   settings.min = 0;
            if (isNaN(settings.max))   settings.max = 100;
            if (isNaN(settings.step))  settings.step = (settings.max - settings.min) / 100;

            settings.min = parseFloat(settings.min);
            settings.max = parseFloat(settings.max);
            settings.value = parseFloat(settings.value);

            if (settings.inverted) settings.value = (settings.max - settings.value) + settings.min;

            $this.slider(settings);

            function onChange(e, newVal) {
                // console.log('slider newVal=' + JSON.stringify(newVal));
                // If device not in working state
                if (e.type === oid + '.val') {
                    if (!vis.states.attr(wid + '.val')) {
                        if (settings.inverted) {
                            oid_val = (settings.max - parseFloat(newVal)) + settings.min;
                        } else {
                            oid_val = parseFloat(newVal);
                        }
                        if ($this.slider('instance')) {
                            if (oid2) {
                                $this.slider('values', [oid_val, oid2_val]);
                            } else {
                                $this.slider('value', oid_val);
                            }
                        }
                    }
                } else if (e.type === oid2 + '.val'){
                    // console.log('slider newVal=' + JSON.stringify(newVal));
                    // If device not in working state
                    if (!vis.states.attr(wid2 + '.val')) {
                        oid2_val = parseFloat(newVal);
                        if (settings.inverted) {
                            oid2_val = (settings.max - parseFloat(newVal)) + settings.min;
                        } else {
                            oid2_val = parseFloat(newVal);
                        }
                        if ($this.slider('instance')) {
                            $this.slider('values', [oid_val, oid2_val]);
                        }
                    }
                }
            }
            var bound = [];
            if (oid) {
                vis.states.bind(oid + '.val', onChange);
                bound.push(oid + '.val');
            }

            if (oid2) {
                vis.states.bind(oid2 + '.val', onChange);
                bound.push(oid2 + '.val');

                oid_val  = vis.states.attr(oid + '.val');
                oid2_val = vis.states.attr(oid2 + '.val');

                if (settings.inverted) {
                    oid_val  = (settings.max - oid_val)  + settings.min;
                    oid2_val = (settings.max - oid2_val) + settings.min;
                }
                $this.slider('values', [oid_val, oid2_val]);
            }

            if (bound.length) {
                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', bound)
                    // remember bind handler
                    .data('bindHandler', onChange);
            }
        },
        button: function (el, value) {
            if ($(el).data('no-style')) return;

            setTimeout(function () {
                $(el).button();
            }, 0);
        },
        buttonDialog: function (el) {
            if ($(el).data('no-style')) return;
            setTimeout(function () {
                $(el).button();
            }, 0);
        },
        buttonLink: function (el, href) {
            if (!$(el).data('no-style')) {
                setTimeout(function () {
                    $(el).button();
                }, 0);
            }
            $(el).click(function () {
                if (!vis.editMode && href) window.location.href = href;
            });
        },
        buttonLinkBlank: function (el, href) {
            if (!$(el).data('no-style')) {
                setTimeout(function () {
                    $(el).button();
                }, 0);
            }
            $(el).click(function () {
                if (!vis.editMode && href) window.open(href);
            });
        },
        radio: function (el, options, process) {
            var $this    = $(el);
            var id = $this.parent().parent().attr('id');
            if (id && id.match(/_removed$/)) {
                return;
            }

            if (!process) {
                setTimeout(function () {
                    vis.binds.jqueryui.radio(el, process, true);
                }, 50);
                return;
            }
            var settings = $.extend({}, options);
            var oid      = $this.attr('data-oid');

            function onChange(e, newVal) {
                $this.find('input').removeAttr('checked');
                if (newVal === true || newVal === 'true') {
                    newVal = 1;
                } else
                if (newVal === false || newVal === 'false') {
                    newVal = 0;
                }
                $this.find('input').prop('checked', false);
                $this.find('input[value="' + newVal + '"]').prop('checked', true);
                $this.find('input').each(function () {
                    if ($(this).button('instance')) $(this).button('refresh');
                });
            }

            // Observable -> Buttonset
            if (oid) {
                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                var val = vis.states.attr(oid + '.val');

                if (val === true  || val === 'true')  {
                    val = 1;
                }
                if (val === false || val === 'false') {
                    val = 0;
                }

                setTimeout(function () {
                    //console.log(val + ' ' + $this.find('input[value="' + val + '"]').length);
                    $this.find('input').prop('checked', false);
                    $this.find('input[value="' + val + '"]').prop('checked', true);
                    $this.buttonset(settings);

                    $this.find('input').each(function () {
                        if ($this.button('instance')) {
                            $(this).button('refresh');
                        }
                    });

                    if (!vis.editMode) {
                        // Buttonset -> Observable
                        $this.find('input').on('click touchstart', function () {
                            // Protect against two events
                            if (vis.detectBounce(this)) return;

                            var val = $(this).val();
                            var f = parseFloat(val);
                            if (f.toString() === val.toString()) {
                                vis.setValue(oid, f);
                            } else {
                                vis.setValue(oid, val);
                            }
                        });
                    }
                }, 50);
            }

        },
        iconHttpGet: function (el, url) {
            if (vis.editMode) return;

            var $this = $(el).parent();
            $this.on('click touchstart', function (e) {
                // Protect against two events
                if (vis.detectBounce(this)) return;

                vis.conn.httpGet(url);
                e.preventDefault();
            });
        },
        hueColormode: function (el, oid) {
            var $hue = $(el).parent().find('.hue-mode-hue');
            var $ct  = $(el).parent().find('.hue-mode-ct');

            function onChange(e, newVal) {
                if (newVal === 'ct') {
                    $hue.hide();
                    $ct.show();
                } else {
                    $ct.hide();
                    $hue.show();
                }
            }

            if (oid) {
                if (vis.states.attr(oid + '.val') === 'ct') {
                    $hue.hide();
                    $ct.show();
                } else {
                    $ct.hide();
                    $hue.show();
                }
                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $(el).parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);
            } else {
                $ct.hide();
                $hue.show();
            }
        },
        _disable: function () {
            $('.vis-view-container').find('.ui-slider').each(function () {
                if ($(this).slider('instance')) {
                    $(this).slider('disable').removeClass('ui-state-disabled');
                }
            });

            setTimeout(function () {
                $('.vis-view-container').find('select[id$="_multiselect"]').each(function () {
                    if ($(this).css('display') === 'none') {
                        $(this).multiselect('disable').next().removeClass('ui-state-disabled').unbind('click touchstart', false);
                    }
                });
            }, 200);

            setTimeout(function () {
                $('.vis-view-container').find('a[href]').each(function () {
                    $(this).on('click touchstart', function (e) {});
                });
            }, 200);
        },
        itoggle: function (el) {
            var $this = $(el).parent();
            var oid = $this.parent().attr('data-oid');
            if (oid) {
                oid += '.val';
            }
            var val = vis.states.attr(oid);
            var activeVal = $this.parent().data('val');
            if (activeVal === '' || activeVal === undefined) activeVal = null;

            if (activeVal !== null) {
                if (val === null || val === undefined) val = '';
                if (activeVal.toString() === val.toString()) {
                    $this.find('.imgToggleFalse').hide();
                    $this.find('.imgToggleTrue').show();
                }
            } else {
                if (val === 'false') val = false;
                if (val === 'true')  val = true;

                if (typeof val === 'string') {
                    var f = parseFloat(val);
                    if (f == val) {
                        val = f;
                    } else {
                        val = val !== '';
                    }
                }
                if (val > 0) {
                    $this.find('.imgToggleFalse').hide();
                    $this.find('.imgToggleTrue').show();
                }
            }

            function onChange (e, val) {
                if (activeVal !== null) {
                    if (activeVal.toString() === val.toString()) {
                        $this.find('.imgToggleFalse').hide();
                        $this.find('.imgToggleTrue').show();
                    } else {
                        $this.find('.imgToggleTrue').hide();
                        $this.find('.imgToggleFalse').show();
                    }
                } else {
                    if (val === true || val === 'true' || parseFloat(val) > 0) {
                        $this.find('.imgToggleFalse').hide();
                        $this.find('.imgToggleTrue').show();
                    } else {
                        $this.find('.imgToggleTrue').hide();
                        $this.find('.imgToggleFalse').show();
                    }
                }
            }
            if (oid) {
                vis.states.bind(oid, onChange);
                    // remember all ids, that bound
                $this.parent()
                    .data('bound', [oid])
                    // remember bind handler
                    .data('bindHandler', onChange);
            }
        },
        calcValue: function (value, min, max) {
            if (!min) min = 0;
            if (max === null || max === undefined || max === '') max = 100;
            min   = parseFloat(min);
            max   = parseFloat(max);
            value = parseFloat(value);
            return min + value * (max - min);
        },
        calcImage: function (val, min, max, invert) {
            max = (max !== undefined) ? max : 100;
            min = (min !== undefined) ? min : 0;

            val = parseFloat(val);
            if (invert) val = max - val + min;
            var image = '';
            if (val >= max) {
                image = 10;
            } else if (val >= min + (max - min) * 0.9) {
                image = 9;
            } else if (val >= min + (max - min) * 0.8) {
                image = 8;
            } else if (val >= min + (max - min) * 0.7) {
                image = 7;
            } else if (val >= min + (max - min) * 0.6) {
                image = 6;
            } else if (val >= min + (max - min) * 0.5) {
                image = 5;
            } else if (val >= min + (max - min) * 0.4) {
                image = 4;
            } else if (val >= min + (max - min) * 0.3) {
                image = 3;
            } else if (val >= min + (max - min) * 0.2) {
                image = 2;
            } else if (val >= min + (max - min) * 0.1) {
                image = 1;
            } else {
                image = 0;
            }
            return image;
        },
        setSvgColor: function (el, color) {
            setTimeout(function () {
                el.parent().find('svg').remove();
                var $that = el;
                var imgURL = $that.attr('src');
                $.get(imgURL, function (data) {
                    // Get the SVG tag, ignore the rest
                    var $svg = $(data).find('svg');

                    // Remove any invalid XML tags as per http://validator.w3.org
                    $svg = $svg.removeAttr('xmlns:a');
                    $svg = $svg.attr('width',  '100%');
                    $svg = $svg.attr('height', '100%');
                    $svg.find('*').each(function () {
                        var style = $(this).attr('style');
                        if (style) {
                            style = style.replace(/#FFFFFF/g, color);
                            $(this).attr('style', style);
                        }
                    });

                    // Replace image with new SVG
                    $that.replaceWith($svg);
                }, 'xml');
            }, 0);
        },
        navigationPw: function (el, data) {
            var $this = $(el);
            if (!$this.data('no-style')) {
                setTimeout(function () {
                    $($this).button();
                }, 100);
            }

            $($this).click(function () {
                $('body').append('<div id="NavPwDialog" style="text-align: center"><input  type="password"  id="inp_NavPw"><input style="width: 100px; margin-top: 20px" id="btn_navPwOk" value="' + _('Ok') + '"><input id="btn_navPwcancel" value="' + _('Cancel') + '" style="width: 100px; margin-top: 20px"></div>');

                $('#inp_NavPw').change(function () {
                    check_pw();
                });
                $('#btn_navPwOk').button().click(function () {
                    check_pw();
                });

                function check_pw() {
                    var $inputPass = $('#inp_NavPw');
                    if (data._data.Password === $inputPass.val()) {
                        $('#NavPwDialog').remove();
                        vis.changeView(data.attr('nav_view'), data.attr('nav_view'), {
                                    effect: data.attr('hide_effect'),
                                    options: {},
                                    duration: data.attr('hide_duration')
                                }, {
                                    effect: data.attr('show_effect'),
                                    options: {},
                                    duration: data.attr('show_duration')
                                },
                                data.attr('sync'));
                    } else {
                        $inputPass.val('');
                        var bg = $inputPass.data('bg');
                        if (!bg) {
                            bg = $inputPass.css('background-color');
                            $inputPass.data('bg', bg);
                        }
                        $inputPass.css('background-color', '#FF0000').animate({'background-color': bg}, 500);
                    }
                }

                $('#btn_navPwcancel').button().click(function () {
                    $('#NavPwDialog').remove();
                });

                $('#NavPwDialog').dialog({
                    title: _('Password'),
                    modal: true
                });
            })
        }
    };
</script>

<script id="tplJquiButtonLink"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiButtonLink" style=" position: relative; text-align: initial;"><div class="vis-widget_prev ui-selectee ui-selected" style="height: 30px"> <div class="vis-widget-prev-body"> <input type="button" value=" Button " class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="static"
        data-vis-name="Button Link"
        data-vis-attrs="buttontext[Text];href;html_prepend/html;html_append/html;padding[5]/slider,0,100,1;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" data-vis-resizable='{"disabled":true}'>
        <div class="vis-widget-body" >
            <%== this.data.attr('html_prepend') %>
            <button style="width: 100%; height: 100%" data-no-style="<%= this.data.attr('no_style') %>" data-vis-link="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.jqueryui.buttonLink(el, data.attr('href')); %> style="padding: <%= this.data.attr('padding') %>px"><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplJquiButtonLinkBlank"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiButtonLinkBlank" style=" position: relative; text-align: initial;padding: 4px;height: 30px"><div  style="height: 30px" class="vis-widget_prev ui-selectee ui-selected ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":"e"}"> <div class="vis-widget-prev-body"> <input type="button" value=" Link " data-vis-link="" class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="static"
        data-vis-name="Button Link _blank"
        data-vis-attrs="buttontext[Text];href;html_prepend/html;html_append/html;padding[5]/slider,0,100,1;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" >
        <div class="vis-widget-body" >
            <%== this.data.attr('html_prepend') %>
            <button style="width: 100%; height: 100%" data-no-style="<%= this.data.attr('no_style') %>" data-vis-link="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.jqueryui.buttonLinkBlank(el, data.attr('href')); %> style="padding: <%= this.data.attr('padding') %>px"><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplIconLink"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplIconLink" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 119px; height: 30px;"> <div class="vis-widget-prev-body"> <a class="widget-link" href="" target="" style="white-space:no-wrap; text-decoration: none; text-align: left; width:100%;height:100%;"> <img src="widgets/jqui/img/internet-web-browser-2.png" style=" vertical-align: middle; height: 100%;" alt=""> Icon link </a> </div> </div></div>'
        data-vis-type="static"
        data-vis-name="Icon link"
        data-vis-attrs="src/image;imageHeight/slider,0,200,1;href;target/auto,,_blank,_self,_parent,_top;alt;text;invert_icon/checkbox">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 76px; height: 32px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.jqueryui.classes(el) %>>
        <div class="vis-widget-body">
            <a class="widget-link" href="<%== this.data.attr('href') %>" target="<%== this.data.attr('target') %>" style="white-space:no-wrap; text-decoration: none; text-align: left; width:100%; height:100%;">
                <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="<%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" />
                <%== this.data.attr('text') %>
            </a>
        </div>
    </div>
</script>

<script id="tplIconHttpGet"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplIconHttpGet" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 97px; height: 38px; " > <div class="vis-widget-prev-body"> <a class="widget-link" style="white-space:no-wrap; text-decoration:none;text-align:left;width:100%;height:100%;"><img style="vertical-align:middle;height:100%;">URL GET</a></div></div></div>'
        data-vis-type="static"
        data-vis-name="Icon HTTP GET"
        data-vis-attrs="url;src/image;imageHeight/slider,0,200,1;alt;text">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
    styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 76px; height: 76px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.jqueryui.classes(el) %>>
        <div class="vis-widget-body">
            <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="<%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %>
            <div <%= (el) -> vis.binds.jqueryui.iconHttpGet(el, data.attr('url')) %> />
        </div>
    </div>
</script>

<script id="tplJquiDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-type="static,dialog"
        data-vis-prev='<img src="widgets/jqui/img/Prev_JquiDialog.png"></img>'
        data-vis-name="HTML - Dialog"
        data-vis-attrs="html/text;setId/id;setValue;"
        data-vis-attrs0="group.dialog;html_dialog/text;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;persistent/checkbox;preload/checkbox;closeOnClick/checkbox;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px; border: 1px solid #000; background: #fff; cursor: pointer" id="<%= this.data.attr('wid') %>" data-no-style="<%= this.data.attr('no_style') %>" >
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
            <%== this.data.attr('html') %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" class="vis-widget-dialog" title="<%= this.data.attr('title') %>">
            <%== this.data.attr('preload') ? this.data.attr('html_dialog') : '' %>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, data.attr('persistent'), data.attr('preload'), data.attr('html_dialog'), data.attr('closeOnClick')) %> />
    </div>
</script>

<script id="tplJquiIconDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<img src="widgets/jqui/img/Prev_JquiIconDialog.png"></img>'
        data-vis-type="static,dialog"
        data-vis-name="Icon - Dialog"
        data-vis-attrs="src/image;imageHeight/slider,0,200,1;alt;text;invert_icon/checkbox;setId/id;setValue;"
        data-vis-attrs0="group.dialog;html_dialog/text;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;persistent/checkbox;preload/checkbox;closeOnClick/checkbox;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 76px; height: 76px; cursor: pointer" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.jqueryui.classes(el) %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
            <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="<%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" class="vis-widget-dialog" title="<%= this.data.attr('title') %>">
            <%== this.data.attr('preload') ? this.data.attr('html_dialog') : '' %>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, data.attr('persistent'), data.attr('preload'), data.attr('html_dialog'), data.attr('closeOnClick')) %> />
    </div>
</script>

<script id="tplContainerDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<img src="widgets/jqui/img/Prev_ContainerDialog.png"></img>'
        data-vis-type="container,dialog"
        data-vis-name="container - HTML - view in jqui Dialog"
        data-vis-attrs="html/text;contains_view/views;setId/id;setValue;"
        data-vis-attrs0="group.dialog;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px; border: 1px solid #000; background: #fff; cursor: pointer" id="<%= this.data.attr('wid') %>">
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
            <%== this.data.attr('html') %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" style="display: none" class="vis-widget-dialog" title="<%= this.data.attr('title') %>">
            <div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container"></div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogContainer(el, data) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplContainerDialogExternal"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-type="container,dialog"
        data-vis-prev='<img src="widgets/jqui/img/Prev_ContainerDialogExternal.png"></img>'
        data-vis-name="container - ext cmd - view in jqui Dialog"
        data-vis-attrs="html/text;contains_view/views;setId/id;setValue;"
        data-vis-attrs0="group.dialog;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 194px; height: 68px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="display:none; width: 190px; height: 64px; background-color: #333; color: #eee; cursor: pointer; border: 2px dashed red; opacity:0.8;">
            <b>External Container Dialog</b><br/>
            view: <%= this.data.attr('contains_view') %><br/>
            id: <%= this.data.attr('wid') %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" style="display:none" class="vis-widget-dialog" title="<%= this.data.attr('title') %>">
            <div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container">
            </div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogContainer(el, data) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplContainerIconDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="container,dialog"
        data-vis-set="jqui"
        data-vis-prev='<img src="widgets/jqui/img/Prev_ContainerIconDialog.png"></img>'
        data-vis-name="container - Icon - view in jqui Dialog"
        data-vis-attrs="src/image;imageHeight/slider,0,200,1;alt;text;setId/id;setValue;"
        data-vis-attrs0="group.dialog;contains_view/views;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;invert_icon/checkbox;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>

    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 76px; height: 76px; cursor: pointer" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.jqueryui.classes(el) %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
            <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="<%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" style="display:none" class="vis-widget-dialog" title="<%= this.data.attr('title') %>">
            <div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container"></div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogContainer(el, data) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplContainerButtonDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-type="container,dialog"
        data-vis-prev='<img src="widgets/jqui/img/Prev_ContainerButtonDialog.png"></img>'
        data-vis-name="container - Button - view in jqui Dialog"
        data-vis-attrs="html_prepend/text;html_append/text;buttontext[Text];setId/id;setValue;no_style/checkbox;"
        data-vis-attrs0="group.dialog;contains_view/views;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;padding[5]/slider,0,100,1;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>">
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
            <%== this.data.attr('html_prepend') %>
            <button id="<%= this.data.attr('wid') %>_button" name="<%= this.data.attr('wid') %>_button" data-no-style="<%= this.data.attr('no_style') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.jqueryui.buttonDialog(el); %> style="padding: <%= this.data.attr('padding') %>px"><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr('html_append') %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" style="display:none" class="vis-widget-dialog" title="<%= this.data.attr('title') %>">
            <div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container"></div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogContainer(el, data) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplJquiButtonDialogClose"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiButtonDialogClose" style=" position: relative; text-align: initial;padding: 4px;height: 30px"><div class="vis-widget_prev ui-selectee ui-draggable-handle "> <div class="vis-widget-prev-body"> <input type="button" value=" Dialog close " class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> '
        data-vis-set="jqui"
        data-vis-type="dialog"
        data-vis-name="Button dialog close"
        data-vis-attrs="html_prepend/text;html_append/text;buttontext[Close];iconClass[close];dlgName;hide_effect;hide_duration;show_effect;show_duration;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <%== this.data.attr('html_prepend') %>
            <button style="width:100%; height:100%" data-no-style="<%= this.data.attr('no_style') %>" <%= (el) -> vis.binds.jqueryui.dialogClose(el, {hideOptions: {effect: data.attr('hide_effect'), options:{}, duration: data.attr('hide_duration')}, iconClass: data.attr('iconClass'), dlgName: data.attr('dlgName')}) %>><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplJquiButtonNav"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiButtonNav" style=" position: relative; text-align: initial;padding: 4px;height: 30px"><div class="vis-widget_prev ui-selectee ui-draggable-handle " style="left: 167px; top: 129px;" > <div class="vis-widget-prev-body"> <input type="button" value=" Nav Button " class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> '
        data-vis-set="jqui"
        data-vis-type="navigation"
        data-vis-name="Button"
        data-vis-attrs="html_prepend/text;html_append/text;buttontext[Text];nav_view;hide_effect;hide_duration;show_effect;show_duration;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <%== this.data.attr('html_prepend') %>
            <button style="width: 100%; height: 100%" data-no-style="<%= this.data.attr('no_style') %>" <%= (el) -> vis.binds.jqueryui.button(el); vis.binds.jqueryui.navigationActive(el, data.attr('nav_view')); vis.binds.basic.navigation(el, {nav_view:data.attr('nav_view'),hideOptions:{effect:data.attr('hide_effect'),options:{},duration:data.attr('hide_duration')},showOptions:{effect:data.attr('show_effect'),options:{},duration:data.attr('show_duration')}}) %> ><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplJquiIconNav"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplJquiIconNav" style="position: relative; text-align: initial;padding: 4px "><div data-vis-nav="" class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default jqui-nav-state " style="width: 100px; height: 28px;"> <div class="vis-widget-prev-body"> <img src="widgets/jqui/img/internet-web-browser-2.png" style="vertical-align:middle;height:100%;">&nbsp;Nav</div></div></div>'
        data-vis-name="navigation - Icon"
        data-vis-attrs="src/image;imageHeight/slider,0,200,1;alt;text;nav_view;hide_effect;hide_duration;show_effect;show_duration">
    <div
        data-vis-nav="<%= this.data.attr('nav_view') %>"
        class="vis-widget ui-widget ui-button ui-corner-all ui-state-default jqui-nav-state <%== this.data.attr('class') %>"
        style="width: 76px; height: 76px;"
        id="<%= this.data.attr('wid') %>"
        <%= (el) -> vis.binds.jqueryui.classes(el); vis.binds.jqueryui.navigationActive(el, data.attr('nav_view')); vis.binds.basic.navigation(el, {nav_view: data.attr('nav_view'), hideOptions: {effect: data.attr('hide_effect'), options: {}, duration: data.attr('hide_duration')}, showOptions: {effect: data.attr('show_effect'), options: {}, duration: data.attr('show_duration')}}) %>
    >
        <div class="vis-widget-body">
            <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %>
        </div>
    </div>
</script>

<script id="tplJquiNavPw"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplJquiNavPw" style=" position: relative; text-align: initial;padding: 4px " class="wid_prev_content"><div class="vis-widget_prev ui-selectee ui-draggable-handle " style="top: 445px; left: 314px; width: 116px; height: 35px;"> <div class="vis-widget-prev-body" style="text-align: center"> <label style=" display: none;">Input</label><input type="text" value="Nav button Pw" size="10" data-o="" class="ui-button ui-widget ui-state-default ui-corner-all" role="button" style="height: 20px;font-family: inherit; font-size: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; line-height: inherit; text-align: left; outline: none; cursor: text;"> </div> </div></div>'
        data-vis-name="navigation - Pw"
        data-vis-attrs="buttontext[Text];Password;nav_view;hide_effect;hide_duration;show_effect;show_duration;sync/checkbox;no_style/checkbox">
       <div class="vis-widget <%== this.data.attr('class') %>" style="width:76px;height:30px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <button style="width:100%; height:100%" data-no-style="<%= this.data.attr('no_style') %>" <%= (el) -> vis.binds.jqueryui.navigationPw(el, data)%> ><%== this.data.attr('buttontext') %></button>
        </div>
    </div>
</script>

<script id="tplJquiInput"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiInput" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee ui-draggable-handle " style="top: 445px; left: 314px; width: 116px; height: 30px;" > <div class="vis-widget-prev-body" style="text-align: center"> <label style=" display: none;">Input</label><input type="text" value=" Input" size="10" data-o class="ui-button ui-widget ui-state-default ui-corner-all" role="button" style="font-family: inherit; font-size: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; line-height: inherit; text-align: left; outline: none; cursor: text;"> </div> '
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Input"
        data-vis-attrs="label[Input];oid;asString/checkbox;digits[0]/slider,0,10,1;size[10]/slider,10,100,1;"
        data-vis-attrs0="autoFocus/checkbox;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:275px;height:44px;" id="<%= this.data.attr('wid') %>" data-no-style="<%= this.data.attr('no_style') %>" >
        <div class="vis-widget-body">
            <label for="<%= this.data.attr('wid') %>_input"><%= ((this.data.attr('label') === undefined || this.data.attr('label') === null) ? '' : this.data.attr('label')) %></label>
            <input
                type="text"
                name="<%= this.data.attr('wid') %>_input"
                id="<%= this.data.attr('wid') %>_input"
                value=""
                size="<%= this.data.attr('size') %>"
                data-oid="<%= this.data.attr('oid') %>"
                <%= (el) -> vis.binds.jqueryui.input(el, data.digits, data.asString); %>
			    <%= this.data.attr('autoFocus') === true || this.data.attr('autoFocus') === 'true' ? ' autofocus ' : '' %>
            />
        </div>
    </div>
</script>

<script id="tplJquiBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-prev='<div id="prev_tplJquiBool" style="position: relative; text-align: initial;padding: 4px "><div class="ui-widget ui-corner-all ui-state-default vis-widget_prev " style="width: 79px; height: 25px;"> <div class="vis-widget-prev-body" style="text-align: center;padding-top: 5px;"> true/false</div> </div></div>'
        data-vis-name="Html Bool"
        data-vis-attrs="oid;html_true;html_false">

    <div class="ui-widget ui-corner-all ui-state-default vis-widget <%== this.data.attr('class') %>" style="width:76px; height:76px" id="<%= this.data.attr('wid') %>"  data-no-style="<%= this.data.attr('no_style') %>"  data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.toggle(el); vis.binds.jqueryui.classes(el) %>>
        <div class="vis-widget-body">
            <div>
                <% if (vis.binds.basic.isFalse(vis.states.attr(this.data.oid + '.val'))) { %>
                    <%== this.data.attr('html_false') %>
                <% } else { %>
                    <%== this.data.attr('html_true') %>
                <% } %>
            </div>
        </div>
    </div>
</script>

<script id="tplJquiToogle"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiToogle" style="position: relative; text-align: initial;padding: 4px "><div class="ui-widget ui-corner-all ui-state-default vis-widget_prev" style="width: 90px; height: 19px; padding: 10px;"> <div class="vis-widget-prev-body"><label>&nbsp;Toggle&nbsp;</label><img class="imgToggleFalse" src="/vis/icon/add.png" style=" vertical-align:middle; height:100%"></div></div></div>'
        data-vis-set="jqui"
        data-vis-type="ctrl,state"
        data-vis-name="Icon Toggle"
        data-vis-attrs="label;oid;src_true/image;imageHeight/slider,0,200,1;alt_true;src_false/image;alt_false;invert_icon/checkbox">

    <div class="ui-widget ui-corner-all ui-state-default vis-widget <%== this.data.attr('class') %>" style="width:76px; height:76px" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.toggle(el); vis.binds.jqueryui.classes(el) %> >
        <div class="vis-widget-body">
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
            }
            %>
            <label style="margin: 0" for="<%= this.data.attr('wid') %>_input"><%== this.data.attr('label') %></label>
            <img class="imgToggleFalse" <%= this.data.attr('src_false') ? 'src="' +  this.data.attr('src_false') + '"' : '' %> style="<%= styles %> vertical-align: middle; height:<%= this.data.attr('imageHeight') || 100 %>%"               alt="<%== this.data.attr('alt_false') %>" />
            <img class="imgToggleTrue"  <%= this.data.attr('src_true')  ? 'src="' +  this.data.attr('src_true')  + '"' : '' %> style="<%= styles %> vertical-align: middle; height:<%= this.data.attr('imageHeight') || 100 %>%; display:none" alt="<%== this.data.attr('alt_true')  %>" />
            <div <%= (el) -> vis.binds.jqueryui.itoggle(el) %>></div>
        </div>
    </div>
</script>

<script id="tplJquiInputDate"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplJquiInputDate" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 110px; height: 25px; overflow: visible; "> <div class="vis-widget-prev-body"> <input type="text" value="2015-09-20" size="10" class="ui-widget ui-button ui-corner-all ui-state-default" style="font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; text-align: left; outline: none; cursor: text;text-align:center;"></div> </div></div>'
        data-vis-name="ctrl - Input Date"
        data-vis-attrs="oid/id;size[10]/slider,1,50,1;"
        data-vis-attrs0="autoFocus/checkbox;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:200px;height:40px;overflow: visible;text-align:center;" id="<%= this.data.attr('wid') %>">
        <% if (vis.editMode) { %>
			<div class="editmode-helper" />
		<% } %>
        <div class="vis-widget-body">
            <input
                type="text"
                style="text-align: center; padding-left: 5px"
                name="<%= this.data.attr('wid') %>_input"
                id="<%= this.data.attr('wid') %>_input"
                value=""
                size="<%= this.data.attr('size') %>"
                data-oid="<%= this.data.attr('oid') %>"
                <%= (el) -> vis.binds.jqueryui.inputDate(el); %>
			    <%= this.data.attr('autoFocus') === true || this.data.attr('autoFocus') === 'true' ? 'autofocus' : '' %>
            />
        </div>
    </div>
</script>

<script id="tplJquiInputDatetime"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplJquiInputDatetime" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 110px; height: 39px; overflow: visible; text-align: center;"> <div class="vis-widget-prev-body"> <input type="text" style="text-align: left; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; outline: none; cursor: text; " value="18:00:00" size="5" class="ui-state-default ui-widget ui-button ui-corner-all"> </div> </div></div>'
        data-vis-name="ctrl - Input Datetime"
        data-vis-attrs="oid;size/slider,1,50,1;timeOnly/checkbox;hideSeconds/checkbox;stepMinute/slider,1,30,1;showGrid/checkbox;"
        data-vis-attrs0="autoFocus/checkbox;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:200px;height:40px;overflow: visible;text-align:center;" id="<%= this.data.attr('wid') %>">
        <% if (vis.editMode) { %>
			<div class="editmode-helper" />
		<% } %>
        <div class="vis-widget-body">
            <input
                type="text"
                style="text-align: center; padding-left: 5px"
                name="<%= this.data.attr('wid') %>_input"
                id="<%= this.data.attr('wid') %>_input"
                value=""
                size="<%= this.data.attr('size') %>"
                data-oid="<%= this.data.attr('oid') %>"
                <%= (el) -> vis.binds.jqueryui.inputDatetime(el, {timeOnly: data.attr('timeOnly'), showSecond: !data.attr('hideSeconds'), stepMinute: data.attr('stepMinute'), showGrid: data.attr('showGrid')}); %>
			    <%= this.data.attr('autoFocus') === true || this.data.attr('autoFocus') === 'true' ? 'autofocus' : '' %>
            />
        </div>
    </div>
</script>

<script id="tplJquiInputSet"
        type="text/ejs" class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplJquiInputSet" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 90px; height: 32px; overflow: visible;"> <div class="vis-widget-prev-body"> <label></label> <input type="text" value="Input" size="2" style="font-size: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; font-family: inherit; padding-left: 5px; padding-right: 5px; text-align: left; outline: none; cursor: text;height:14px" class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> <input type="button" style="padding-left: 5px; padding-right: 5px;" value="Set" class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> </div></div>'
        data-vis-name="ctrl - Input + Set-Button"
        data-vis-attrs="title;buttontext[Text];oid;unit;asString/checkbox;digits/slider,0,10,1;size/slider,1,50,1;"
        data-vis-attrs0="autoFocus/checkbox;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:300px;height:44px;overflow:visible" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <label for="<%= this.data.attr('wid') %>_input"><%== this.data.attr('title') %></label>
            <input
                type="text"
                name="<%= this.data.attr('wid') %>_input"
                id="<%= this.data.attr('wid') %>_input"
                data-no-style="<%= this.data.attr('no_style') %>"
                size="<%= this.data.attr('size') %>"
                style="font-size: 1.1em !important; padding: 0 0"
                <%= this.data.attr('autoFocus') === true || this.data.attr('autoFocus') === 'true' ? 'autofocus' : '' %>
            />
            <%== this.data.attr('unit') %>
            <input type="button" style="height: 100%" data-oid="<%= this.data.attr('oid') %>" name="<%= this.data.attr('wid') %>_set" id="<%= this.data.attr('wid') %>_set" value="<%== this.data.attr('buttontext') %>"  data-no-style="<%= this.data.attr('no_style') %>" <%= (el) -> vis.binds.jqueryui.inputset(el, data.digits, data.asString); %>/>
        </div>
    </div>
</script>

<script id="tplJquiButtonState"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiButtonState" style=" position: relative; text-align: initial;padding: 4px; height: 30px "><div style="left: 384px; top: 470px;" class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":"e"}"> <div class="vis-widget-prev-body"> <input type="button" value=" Button " data-o data-val="" class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Button State"
        data-vis-attrs="oid;html_prepend/html;html_append/html;buttontext[Text];value;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" >
            <%== this.data.attr('html_prepend') %>
            <button style="width:100%; height:100%" data-oid="<%= this.data.attr('oid') %>"  data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.jqueryui.button(el, data.value); vis.binds.basic.state(el); %>><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplJquiRadio"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiRadio" style=" position: relative; text-align: initial;padding: 4px;height: 30px"><div style="top: 243px; left: 348px; font-size: 9px;" class="vis-widget_prev ui-selectee ui-selected ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":""}"> <div class="vis-widget-prev-body"> <div data-o class="ui-buttonset"> <input type="radio" value="0" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-left" role="button" aria-pressed="false"><span class="ui-button-text">OFF</span></label> <input type="radio" value="1" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-right ui-state-active" role="button" aria-pressed="true"><span class="ui-button-text">ON</span></label> </div> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Radiobuttons on/off"
        data-vis-attrs="off_text[OFF];on_text[ON];oid;padding[5]/slider,0,100,1">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" data-vis-resizable='{"disabled":true, "handles":""}' >
        <div class="vis-widget-body" >
            <div id="<%= this.data.attr('wid') %>_radio" data-oid="<%= this.data.attr('oid') %>" style="display: flex" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
                <input type="radio" id="<%= this.data.attr('wid') %>_radio0" name="<%= this.data.attr('wid') %>_radio" value="0" checked='checked'/><label for="<%= this.data.attr('wid') %>_radio0" style="padding: <%= this.data.attr('padding') %>px"><%= this.data.off_text %></label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio1" name="<%= this.data.attr('wid') %>_radio" value="1"/><label for="<%= this.data.attr('wid') %>_radio1" style="padding: <%= this.data.attr('padding') %>px"><%= this.data.on_text %></label>
            </div>
        </div>
    </div>
</script>

<script id="tplJquiRadioList"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiRadioList" style=" position: relative; text-align: initial;padding: 4px "><div style="font-size: 8px;overflow:visible;height:20px" class="vis-widget_prev ui-selectee ui-selected ui-draggable-handle"> <div class="vis-widget-prev-body"> <div data-o class="ui-buttonset"> <input type="radio" value="0" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-left" role="button" aria-pressed="false"><span class="ui-button-text">OFF</span></label> <input type="radio" value="1" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-right" role="button" aria-pressed="false"><span class="ui-button-text">AUTO</span></label> </div> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Radiobuttons ValueList"
        data-vis-attrs="oid;values[0§1§2];texts[OFF§ON§AUTO]">
    <div style=" width:250px; height:41px;overflow: visible" class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" data-vis-resizable='{"disabled":true, "handles":""}' >
        <div class="vis-widget-body" >
            <table id="<%= this.data.attr('wid') %>_radio" data-oid="<%= this.data.attr('oid') %>" style="display: flex" <%= (el) -> setTimeout(function () {vis.binds.jqueryui.radio(el)}, 100) %> class="vis-no-spaces"><tr class="vis-no-spaces">
                <%
                var values = (data.attr('values') ? data.attr('values').split(';') : []);
                var texts  = (data.attr('texts') ? data.attr('texts').split(';'): []);
                var wid = data.attr('wid');
                for (var val in values) {
                %>
                    <td class="vis-no-spaces"><input type="radio" id="<%= wid %>_radio<%= val %>" name="<%= wid %>_radio" value="<%== values[val] %>" /><label style="float: left" for="<%= wid %>_radio<%= val %>"><%= texts[val] %></label></td>
                <%
                }
                %>
            </tr></table>
        </div>
    </div>
</script>

<script id="tplJquiSelectList"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiSelectList" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":""}" style="left: 336px; top: 323px;"> <div class="vis-widget-prev-body"> <select data-o disabled="" style="display: none;"> <option value="0">OFF</option> <option value="1">ON</option> <option value="2">AUTO</option> </select><button type="button" class="ui-multiselect ui-widget ui-state-default ui-corner-all" aria-haspopup="true" style="width: 86px;"><span class="ui-icon ui-icon-triangle-2-n-s"></span><span>OFF</span></button> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Select ValueList"
        data-vis-attrs="oid;values[0§1§2]/text;texts[OFF§ON§AUTO]/text;height[100]/slider,15,500,1;open/checkbox;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" >
        <div class="vis-widget-body" >
            <select id="<%= this.data.attr('wid') %>_multiselect" data-no-style="<%= this.data.attr('no_style') %>" data-oid="<%= this.data.attr('oid') %>" data-view="<%= this.view %>" <%= (el) -> setTimeout(function (el_) { vis.binds.jqueryui.multiselect(el_, {height: (data.height || 220)}, data.open)}, 250, el); %> >
            <%
				var values = (data.attr('values') ? data.attr('values').split(';') : []);
				var texts  = (data.attr('texts')  ? data.attr('texts').split(';')  : []);
				for (var val in values) {
					%>
					<option value="<%= values[val] %>"><%= texts[val] %></option>
					<%
				}
            %>
            </select >
        </div>
    </div>
</script>

<script id="tplJquiRadioSteps"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiRadioSteps" style="zoom: 0.99; position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":"e"}" style="left: 85px; top: 258px; font-size: 5px;"> <div class="vis-widget-prev-body"> <div data-o class="ui-buttonset"> <input type="radio" value="0" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-left" role="button" aria-pressed="false"><span class="ui-button-text">aus</span></label> <input type="radio" value="0.25" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only" role="button" aria-pressed="false"><span class="ui-button-text">25%</span></label> <input type="radio" value="0.5" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only" role="button" aria-pressed="false"><span class="ui-button-text">50%</span></label> <input type="radio" value="0.75" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-state-active" role="button" aria-pressed="true"><span class="ui-button-text">75%</span></label> <input type="radio" value="1" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-right" role="button" aria-pressed="false"><span class="ui-button-text">100%</span></label> </div> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Radiobuttons 25%"
        data-vis-attrs="oid;min;max">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" data-vis-resizable='{"disabled": true, "handles": "e"}' >
        <div class="vis-widget-body" >
            <div id="<%= this.data.attr('wid') %>_radio"  data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
                <input type="radio" id="<%= this.data.attr('wid') %>_radio0" name="<%= this.data.attr('wid') %>_radio" value="<%= vis.binds.jqueryui.calcValue(0,    this.data.attr('min'), this.data.attr('max')) %>" checked='checked'/><label for="<%= this.data.attr('wid') %>_radio0">aus</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio1" name="<%= this.data.attr('wid') %>_radio" value="<%= vis.binds.jqueryui.calcValue(0.25, this.data.attr('min'), this.data.attr('max')) %>" checked='checked'/><label for="<%= this.data.attr('wid') %>_radio1">25%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio2" name="<%= this.data.attr('wid') %>_radio" value="<%= vis.binds.jqueryui.calcValue(0.5,  this.data.attr('min'), this.data.attr('max')) %>" checked='checked'/><label for="<%= this.data.attr('wid') %>_radio2">50%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio3" name="<%= this.data.attr('wid') %>_radio" value="<%= vis.binds.jqueryui.calcValue(0.75, this.data.attr('min'), this.data.attr('max')) %>" checked='checked'/><label for="<%= this.data.attr('wid') %>_radio3">75%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio4" name="<%= this.data.attr('wid') %>_radio" value="<%= vis.binds.jqueryui.calcValue(1,    this.data.attr('min'), this.data.attr('max')) %>"/><label for="<%= this.data.attr('wid') %>_radio4">100%</label>
            </div>
        </div>
    </div>
</script>

<script id="tplJquiSliderVertical"
        type="text/ejs"
        data-vis-attrs="oid;oid-2;oid-working;oid-2-working;min;max;step;inverted/checkbox;submitmethod/nselect,scroll,stop"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiSliderVertical" style="position: relative; text-align: initial;padding: 4px;overflow:visible;height:50px"><div class="vis-widget_prev " style="width: 23px; height: 30px; overflow: visible !important;"> <div class="vis-widget-prev-body " style="width: 100%; padding: 4px; "> <div class="sliderJQUI ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" id="19vlqqb6r_slider" data-oid="nothing_selected" data-oid-working="" style="height:100%"><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="bottom: 0%;"></span></div></div> </div></div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Slider vertical">
    <div id="<%= this.data.attr('wid') %>" data-vis-resizable='{"minWidth":23, "maxWidth":23}' class="vis-widget" style="width:23px; height:160px; overflow:visible !important;">
        <div class="vis-widget-body <%== this.data.attr('class') %>" style="width: 100%; padding: 4px; ">
            <div class="sliderJQUI" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid') %>" data-oid2="<%= this.data.attr('oid-2') %>" data-oid-working="<%= this.data.attr('oid-working') %>"  data-oid2-working="<%= this.data.attr('oid-2-working') %>"<%= (el) -> vis.binds.jqueryui.slider(el, {min: parseFloat(data.min), max: parseFloat(data.max), step: parseFloat(data.step), orientation:"vertical", inverted: data.inverted, submitmethod: data.submitmethod}) %> style="height:100%"/></div>
        </div>
    </div>
</script>

<script id="tplJquiSlider"
        type="text/ejs"
        data-vis-attrs="oid;oid-2;oid-working;oid-2-working;min;max;step;inverted/checkbox;submitmethod/nselect,scroll,stop"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiSlider" style="position: relative; text-align: initial;padding: 4px;overflow:visible"><div class="vis-widget_prev " style="width: 80px; overflow: visible !important; left: 475px; top: 188px; position: absolute; height: 23px;"> <div class="vis-widget-prev-body " style="padding: 4px;"> <div class="sliderJQUI ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="19vlqppi9_slider" data-oid="nothing_selected" data-oid-working=""><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 0%;"></span></div></div> </div></div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Slider horizontal">
    <div id="<%= this.data.attr('wid') %>" data-vis-resizable='{"minHeight":23, "maxHeight":23}' class="vis-widget" style="height:23; width:160px; overflow:visible !important;">
        <div class="vis-widget-body <%== this.data.attr('class') %>" style="padding: 4px;">
            <div class="sliderJQUI" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid') %>" data-oid2="<%= this.data.attr('oid-2') %>" data-oid-working="<%= this.data.attr('oid-working') %>"  data-oid2-working="<%= this.data.attr('oid-2-working') %>"<%= (el) -> vis.binds.jqueryui.slider(el, {min:parseFloat(data.min),max:parseFloat(data.max),step:parseFloat(data.step), inverted: data.inverted, submitmethod: data.submitmethod}) %> /></div>
        </div>
    </div>
</script>

<script id="tplIconState"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplIconState" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 122.4px; height: 32.4px; position: absolute; left: 237px; top: 201px;" id="19vlr5eto" data-oid="dev1" data-val="value"> <div class="vis-widget-prev-body"> <img src="widgets/jqui/img/internet-web-browser-2.png" style=" vertical-align:middle;height:100%;" alt="">set value </div> </div></div>'
        data-vis-set="jqui"
        data-vis-name="ctrl - Icon State"
        data-vis-attrs="oid;value;text;src/image;imageHeight/slider,0,200,1;alt;invert_icon/checkbox">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.basic.state(el); vis.binds.jqueryui.classes(el, null, data.value) %>>
        <div class="vis-widget-body">
            <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="<%= styles %> vertical-align: middle; height:<%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %>
        </div>
    </div>
</script>

<script id="tplIconStateBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplIconStateBool" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 100px; height: 25px;" > <div class="vis-widget-prev-body"> <img class="tplImgFalse" src="/vis/img/bulb_on.png" style=" vertical-align:middle;height:100%;" alt="">set value </div> </div></div>'
        data-vis-name="ctrl - Icon State / val - Icon Bool"
        data-vis-attrs="oid;click_id/id;click_value;false_text;true_text;false_src/image;true_src/image;imageHeight/slider,0,200,1;false_alt;true_alt;invert_icon/checkbox">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('click_value') %>" <%= (el) -> vis.binds.basic.state(el, this.data.attr('click_id')); vis.binds.jqueryui.classes(el, null, data.click_value) %>>
        <div class="vis-widget-body">
            <img class="imgToggleFalse" <%= this.data.attr('false_src') ? 'src="' +  this.data.attr('false_src') + '"' : '' %> style="               <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('false_alt') %>"/ ><span class="imgToggleFalse"><%= this.data.attr('false_text') %></span>
            <img class="imgToggleTrue"  <%= this.data.attr('true_src')  ? 'src="' +  this.data.attr('true_src')  + '"' : '' %> style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('true_alt')  %>" /><span class="imgToggleTrue" style="display: none"><%= this.data.attr('true_text')  %></span>
            <div <%= (el) -> vis.binds.jqueryui.itoggle(el) %>></div>
        </div>
    </div>
</script>

<script id="tplIconStatePushButton"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplIconStateBool" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 100px; height: 25px;" > <div class="vis-widget-prev-body"> <img class="tplImgFalse" src="/vis/img/bulb_on.png" style=" vertical-align:middle;height:100%;" alt="">set value </div> </div></div>'
        data-vis-name="ctrl - Icon PushButton / val - Icon Bool"
        data-vis-attrs="oid;click_id/id;false_text;true_text;false_src/image;true_src/image;imageHeight/slider,0,200,1;false_alt;true_alt;invert_icon/checkbox">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.pushbutton(el, this.data.attr('click_id')); vis.binds.jqueryui.classes(el, null, data.click_value) %>>
        <div class="vis-widget-body">
            <img class="imgToggleFalse" <%= this.data.attr('false_src') ? 'src="' +  this.data.attr('false_src') + '"' : '' %> style="               <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('false_alt') %>"/ ><span class="imgToggleFalse"><%= this.data.attr('false_text') %></span>
            <img class="imgToggleTrue"  <%= this.data.attr('true_src')  ? 'src="' +  this.data.attr('true_src')  + '"' : '' %> style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('true_alt')  %>" /><span class="imgToggleTrue" style="display: none"><%= this.data.attr('true_text')  %></span>
            <div <%= (el) -> vis.binds.jqueryui.itoggle(el) %>></div>
        </div>
    </div>
</script>

<script id="tplIconInc"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplIconInc" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default ui-state-active " style="width: 44px; height: 20px;" data-vis-step="1" data-val=""> <div class="vis-widget-prev-body"> <img style=" vertical-align:middle;height:100%;">+1 </div> </div></div>'
        data-vis-set="jqui"
        data-vis-name="ctrl - Icon Increment"
        data-vis-attrs="oid;step[1];minmax[100];text[+1];src/image;imageHeight/slider,0,200,1;alt;repeat_delay[800];repeat_interval[800];invert_icon/checkbox">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-vis-step="<%= this.data.attr('step') %>" data-val="<%= this.data.attr('active_value') %>" <%= (el) -> vis.binds.basic.increment(el,data.minmax,data.repeat_delay,data.repeat_interval); vis.binds.jqueryui.classes(el, null, data.minmax) %>>
        <div class="vis-widget-body">
            <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="<%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %>
        </div>
    </div>
</script>

<!-- --------------jqui.html--- END -->
<!-- --------------metro.html--- START -->
<!--

    ioBroker.vis Metro Widget-Set

    version: "1.2.0"

    6'2014-2022 hobbyquaker, bluefox

    based on http://metroui.org.ua/

    TODO:
        - Attribute für vordefinierte fg-CSS-Klassen
        - Attribute für font-size, text-align, color, padding, margin in tile.content
        - Tile das JSON-Tabellen durchscrollt
        - content_oid Attribut für mehr Tiles
        - Doku

-->

<link rel="stylesheet" href="widgets/metro/css/iconFont.min.css" />
<link rel="stylesheet" href="widgets/metro/css/metro-bootstrap.css" />
<script type="text/javascript" src="widgets/metro/js/metro.js"></script>

<script type="text/javascript">

    'use strict';
    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {

            "select_current": {
                "en": "Select current view",
                "de": "Aktuelle View selektieren",
                "ru": "Отметить текущую"
            },
            "label":            {"en": "Label",             "de": "Beschriftung",           "ru": "Надпись"},
            "autoclose":        {"en": "Auto close",        "de": "Auto-zu",                "ru": "Автозакрытие"},
            "label_prepend":    {"en": "Label prepend",     "de": "Vor Beschriftung",       "ru": "Перед надписью"},
            "label_append":     {"en": "Label append",      "de": "Nach Beschriftung",      "ru": "После надписи"},
            "badge_label":      {"en": "Badge text",        "de": "Abzeichentext",          "ru": "Текст в бирке"},
            "dialog_url":       {"en": "Dialog URL",        "de": "Dialog URL",             "ru": "URL фрейма в диалоге"},
            "dialog_scroll":    {"en": "Scroll in iFrame",  "de": "Scroll im iFrame",       "ru": "Скролл в диалоге"},
            "icon":             {"en": "Icon URL",          "de": "Icon URL",               "ru": "URL иконки"},
            "icon_src":         {"en": "Icon URL",          "de": "Icon URL",               "ru": "URL иконки"},
            "icon_width":       {"en": "Icon width",        "de": "Iconbreite",             "ru": "Ширина иконки"},
            "icon_height":      {"en": "Icon height",       "de": "Iconhöhe",               "ru": "Высота иконки"},
            "icon_top":         {"en": "Icon left",         "de": "Icon-Offset von oben",   "ru": "Сдвиг иконки сверху"},
            "icon_left":        {"en": "Icon top",          "de": "Icon-Offset von links",  "ru": "Сдвиг иконки слева"},
            "icon_class":       {"en": "Icon class",        "de": "Ikonenklasse",           "ru": "Иконка"},
            "icon_badge":       {"en": "Icon badge",        "de": "Abzeichenikone",         "ru": "Иконка бирки"},
            "bg_class":         {"en": "Background",        "de": "Hintergrund",            "ru": "Фон"},
            "bg_class_active":  {"en": "Background active", "de": "Aktiver Hintergrund",    "ru": "Акивный Фон"},
            "badge_bg_class":   {"en": "Badge background",  "de": "Abzeichen- Hintergrund", "ru": "Фон бирки"},
            "badge_bg_class_active": {
                "en": "Badge background active",
                "de": "Aktiver Abzeichen- Hintergrund",
                "ru": "Фон активной бирки"
            },
            "brand_bg_class":   {"en": "Brand background", "de": "Brand- Hintergrund",      "ru": "Фон полоски"},
            "brand_bg_class_active": {
                "en": "Brand background active",
                "de": "Aktiver Brand- Hintergrund",
                "ru": "Фон активной полоски"
            },
            "badge_src":        {"en": "Badge URL",         "de": "Abzeichen URL",          "ru": "URL бирки"},
            "badge_src_false":  {"en": "Badge URL",         "de": "Abzeichen URL",          "ru": "URL бирки"},
            "badge_src_true":   {"en": "Badge URL by true", "de": "Aktiv-Abzeichen URL",    "ru": "URL активной URL"},
            "badge_width":      {"en": "Badge width[%]",    "de": "Abzeichen-Breite[%]",    "ru": "Ширина бирки"},
            "badge_height":     {"en": "Badge height[%]",   "de": "Abzeichen-Höhe[%]",      "ru": "Высота бирки"},
            "badge_top":        {"en": "Badge top[%]",      "de": "Abzeichen-Top[%]",       "ru": "Отступ сверху для бирки"},
            "badge_left":       {"en": "Badge left[%]",     "de": "Abzeichen-Links[%]",     "ru": "Отступ слева для бирки"},
            "group_icon":       {"en": "Icon",              "de": "Icon",                  "ru": "Иконка"},
            "group_badge":      {"en": "Badge",             "de": "Abzeichen",              "ru": "Бирка"},
            "group_bg-and-text": {"en": "Background and label", "de": "Hintergrund und Titel", "ru": "Фон и надпись"},
            "group_dialog":     {"en": "Dialog",            "de": "Dialog",                 "ru": "Диалог"},
	        "group_brand":      {"en": "Brand",             "de": "Brand",                  "ru": "Brand"},
            "transform":        {"en": "Transform",         "de": "Druckeffekt",            "ru": "Эффект нажатия"},
            "hover":            {"en": "Hover effect",      "de": "Hover-Effekt",           "ru": "Реакция на курсор"},
            "oid-working":      {"en": "Working state ID",  "de": "In Arbeit Zustand ID",   "ru": "'В работе' ID"},
            "min":              {"en": "Min",               "de": "Min",                    "ru": "Минимум"},
            "max":              {"en": "Max",               "de": "Max",                    "ru": "Максимум"},
            "step":             {"en": "Step",              "de": "Schritt",                "ru": "Шаг"},
            "sliderColor":      {"en": "Slider color",      "de": "Schieberfarbe",          "ru": "Цвет ползунка"},
            "sliderCompleteColor": {
                "en": "Slider complete color",
                "de": "Voll Schieberfarbe",
                "ru": "Цвет ползунка (Полный)"
            },
            "sliderMarkerColor": {"en": "Slider handle color", "de": "Schiebergrifffarbe",  "ru": "Цвет ручки"},
            "content_oid":      {"en": "Content ID",        "de": "Inhalt ID",              "ru": "ID Содержания"},
            "dialog_oid":       {"en": "Dialog ID",         "de": "Dialog ID",              "ru": "ID Текста для диалога"},
            "number_oid":       {"en": "Number ID",         "de": "Nummer ID",              "ru": "ID Числа"},
            "hide_on_0":        {"en": "Hide by 0",         "de": "Verbergen bei 0",        "ru": "Скрыть при 0"},
            "dialog_fontSize":  {"en": "Dialog font size",  "de": "Dialogschriftgrösse",    "ru": "Размер шрифта"},
            "dialog_padding":   {"en": "Dialog padding",    "de": "Dialog padding",         "ru": "Отступ"},
            "dialog_textAlign": {"en": "Dialog text align", "de": "Dialogtextausrichtung",  "ru": "Выравнивание текста"},
            "dialog_width":     {"en": "Dialog width",      "de": "Dialogbreite",           "ru": "Ширина"},
            "dialog_height":    {"en": "Dialog height",     "de": "Dialoghöhe",             "ru": "Высота"},
            "dialog_title":     {"en": "Title",             "de": "Titel",                  "ru": "Надпись"},
            "dialog_flat":      {"en": "Flat Design",       "de": "Flaches Design",         "ru": "Плоский дизайн"},
            "dialog_shadow":    {"en": "Shadow",            "de": "Fensterschatten",        "ru": "Показать тень"},
            "dialog_draggable": {"en": "Draggable",         "de": "Konnte verschoben werden", "ru": "Можно двигать"},
            "dialog_modal":     {"en": "Modal",             "de": "Modaldialog",            "ru": "Модальное окно"},
            "dialog_icon_src":  {"en": "Icon URL",          "de": "Ikone URL",              "ru": "URL иконки"},
            "dialog_icon_class": {"en": "Icon class",       "de": "Ikoneklasse",            "ru": "Класс иконки"},
            "Select ID":        {"en": "Select ID",         "de": "Select ID",              "ru": "Select ID"},
            "state_oid":        {"en": "State ID",          "de": "Zustand ID",             "ru": "ID Статуса"},
            "select_on_true":   {"en": "Select by true",    "de": "Selektieren bei Wahr",   "ru": "Отметить при 1"},
            "label_true":       {"en": "Label if true",     "de": "Schild bei Wahr",        "ru": "Надпись при 1"},
            "label_false":      {"en": "Label if false",    "de": "Schild bei Falsch",      "ru": "Надпись при 0"},
            "bg_class_true":    {"en": "Background by true", "de": "Hintergrund bei Wahr",  "ru": "Фон при 1"},
            "bg_class_false":   {"en": "Background by false", "de": "Hintergrund bei Falsch", "ru": "Фон при 0"},
            "icon_true_src":    {"en": "Icon URL by true",  "de": "Ikone URL bei Wahr",     "ru": "URL иконки при 1"},
            "icon_false_src":   {"en": "Icon URL by false", "de": "Ikone URL bei Falsch",   "ru": "URL иконки при 0"},
            "icon_true_src_tooltip": {
                "en": "To center the image select 'icon-custom' class",
                "de": "Um das Bild zu zentrieren, muss 'icon-custom' Klasse gewählt werden",
                "ru": "Для помещения картинки в центре выберите 'icon-custom' класс"
            },
            "icon_false_src_tooltip": {
                "en": "To center the image select 'icon-custom' class",
                "de": "Um das Bild zu zentrieren, muss 'icon-custom' Klasse gewählt werden",
                "ru": "Для помещения картинки в центре выберите 'icon-custom' класс"
            },
            "icon_class_true": {
                "en": "Icon class by true",
                "de": "Ikonenklasse URL bei Wahr",
                "ru": "Класс иконки при 1"
            },
            "icon_class_false": {
                "en": "Icon class by false",
                "de": "Ikonenklasse URL bei Falsch",
                "ru": "Класс иконки при 0"
            },
            "badge_bg_class_true": {
                "en": "Badge background by true",
                "de": "Abzeichen- Hintergrund bei Wahr",
                "ru": "Фон бирки при 1"
            },
            "badge_bg_class_false": {
                "en": "Badge background by false",
                "de": "Abzeichen- Hintergrund bei Falsch",
                "ru": "Фон бирки при 0"
            },
            "brand_bg_class_true": {
                "en": "Brand background by true",
                "de": "Brand- Hintergrund bei Wahr",
                "ru": "Фон полоски при 1"
            },
            "brand_bg_class_false": {
                "en": "Brand background by false",
                "de": "Brand- Hintergrund bei Falsch",
                "ru": "Фон полоски при 0"
            },
            "icon_true":        {"en": "Icon by true",      "de": "Ikone bei Wahr",         "ru": "Иконка при 1"},
            "icon_false":       {"en": "Icon by false",     "de": "Ikone bei Falsch",       "ru": "Иконка при 0"},
            "icon_badge_true":  {"en": "Badge icon by true", "de": "Abzeichenikone bei Wahr", "ru": "Иконка бирки при 1"},
            "icon_badge_false": {
                "en": "Badge icon by false",
                "de": "Abzeichenikone bei Falsch",
                "ru": "Иконка бирки при 0"
            },
            "value":            {"en": "Value",             "de": "Wert",                   "ru": "Значение"},
            "select_on_value":  {"en": "Select on value",   "de": "Selektieren by Wert",    "ru": "Отметить при значении"},
            "group_slider":     {"en": "Slider",            "de": "Schieber",               "ru": "Ползунок"},
            "content_prepend":  {"en": "Сontent prepend",   "de": "Inhaltprefix",           "ru": "Префикс содержания"},
            "content_append":   {"en": "Сontent append",    "de": "Inhaltsuffix",           "ru": "Суффику содержания"},
            "label_id":         {"en": "Label ObjectID",    "de": "Beschriftung ObjectID",  "ru": "ObjectID надписи"},
            "hum_oid":          {"en": "Humidity ID",       "de": "Luftfeutigkeit ID",      "ru": "ID влажности"},
            "label_humidity":   {"en": "Label for humidity", "de": "Beschriftung Luftfeutigkeit", "ru": "Подпись влажности"},
            "lowbat_oid":       {"en": "Low battery ID",    "de": "Low battery ID",         "ru": "ID низкого заряда батареи"},
            "controlmode_oid":  {"en": "Control mode ID",   "de": "Kontrollmodus ID",       "ru": "ID Режима управления"},
            "windowopen_oid":   {"en": "Window open ID",    "de": "Fenstersensor ID",       "ru": "Сенсор окна ID"}
        });
    }

    $.extend(true, systemDictionary, {
        "Set temperature":      {"en": "Set temperature",   "de": "Soll-Temperatur",    "ru": "Выставленная темп."},
        "Actual temp.":         {"en": "Actual temp.",      "de": "Ist-Temperatur",     "ru": "Актуальная темп."},
        "Valve position":       {"en": "Valve position",    "de": "Ventilstellung",     "ru": "Позиция вентиля"},
        "Humidity":             {"en": "Humidity",          "de": "Luftfeuchtigkeit",   "ru": "Влажность"},
        "Target":               {"en": "Target",            "de": "Soll",               "ru": "Должно"},
        "Actual":               {"en": "Now",               "de": "Ist",                "ru": "Сейчас"},
        "group_service":        {"en": "Service",           "de": "Service",            "ru": "Сервис"},
        "icon_lowbat":          {"en": "Icon low battery",  "de": "Icon Batterie leer", "ru": "Иконка низкого заряда батареи"},
        "icon_control_mode_0":  {"en": "Icon auto mode",    "de": "Icon Auto Modus",    "ru": "Иконка для авто-режима"},
        "icon_control_mode_1":  {"en": "Icon manual mode",  "de": "Icon man. Modus",    "ru": "Иконка для ручного режима"},
        "icon_control_mode_2":  {"en": "Icon party mode",   "de": "Icon Party Modus",   "ru": "Иконка для режима вечеринки"},
        "icon_control_mode_3":  {"en": "Icon boost mode",   "de": "Icon Boost Modus",   "ru": "Иконка для режима наддува"},
        "icon_windowopen":      {"en": "Icon window open",  "de": "Icon Fenster offen", "ru": "Иконка открытого окна"}
    });

    vis.navChangeCallbacks.push(function (view) {
        $('.vis-metro-nav').each(function () {
            var $this = $(this);
            if ($this.attr('data-metro-nav') === view) {
                if ($this.attr('data-metro-nav-select') === 'true') {
                    $this.addClass("selected");
                }
                $this.addClass($this.attr('data-metro-class-active'));
                if ($this.attr('data-metro-class-active') !== $this.attr('data-metro-class')) {
                    $this.removeClass($this.attr('data-metro-class'));
                }
            } else {
                $this.addClass($this.attr('data-metro-class'));
                if ($this.attr('data-metro-class-active') !== $this.attr('data-metro-class')) {
                    $this.removeClass($this.attr('data-metro-class-active'));
                }
                $this.removeClass('selected');
            }
        });
    });

    vis.binds.metro = {
        version: "1.2.0",
        format: function (value, type, mustValue) {
            if (!type || type === 'bool') {

                return '_' + !(!value || value === 'false' || value === '0');

            } else if (type == 10) {

                if (!value || value === 'false' || value === '0') value = 0;
                if (value === 'true' || value === true) value = 1;
                return parseInt(value, 10);

            } else if (type === 'compare') {

                if (!value || value === 'false' || value === '0') value = 0;
                if (value === 'true' || value === true) value = 1;

                if (mustValue === 'true'  || mustValue === '1')  mustValue = 1;
                if (mustValue === 'false' || mustValue === '0') mustValue = 0;

                return '_' + (value == mustValue);
            } else if (type === '%') {
                if (value !== undefined && (typeof value === 'number' || typeof value === 'string')) value = parseFloat(value).toFixed(0) + '%';
                if (value === undefined) value = '';
                return value;
            }  else if (type === '°') {
                if (value !== undefined && (typeof value === 'number' || typeof value === 'string')) value = parseFloat(value).toFixed(1) + '°C';
                if (value === undefined) value = '';
                return value;
            }
            return value;
        },
        inputControl: function (el) {
            var $this = $(el).parent().find('input');
        },
        slider: function (el, options) {
            var $this = $(el).parent().find('.slider');
            var oid     = $this.attr('data-oid');
            var wid     = $this.attr('data-oid-working');

            if (!oid && options.hideIfNoOid) {
                $this.hide();
                return;
            }

            var min = (options.min === undefined || options.min === null || options.min === '') ? 0.00 : parseFloat(options.min);
            var max = (options.max === undefined || options.min === null || options.max === '') ? 1.00 : parseFloat(options.max);

            if (max < min) {
                var tmp = max;
                max = min;
                min = tmp;
            }
            var val = vis.states.attr(oid + '.val');
            if (val === true  || val === 'true')  val = max;
            if (val === false || val === 'false') val = min;
            val = parseFloat(val);
            if (isNaN(val)) val = min;

            if (val < min) val = min;
            if (val > max) val = max;

            options.min = min;
            options.max = max;
            options.simRange = 100;
            options.range    = options.max - options.min;
            options.factor   = options.simRange / options.range;
            val = Math.floor((val - options.min) * options.factor);

            $this.metroSlider({
                min:           0,
                max:           options.simRange,
                accuracy:      options.accuracy      || 0,
                color:         options.color         || undefined,
                completeColor: options.completeColor || undefined,
                markerColor:   options.markerColor   || undefined,
                position:      val,
                animate:       true,
                change:        function (val) {
                    val = (parseFloat(val) / options.factor) + options.min;
                    if (options.step) {
                        val = Math.round(val / options.step) * options.step;
                    }
                    if (options.digits !== undefined && options.digits !== null && options.digits !== '') {
                        vis.setValue(oid, val.toFixed(options.digits));
                        //vis.setValue(oid, parseFloat(val).toFixed(options.digits));
                    } else {
                        vis.setValue(oid, val);
                        //vis.setValue(oid, parseFloat(val));
                    }
                },
                changed:       function (val) {

                }
            });

            vis.states.bind(oid + '.val', function (e, newVal, oldVal) {
                var val = vis.states.attr(oid + '.val');

                if (val === true  || val === 'true')  val = options.max;
                if (val === false || val === 'false') val = options.min;

                val = parseFloat(val);
                if (isNaN(val)) val = options.min;
                if (val < options.min) val = options.min;
                if (val > options.max) val = options.max;
                val = Math.floor((val - options.min) * options.factor);

                try {
                    $this.metroSlider('value', val);
                } catch (e) {
                    console.error(e);
                }
            });
        },
        tile: function (el, transform) {
            var $this = $(el).parent().find('.tile');
            if (transform) $this.tileTransform();

            setTimeout(function () {
                $('.vis-metro-nav').each(function () {
                    var $this = $(this);
                    if ($this.attr('data-metro-nav') === vis.activeView) {
                        if ($this.attr('data-metro-nav-select') === 'true') {
                            $this.addClass('selected');
                        }
                        $this.addClass($this.attr('data-metro-class-active'));
                        if ($this.attr('data-metro-class-active') !== $this.attr('data-metro-class')) {
                            $this.removeClass($this.attr('data-metro-class'));
                        }
                    } else {
                        $this.addClass($this.attr('data-metro-class'));
                        if ($this.attr('data-metro-class-active') !== $this.attr('data-metro-class')) {
                            $this.removeClass($this.attr('data-metro-class-active'));
                        }
                        $this.removeClass('selected');
                    }
                });
            }, 100);
        },
        tileDialog: function (el, wid, view, options, html, isIframe) {
            var $this = $(el).parent().find('.tile');

            var width  = parseInt(options.width, 10);
            var height = parseInt(options.height, 10);

            if (isNaN(width))  width = undefined;
            if (isNaN(height)) height = undefined;

            if (view || html || vis.editMode) {
                $(el).parent().on('click touchstart', function () {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    $.metroDialog({
                        width:     width,
                        height:    height,
                        overlay:   options.overlay   || false,
                        shadow:    options.shadow    || false,
                        flat:      options.flat      || false,
                        draggable: options.draggable || false,
                        title:     options.title     || '',
                        icon:      options.icon  ? '<img src="' + options.icon + '">' : (options.icon_class ? '<span class="' + options.icon_class + '"></span>' : false),
                        content:   '',
                        onShow:    function(_dialog){
                            var content = _dialog.children('.content');
                            if (html) {
                                if (isIframe) {
                                    content.css('overflow', 'hidden');
                                    content.html('<iframe src="' + html + '" style="width: 100%; height: 100%" scrolling="' + (options.scroll ? 'yes' : 'no') + '"></iframe>');
                                } else {
                                    content.html(html);
                                }
                            } else {
                                content.html('<div class="vis-view-container" data-vis-contains="' + view + '"></div>');
                                if (vis.views[view]) {
                                    vis.renderView(view, view, false, function (_view) {
                                        $('#visview_' + _view).appendTo(content).show();
                                    });
                                }
                                $('#visview_' + view).appendTo(content);
                                $('#visview_' + view).show();
                            }
                        }
                    });
                });
            }
        },
        tileDialogString: function (el, wid, content_oid, options, fontSize, padding, textAlign) {
            content_oid = content_oid || '';
            var $this = $(el).parent().find('.tile');

            var width = parseInt(options.width, 10);
            var height = parseInt(options.height, 10);

            if (isNaN(width))  width = undefined;
            if (isNaN(height)) height = undefined;

            $(el).parent().on('click touchstart', function () {
                // Protect against two events
                if (vis.detectBounce(this)) return;

                $.metroDialog({
                    width:     width,
                    height:    height,
                    overlay:   options.overlay || false,
                    shadow:    options.shadow || false,
                    flat:      options.flat || false,
                    draggable: options.draggable || false,
                    icon:      options.icon  ? '<img src="' + options.icon + '">' : (options.icon_class ? '<span class="' + options.icon_class + '"></span>' : false),
                    title:     options.title || '',
                    content:   '',
                    onShow:    function(_dialog){
                        var content = _dialog.children('.content');
                        var style = '';
                        if (fontSize)  style += 'font-size:'  + fontSize + ';';
                        if (padding)   style += 'padding:'    + padding + ';';
                        if (textAlign) style += 'text-align:' + textAlign + ';';

                        var value = vis.states.attr(content_oid + '.val');
                        if (value === undefined) value = '';
                        content.html('<div style="' + style + '" class="metro-dialog-string" data-oid="' + content_oid + '">' + value + '</div>');
                    }
                });
            });
            vis.states.bind(content_oid + '.val', function (e, newVal, oldVal) {
                $('div.metro-dialog-string[data-oid="' + content_oid + '"]').html(newVal);
            });
        },
        tileDialogSlider: function (el, wid, level_id, working_id, options, sliderOptions) {
            var $this = $(el).parent().find('.tile');

            var width  = parseInt(options.width, 10);
            var height = parseInt(options.height, 10);

            if (isNaN(width))  width  = undefined;
            if (isNaN(height)) height = undefined;

            level_id   = level_id   || '';
            working_id = working_id || '';

            sliderOptions.min = (sliderOptions.min === undefined || sliderOptions.min === null || sliderOptions.min === '') ? 0.00 : parseFloat(sliderOptions.min);
            sliderOptions.max = (sliderOptions.max === undefined || sliderOptions.min === null || sliderOptions.max === '') ? 1.00 : parseFloat(sliderOptions.max);

            var range =  sliderOptions.max - sliderOptions.min;
            var factor = 100 / range;

            $(el).parent().on('click touchstart', function () {
                // Protect against two events
                if (vis.detectBounce(this)) return;

                $.metroDialog({
                    width:     width,
                    height:    height,
                    overlay:   options.overlay   || false,
                    shadow:    options.shadow    || false,
                    flat:      options.flat      || false,
                    draggable: options.draggable || false,
                    icon:      options.icon  ? '<img src="' + options.icon + '">' : (options.icon_class ? '<span class="' + options.icon_class + '"></span>' : false),
                    title:     options.title     || '',
                    content:   '',
                    onShow:    function(_dialog){
                        var content = _dialog.children('.content');
                        var html = '<div style="margin: 24px 0 0 24px;">';
                        html += '<div class="input-control switch"><label>';
                        html += '<input type="checkbox" name="' + wid + '_checkbox" id="' + wid + '_checkbox" data-oid="' + level_id + '" data-oid-working="' + working_id + '"/>';
                        html += '<span class="check"></span>';
                        html += '</label></div>';
                        html += '</div><div style="margin: 24px 12px 0 12px;">';
                        html += '<div data-oid="' + level_id + '" data-oid-working="' + working_id + '" id="metroSlider_' + wid + '" class="slider" data-role="slider"></div>';
                        html += '</div>';
                        content.html(html);

                        var val = vis.states.attr(level_id + '.val');
                        if (val === true || val === 'true') val = sliderOptions.max;
                        val = parseFloat(val);
                        if (isNaN(val)) val = sliderOptions.min;

                        val = Math.floor((val - sliderOptions.min) * factor);
                        sliderOptions.position = val;

                        vis.binds.metro.slider(document.getElementById('metroSlider_' + wid), sliderOptions);
                        vis.binds.basic.checkbox(document.getElementById(wid + '_checkbox'), true, sliderOptions.min, sliderOptions.max);
                    }
                });
            });
        },
        tileDialogHeating: function (el, wid, set_oid, temp_oid, drive_oid, options, sliderOptions) {
            var $this = $(el).parent().find('.tile');

            var width =  parseInt(options.width, 10);
            var height = parseInt(options.height, 10);

            if (isNaN(width))  width = undefined;
            if (isNaN(height)) height = undefined;

            set_oid   = set_oid   || '';
            temp_oid  = temp_oid  || '';
            drive_oid = drive_oid || '';

            $(el).parent().on('click touchstart', function () {
                // Protect against two events
                if (vis.detectBounce(this)) return;

                $.metroDialog({
                    width:     width,
                    height:    height,
                    overlay:   options.overlay || false,
                    shadow:    options.shadow || false,
                    flat:      options.flat || false,
                    draggable: options.draggable || false,
                    icon:      options.icon  ? '<img src="' + options.icon + '">' : (options.icon_class ? '<span class="' + options.icon_class + '"></span>' : false),
                    title:     options.title || '',
                    content:   '',
                    onShow:    function(_dialog){
                        var val_set_id = vis.states.attr(set_oid + '.val');
                        if (val_set_id === undefined || val_set_id === null || val_set_id === '') {
                            val_set_id = '';
                        } else {
                            val_set_id = val_set_id.toFixed(1);
                        }

                        var val_temp_id = vis.states.attr(temp_oid + '.val');
                        if (val_temp_id === undefined || val_temp_id === null || val_temp_id === '') {
                            val_temp_id = '';
                        } else {
                            val_temp_id = val_temp_id.toFixed(1);
                        }

                        var val_drive_id = vis.states.attr(drive_oid + '.val');
                        if (val_drive_id === undefined || val_drive_id === null || val_drive_id === '') {
                            val_drive_id = '';
                        } else {
                            val_drive_id = val_drive_id.toFixed(0);
                        }

                        var content = _dialog.children('.content');
                        var html = '<div style="margin: 24px 12px 0 12px;">';
                        if (set_oid) {
                            html += '<div data-oid="' + set_oid + '" id="metroSlider_' + wid + '" class="slider" data-role="slider"></div>';
                        }
                        html += '</div>';
                        html += '<table style="margin-top: 12px; margin-left: 12px; font-size:14px;display:inline-block;">' +
                                (set_oid   ? ('<tr><td>' + (options.label_set   || ('Set temperature')) + ':</td><td><span class="metro-dialog-string" data-oid="' + set_oid   + '">' + val_set_id   + '</span>°C</td></tr>') : '') +
                                (temp_oid  ? ('<tr><td>' + (options.label_temp  || _('Actual temp.'))   + ':</td><td><span class="metro-dialog-string" data-oid="' + temp_oid  + '">' + val_temp_id  + '</span>°C</td></tr>') : '') +
                                (drive_oid ? ('<tr><td>' + (options.label_drive || _('Valve position')) + ':</td><td><span class="metro-dialog-string" data-oid="' + drive_oid + '">' + val_drive_id + '</span>%</td></tr>')  : '') +
                                '</table>';

                        content.html(html);
                        sliderOptions.min = sliderOptions.min === undefined ? 6  : parseFloat(sliderOptions.min);
                        sliderOptions.max = sliderOptions.max === undefined ? 30 : parseFloat(sliderOptions.max);
                        if (set_oid) {
                            vis.binds.metro.slider(document.getElementById('metroSlider_' + wid), sliderOptions);
                            vis.states.bind(set_oid   + '.val', function (e, newVal, oldVal) {
                                $('span.metro-dialog-string[data-oid="' + set_oid + '"]').html(parseFloat(newVal).toFixed(1));
                            });
                        }
                        if (temp_oid) {
                            vis.states.bind(temp_oid  + '.val', function (e, newVal, oldVal) {
                                $('span.metro-dialog-string[data-oid="' + temp_oid + '"]').html(parseFloat(newVal).toFixed(1));
                            });
                        }
                        if (drive_oid) {
                            vis.states.bind(drive_oid + '.val', function (e, newVal, oldVal) {
                                $('span.metro-dialog-string[data-oid="' + drive_oid + '"]').html(parseFloat(newVal).toFixed(0));
                            });
                        }
                    }
                });
            });
        },
        onHeatingOid: function (widgetID, view, value, attr, isCss) {
            var obj = vis.objects[value];
            var changed = [];
            // If it is real object and SETPOINT
            if (obj && obj.common && obj.common.role === 'level.temperature') {
                var roles = [];
                // If some attributes are not set
                if (!vis.views[view].widgets[widgetID].data.temp_oid) {
                    roles.push('value.temperature');
                }
                if (!vis.views[view].widgets[widgetID].data.drive_oid) {
                    roles.push('value.valve');
                }
                if (!vis.views[view].widgets[widgetID].data.hum_oid) {
                    roles.push('value.humidity');
                }
                if (!vis.views[view].widgets[widgetID].data.lowbat_oid) {
                    roles.push('indicator.battery');
                }
                if (roles.length) {
                    var result = vis.findByRoles(value, roles);
                    if (result) {
                        for (var r in result) {
                            switch (r) {
                                case 'value.temperature':
                                    changed.push('temp_oid'); // remember attr to update it
                                    vis.views[view].widgets[widgetID].data.temp_oid = result[r];
                                    vis.widgets[widgetID].data.temp_oid = result[r];
                                    break;

                                case 'value.valve':
                                    changed.push('drive_oid'); // remember attr to update it
                                    vis.views[view].widgets[widgetID].data.drive_oid = result[r];
                                    vis.widgets[widgetID].data.drive_oid = result[r];
                                    break;

                                case  'value.humidity':
                                    changed.push('hum_oid');
                                    vis.views[view].widgets[widgetID].data.hum_oid = result[r];
                                    vis.widgets[widgetID].data.hum_oid = result[r];
                                    break;

                                case  'indicator.battery':
                                    changed.push('lowbat_oid');
                                    vis.views[view].widgets[widgetID].data.lowbat_oid = result[r];
                                    vis.widgets[widgetID].data.lowbat_oid = result[r];
                                    break
                            }
                        }
                    }
                }

                if (!vis.views[view].widgets[widgetID].data.controlmode_oid) {
                    var result = vis.findByName(value, 'CONTROL_MODE');
                    if (result) {
                        changed.push('controlmode_oid');
                        vis.views[view].widgets[widgetID].data.controlmode_oid = result;
                        vis.widgets[widgetID].data.controlmode_oid = result;
                    }
                }
                if (!vis.views[view].widgets[widgetID].data.windowopen_oid) {
                    var result = vis.findByName(value, 'WINDOW_STATE');
                    if (result) {
                       changed.push('windowopen_oid');
                        vis.views[view].widgets[widgetID].data.windowopen_oid = result;
                        vis.widgets[widgetID].data.windowopen_oid = result;
                    }
                }
                if (!vis.views[view].widgets[widgetID].data.windowopen_oid) {
                    var result = vis.findByName(value, 'WINDOW_OPEN_REPORTING');
                    if (result) {
                        changed.push('windowopen_oid');
                        vis.views[view].widgets[widgetID].data.windowopen_oid = result;
                        vis.widgets[widgetID].data.windowopen_oid = result;
                    }
                }
            }

            return changed.length ? changed : null;
        }
    };

	console.log('Metro version: "' + vis.binds.metro.version + '"');
</script>

<script id="tplMetroSlider"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroSlider" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee" style="top: 21px; left: 41px; width: 78px; height: 17px;"> <div class="metro vis-widget-prev-body " style="padding:2px"> <div data-o data-oid-working="" class="slider" data-role="slider"><div class="complete" style="background-color: rgb(32, 32, 255); width: 0;"></div><a class="marker" style="background-color: rgb(32, 32, 255); left: 0;"></a></div> <div></div> </div> </div>'
        data-vis-attrs="oid;oid-working;min;max;step;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color"
        data-vis-set="metro"
        data-vis-type="ctrl,slider,dimmer"
        data-vis-name="Slider horizontal">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width:360px; height: 16px;">
        <div class="metro vis-widget-body <%== this.data.attr('class') %>" style="padding:2px" >
            <% if (vis.editMode) { %>
                <div class="editmode-helper" />
            <% } %>
            <div data-oid="<%= this.data.attr('oid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" id="metroSlider_<%= this.data.attr('wid') %>" class="slider" data-role="slider"></div>
            <div <%= (el) -> vis.binds.metro.slider(el, {min: data.min, max: data.max, step: data.step, color: data.sliderBgColor, completeColor:data.sliderCompleteColor, markerColor: data.sliderMarkerColor}) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroSliderVertical"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroSliderVertical" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock ui-selectee" style="top: 215px; left: 460px; width: 12px; height: 73px;"> <div class="metro vis-widget-prev-body " style="padding:2px"> <div data-o data-oid-working="" style="height: 100%;" class="slider vertical" data-role="slider"><div class="complete" style="height: 12px;"></div><a class="marker" style="background-color: rgb(75, 0, 130); top: 344px;"></a></div> <div></div> </div> </div>'
        data-vis-attrs="oid;oid-working;min;max;step;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color"
        data-vis-set="metro"
        data-vis-type="ctrl,slider,dimmer"
        data-vis-name="Slider vertical">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 16px; height:360px;">
        <div class="metro vis-widget-body <%== this.data.attr('class') %>" style="padding:2px" >
            <% if (vis.editMode) { %>
                <div class="editmode-helper" />
            <% } %>
            <div data-oid="<%= this.data.attr('oid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" style="height: 100%;" id="metroSlider_<%= this.data.attr('wid') %>" class="slider vertical" class="slider" data-role="slider"></div>
            <div <%= (el) -> vis.binds.metro.slider(el, {min: data.min, max: data.max, step: data.step, color: data.sliderBgColor, completeColor: data.sliderCompleteColor, markerColor: data.sliderMarkerColor}) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroValueBoolCheckbox"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroValueBoolCheckbox" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock ui-selectee" style="left: 110px; top: 81px; height: 44px; width: 21px;" > <div class="metro vis-widget-prev-body"> <div class="input-control checkbox"> <label> <input type="checkbox" name="w00003_checkbox" data-o> <span class="check"></span> </label> </div> <div></div> </div> </div>'
        data-vis-attrs="html_prepend;html_append;oid"
        data-vis-set="metro"
        data-vis-type="ctrl,bool"
        data-vis-name="Bool Checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="" id="<%= this.data.attr('wid') %>" >
        <div class="metro vis-widget-body">
            <div class="input-control checkbox">
                <label>
                    <%== this.data.attr("html_prepend") %>
                    <input type="checkbox" name="<%= this.data.attr('wid') %>_checkbox" id="<%= this.data.attr('wid') %>_checkbox" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.checkbox(el) %>/>
                    <span class="check"></span>
                    <%== this.data.attr("html_append") %>
                </label>
            </div>
            <div <%= (el) -> vis.binds.metro.inputControl(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroValueBoolSwitch"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroValueBoolSwitch" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock ui-selectee" style="left: 110px; top: 432px;" > <div class="metro vis-widget-prev-body"> <div class="input-control switch"> <label> <input type="checkbox" name="w00002_checkbox" data-o> <span class="check"></span> </label> </div> <div></div> </div> </div>'
        data-vis-set="metro"
        data-vis-type="ctrl,bool"
        data-vis-name="Switch"
        data-vis-attrs="html_prepend;html_append;oid">
    <div class="vis-widget <%== this.data.attr('class') %>" style="" id="<%= this.data.attr('wid') %>" >
        <div class="metro vis-widget-body">
            <div class="input-control switch">
                <label>
                    <%== this.data.attr("html_prepend") %>
                    <input type="checkbox" name="<%= this.data.attr('wid') %>_checkbox" id="<%= this.data.attr('wid') %>_checkbox" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.checkbox(el) %>/>
                    <span class="check"></span>
                    <%== this.data.attr("html_append") %>
                </label>
            </div>
            <div <%= (el) -> vis.binds.metro.inputControl(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileNav"
        type="text/ejs"
        data-vis-prev='<div id="prev_tplMetroTileNav" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev  " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div data-metro-nav-select="false" data-metro-class-active="bg-magenta" data-metro-class="bg-indigo" style="width: 100%; height: 100%;" class="vis-metro-nav tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-new"></i> </div> <div class="vis-metro-nav brand ribbed-steel" data-metro-nav="" data-metro-class-active="ribbed-indigo" data-metro-class="ribbed-steel"> <span class="label fg-white">Navigation</span> <div class="vis-metro-nav badge bg-cyan" data-metro-nav="" data-metro-class-active="bg-teal" data-metro-class="bg-cyan"><i class="icon-file"></i></div> </div> </div>  </div> </div></div>'
        data-vis-attrs="nav_view;hover[true]/checkbox;transform[true]/checkbox;select_current/checkbox;label[Navigation];"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_active[bg-magenta]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.badge;badge_bg_class[bg-cyan]/style,metro-,bg-;badge_bg_class_active[bg-teal]/style,metro-,bg-;"
        data-vis-attrs3="badge_src/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-attrs4="icon_badge[icon-file]/style,iconFont,icon-,,Icon ;brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs5="brand_bg_class_active[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs6="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[icon-new]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs7="group.effects;sync/checkbox;hide_effect/effect;hide_duration/slider,0,10000,100;hide_options/effect-options;show_effect/effect;show_duration/slider,0,10000,100;show_options/effect-options;body-background/color"
        class="vis-tpl"
        data-vis-type="static,navigation"
        data-vis-set="metro"
        data-vis-name="Tile Navigation">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;"  <%= (el) -> vis.binds.basic.navigation(el, {nav_view:data.attr('nav_view'),hideOptions:{effect:data.attr('hide_effect'),options:(data.attr('hide_options')?data.attr('hide_options'):{}),duration:data.attr('hide_duration')},showOptions:{effect:data.attr('show_effect'),options:(data.attr('show_options')?data.attr('show_options'):{}),duration:data.attr('show_duration')},sync:data.attr('sync'),background:data.attr('body-background')}); %> >
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>">
            <div data-metro-nav="<%= this.data.attr('nav_view') %>" data-metro-nav-select="<%= this.data.attr('select_current') %>" data-metro-class-active="<%= this.data.attr('bg_class_active') %>" data-metro-class="<%= this.data.attr('bg_class') %>" style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="vis-metro-nav tile <%= this.data.attr('hover') ? 'hover' : '' %>" >
                <div class="tile-content icon <%= this.data.attr('icon_class') ? '' : 'icon-custom' %>">
                    <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                    <i class="<%= this.data.attr("icon_class") %>"></i>
                </div>
                <div class="vis-metro-nav brand" data-metro-nav="<%= this.data.attr('nav_view') %>" data-metro-class-active="<%= this.data.attr('brand_bg_class_active') %>" data-metro-class="<%= this.data.attr('brand_bg_class') %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                    <div class="vis-metro-nav badge" data-metro-nav="<%= this.data.attr('nav_view') %>" data-metro-class-active="<%= this.data.attr('badge_bg_class_active') %>" data-metro-class="<%= this.data.attr('badge_bg_class') %>">
                        <%== this.data.attr('badge_src') ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr("badge_src") + '"/>' : '' %>
                        <i class="<%= this.data.attr("icon_badge") %>"></i>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileString"
        type="text/ejs"
        data-vis-prev='<div id="prev_tplMetroTileString" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content fg-white icon"> <i class="icon-sun-3"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white"> String </span> <div class="badge bg-cyan"><i class="icon-sunrise"></i></div> </div> </div>  </div> </div></div>'
        data-vis-attrs="content_prepend;content_append;content_oid/id;"
        data-vis-attrs0="state_oid/id;hover/checkbox;transform/checkbox;select_on_true/checkbox;bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="group.icon;icon_false/image;icon_true/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class_false[icon-sun-3]/style,iconFont,icon-,,Icon ;icon_class_true[icon-weather-4]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs2="group.badge;label_prepend;label_append;label_id/id;badge_bg_class_false[bg-cyan]/style,metro-,bg-;badge_bg_class_true[bg-teal]/style,metro-,bg-;icon_badge_false[icon-sunrise]/style,iconFont,icon-,,Icon ;icon_badge_true[icon-sunrise]/style,iconFont,icon-,,Icon ;brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs3="badge_src_false/image;badge_src_true/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        class="vis-tpl"
        data-vis-set="metro"
        data-vis-type="val"
        data-vis-name="Tile String">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-oid="<%= this.data.attr('state_oid') %>">
            <div style="width: 100%; height: 100%;"  id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val')) === '_true') && this.data.attr('select_on_true') ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>" >
                <div class="tile-content fg-white icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('content_prepend') %><%== vis.states.attr(this.data.attr('content_oid') + '.val') %><%== this.data.attr('content_append') %>
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>">
                    <span class="label fg-white">
                        <%== this.data.attr('label_prepend') %><%== vis.states.attr(this.data.attr('label_id') + '.val') %><%== this.data.attr('label_append') %>
                    </span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileBool" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev  " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"><div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-newspaper"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Boolean</span> <div class="badge bg-cyan"><i class="icon-folder"></i></div> </div> </div>  </div> </div></div>'
        data-vis-attrs="oid;hover[true]/checkbox;transform/checkbox;select_on_true/checkbox;label_false[false];label_true[true];"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false/image;icon_true/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[icon-cancel-2]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="icon_class_true[icon-checkmark]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs5="group.badge;icon_badge_false[icon-folder-2]/style,iconFont,icon-,,Icon ;icon_badge_true[icon-folder]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs6="badge_bg_class_false[bg-cyan]/style,metro-,bg-;badge_bg_class_true[bg-teal]/style,metro-,bg-;"
        data-vis-attrs7="badge_src_false/image;badge_src_true/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-attrs8="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-set="metro"
        data-vis-type="val,bool"
        data-vis-name="Tile Bool">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-oid="<%= this.data.attr('oid') %>">
            <div style="width: 100%; height: 100%;"  id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val')) === '_true') && this.data.attr('select_on_true') ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>" >
                <div class="tile-content icon <%= this.data.attr("icon_class" + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) + '"/>' : '' %>
                    <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                    <span class="label fg-white"><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %></span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileBoolDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileBoolDialog" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"><div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-newspaper"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Boolean</span> <div class="badge bg-cyan"><i class="icon-folder"></i></div> </div> </div> </div> </div></div>'
        data-vis-attrs="oid;hover[true]/checkbox;transform/checkbox;select_on_true/checkbox;label_false[false];label_true[true];"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false/image;icon_true/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[icon-cancel-2]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="icon_class_true[icon-checkmark]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs5="group.badge;icon_badge_false[icon-folder-2]/style,iconFont,icon-,,Icon ;icon_badge_true[icon-folder]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs6="badge_bg_class_false[bg-cyan]/style,metro-,bg-;badge_bg_class_true[bg-teal]/style,metro-,bg-;"
        data-vis-attrs7="badge_src_false/image;badge_src_true/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-attrs8="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs9="group.dialog;contains_view/views;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="bool,dialog"
        data-vis-name="Tile Bool Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-oid="<%= this.data.attr('oid') %>">
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val')) === '_true') && this.data.attr('select_on_true') ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>" >
                <div class="tile-content icon <%= this.data.attr("icon_class" + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) + '"/>' : '' %>
                    <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                    <span class="label fg-white"><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %></span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tileDialog(el, data.wid, data.contains_view, {title:data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:data.dialog_width,height:data.dialog_height}) %> style="padding: 42px 10px 10px;">
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileList8"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileList8" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev  vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"><div style="width: 100%; height: 100%;" class="tile bg-indigo"> <div class="tile-content icon"><i class="icon-pencil"></i> </div> <div class="brand ribbed-steel"><span class="label fg-white">Value list</span><div class="badge bg-cyan"></div></div></div></div></div></div>'
        data-vis-attrs="oid;hover/checkbox;transform/checkbox;label_prepend;label_append;group.bg-and-text;label(0-7)[Value list];"
        data-vis-attrs0="bg_class(0-7)[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="group.icon;icon(0-7)/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs2="icon_class(0-7)[icon-pencil]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs3="group.badge;icon_badge(0-7)[icon-pencil]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="badge_bg_class(0-7)[bg-cyan]/style,metro-,bg-;"
        data-vis-attrs5="brand_bg_class(0-7)[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs6="badge_src/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-set="metro"
        data-vis-type="val,list"
        data-vis-name="Tile ValueList 8">
        <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
            <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-oid="<%= this.data.attr('oid') %>">
                <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) %>" >
                    <div class="tile-content icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) ? '' : 'icon-custom' %>">
                        <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) + '"/>' : '' %>
                        <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) %>"></i>
                    </div>
                    <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) %>">
                        <span class="label fg-white"><%== this.data.attr('label_prepend') %><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) %><%== this.data.attr('label_append') %></span>
                        <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) %>">
                            <i class="<%= this.data.attr('icon_badge' + vis.states.attr(this.data.attr('oid') + '.val')) %>"></i>
                            <%== this.data.attr('badge_src') ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr("badge_src") + '"/>' : '' %>
                        </div>
                    </div>
                </div>
                <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
            </div>
        </div>
    </div>
</script>

<script id="tplMetroTileBoolNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileBoolNumber" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev  vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"><div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"><div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-cancel-2"></i></div><div class="brand ribbed-steel"><span class="label fg-white">Bool/Num</span><div class="badge bg-cyan"><i class=""></i></div></div></div></div> </div></div>'
        data-vis-attrs="state_oid/id;select_on_true/checkbox;number_oid/id;hover[true]/checkbox;transform/checkbox;label_false;label_true;label_append;"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false_src/image;icon_true_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[icon-cancel-2]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="icon_class_true[icon-checkmark]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs5="group.badge;icon_badge_false[]/style,iconFont,icon-,,Icon ;icon_badge_true[]/style,iconFont,icon-,,Icon ;badge_bg_class_false[bg-cyan]/style,metro-,bg-;badge_bg_class_true[bg-teal]/style,metro-,bg-;"
        data-vis-attrs6="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs7="badge_src_false/image;badge_src_true/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-set="metro"
        data-vis-type="val,bool"
        data-vis-name="Tile Bool / Number">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-oid="<%= this.data.attr('state_oid') %>">
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val')) === '_true') && this.data.select_on_true ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>" >
                <div class="tile-content icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val')) + '_src') ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))  + '_src')+ '"/>' : '' %>
                    <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>">
                    <span class="label fg-white"><%== (this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) || '') + ((vis.states.attr(this.data.attr('number_oid') + '.val') !== undefined) ? vis.states.attr(this.data.attr('number_oid') + '.val') : '') %><%== this.data.attr('label_append') || '' %></span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileState"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileState" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev  vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%" class="tile hover bg-indigo"><div class="tile-content icon"><i class="icon-unlocked"></i> </div> <div class="brand ribbed-steel"><span class="label fg-white">State</span><div class="badge bg-cyan"><i class=""></i></div></div></div></div></div></div>'
        data-vis-attrs="state_oid/id;value;select_on_value/checkbox;hover[true]/checkbox;transform[true]/checkbox;label_false;label_true;"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false/image;icon_true/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[]/style,iconFont,icon-,,Icon ;icon_class_true[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="group.badge;icon_badge_false[]/style,iconFont,icon-,,Icon ;icon_badge_true[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs5="badge_bg_class_false[bg-cyan]/style,metro-,bg-;"
        data-vis-attrs6="badge_bg_class_true[bg-teal]/style,metro-,bg-;"
        data-vis-attrs7="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs8="brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs9="badge_src_false/image;badge_src_true/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-set="metro"
        data-vis-type="ctrl"
        data-vis-name="Tile State">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-val="<%= this.data.attr('value') %>" data-oid="<%= this.data.attr('state_oid') %>" <%= (el) -> vis.binds.basic.state(el) %> >
            <div style="width: 100%; height: 100%;"  id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value')) === '_true') && this.data.select_on_value ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>" >
                <div class="tile-content icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) + '"/>' : '' %>
                    <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>">
                    <span class="label fg-white"><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %></span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    </div>
                </div>
            </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileToggle"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileToggle" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body " data-oid="dev1"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-minus-2"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Toggle</span> <div class="badge bg-cyan"><i class="icon-minus"></i></div> </div> </div>  </div> </div></div>'
        data-vis-attrs="oid;hover[true]/checkbox;transform[true]/checkbox;select_on_true/checkbox;label_false;label_true;"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false/image;icon_true/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[icon-minus]/style,iconFont,icon-,,Icon ;icon_class_true[icon-plus]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="group.badge;icon_badge_false[icon-minus-2]/style,iconFont,icon-,,Icon ;icon_badge_true[icon-plus-2]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs5="badge_bg_class_false[bg-cyan]/style,metro-,bg-;"
        data-vis-attrs6="badge_bg_class_true[bg-teal]/style,metro-,bg-;"
        data-vis-attrs7="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs8="brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs9="badge_src_false/image;badge_src_true/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-attrs10="group.ccontrol;urlTrue;urlFalse;oidTrue/id;oidFalse/id;oidTrueValue;oidFalseValue;"
        data-vis-set="metro"
        data-vis-type="ctrl,bool"
        data-vis-name="Tile Toggle">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%"
            class="metro vis-widget-body <%== this.data.attr('class') %>"
            data-oid="<%= this.data.attr('oid') %>"
            data-url-true="<%=  this.data.attr('urlTrue') %>"
            data-url-false="<%= this.data.attr('urlFalse') %>"
            data-oid-true="<%=  this.data.attr('oidTrue') %>"
            data-oid-false="<%= this.data.attr('oidFalse') %>"
            data-oid-true-value="<%=  this.data.attr('oidTrueValue') %>"
            data-oid-false-value="<%= this.data.attr('oidFalseValue') %>"
            <%= (el) -> vis.binds.basic.toggle(el) %>
            >
            <div style="width: 100%; height: 100%;"  id="metroTile_<%= this.data.attr('wid') %>" class="tile icon <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val')) === '_true') && this.data.attr('select_on_true') ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>" >
                <div class="tile-content icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) + '"/>' : '' %>
                    <i class="<%= vis.states.attr(this.data.attr('oid') + '.val') ? this.data.attr("icon_class_true") : this.data.attr("icon_class_false") %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                    <span class="label fg-white"><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %></span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileStateNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileStateNumber" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-meter-slow"></i></div><div class="brand ribbed-steel"><span class="label fg-white">State/Num</span><div class="badge bg-cyan"><i class=""></i></div></div></div></div></div></div>'
        data-vis-attrs="state_oid/id;value;select_on_value/checkbox;number_oid/id;hover[true]/checkbox;transform[true]/checkbox;label_false;label_true;label_append;"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false_src/image;icon_true_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[icon-meter-slow]/style,iconFont,icon-,,Icon ;icon_class_true[icon-meter-fast]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="group.badge;badge_bg_class[]/style,metro-,bg-;hide_on_0/checkbox;"
        data-vis-attrs5="group.brand;brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs6="brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-set="metro"
        data-vis-type="val"
        data-vis-name="Tile State / val Badge Number">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;" >
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-val="<%= this.data.attr('value') %>" data-oid="<%= this.data.attr('state_oid') %>" <%= (el) -> vis.binds.basic.state(el) %> >
            <div style="width: 100%; height: 100%;"  id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value')) === '_true') && this.data.select_on_value ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>" >
                <div class="tile-content icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value')) + '_src') ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value')) + '_src') + '"/>' : '' %>
                    <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>">
                    <span class="label fg-white"><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %><%== this.data.attr('label_append') %></span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %><%= (vis.states.attr(this.data.attr("number_oid") + '.val') !== undefined) ? vis.states.attr(this.data.attr("number_oid") + '.val') : '' %>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileDimmer"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileDimmer" style=" position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev" style="width: 122px; height: 77px; padding: 3px;"><div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "><div style="width: 100%; height: 100%;" class="tile bg-indigo"> <div class="tile-content" style=" zoom: 0.5;"> <div style="float:left; height: 90px;"> <img width="90px" src="widgets/metro/img/light_light_dim.png"> </div> <div style="margin: 30px 70px 0 0; float:right"> <div class="input-control switch"> <label> <input type="checkbox" name="w00004_checkbox" data-o> <span class="check"></span> </label> </div> </div> <div style="clear: both; margin: 0 12px;" class="slider" data-role="slider"><div class="complete" style="width: 0;"></div><a class="marker" style="left: 0;"></a></div> <div></div> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Dimmer</span> </div> </div> <div></div> </div> </div>'
        data-vis-attrs="oid;oid-working;min;max;step[1];hover/checkbox;transform/checkbox;label;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color"
        data-vis-set="metro"
        data-vis-type="ctrl,dimmer"
        data-vis-name="Tile Dimmer">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width:287px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >

            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content">
                <div style="float:left; height: 90px;">
                <%
                var str = vis.states.attr(this.data.oid + '.val');
                var val = parseFloat(str);
                if (str === true || str === 'true') val = 1;
                if (isNaN(val)) val = 0;

                var min = this.data.attr('min');
                if (min !== undefined && min !== null && min !== '') {
                    min = parseFloat(min);
                } else {
                    min = 0;
                }

                var max = this.data.attr('max');
                if (max !== undefined && max !== null && max !== '') {
                    max = parseFloat(max);
                } else {
                    max = 1;
                }

                val = (val - min) / (max - min);

                if (val === 1) {
                %>
                <img width="90px" src="widgets/metro/img/light_light_dim_100.png"/>
                <% } else if (val >= 0.9) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_90.png"/>
                <% } else if (val >= 0.8) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_80.png"/>
                <% } else if (val >= 0.7) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_70.png"/>
                <% } else if (val >= 0.6) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_60.png"/>
                <% } else if (val >= 0.5) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_50.png"/>
                <% } else if (val >= 0.4) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_40.png"/>
                <% } else if (val >= 0.3) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_30.png"/>
                <% } else if (val >= 0.2) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_20.png"/>
                <% } else if (val >= 0.1) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_10.png"/>
                <% } else if (val >= 0.01) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_00.png"/>
                <% } else { %>
                <img width="90px" src="widgets/metro/img/light_light_dim.png"/>
                <% } %>
                </div>
                <div style="margin: 30px 70px 0 0; float:right">
                    <div class="input-control switch">
                        <label>
                            <input type="checkbox" name="<%= this.data.attr('wid') %>_checkbox" id="<%= this.data.attr('wid') %>_checkbox" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.checkbox(el, true, data.min, data.max) %>/>
                            <span class="check"></span>
                        </label>
                    </div>
                </div>
                    <div style="clear: both; margin: 0 12px;" data-oid="<%= this.data.attr('oid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" id="metroSlider_<%= this.data.attr('wid') %>" class="slider" data-role="slider"></div>
                    <div <%= (el) -> vis.binds.metro.slider(el, {min: parseFloat(data.min), max: parseFloat(data.max), step: parseFloat(data.step), color: data.sliderColor, completeColor: data.sliderCompleteColor, markerColor: data.sliderMarkerColor}) %>></div>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %><%= (el) -> vis.binds.metro.inputControl(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileDimmerDialog"
        type="text/ejs"
        data-vis-prev='<div id="prev_tplMetroTileDimmerDialog" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"><div class="tile-content" style="text-align: center"><img width="90%" src="widgets/metro/img/light_light_dim.png"></div> <div class="brand ribbed-steel"><span class="label fg-white">Dimmer Dialog</span></div> </div><div style="padding: 42px 10px 10px;"></div></div></div></div>'
        data-vis-attrs="oid;oid-working;min;max;step[1];digits/number;hover[true]/checkbox;transform[true]/checkbox;label;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color;"
        data-vis-attrs3="group.dialog;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox"
        class="vis-tpl"
        data-vis-set="metro"
        data-vis-type="ctrl,dimmer,dialog"
        data-vis-name="Tile Dimmer Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >

            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content" style="text-align: center">
                <%
                var str = vis.states.attr(this.data.oid + '.val');
                var val = parseFloat(str);
                if (str === true || str === 'true') val = 1;
                if (isNaN(val)) val = 0;

                var min = this.data.attr('min');
                if (min !== undefined && min !== null && min !== '') {
                    min = parseFloat(min);
                } else {
                    min = 0;
                }

                var max = this.data.attr('max');
                if (max !== undefined && max !== null && max !== '') {
                    max = parseFloat(max);
                } else {
                    max = 1;
                }

                val = (val - min) / (max - min);

                if (val === 1) {
                %>
                <img width="90%" src="widgets/metro/img/light_light_dim_100.png"/>
                <% } else if (val >= 0.9) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_90.png"/>
                <% } else if (val >= 0.8) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_80.png"/>
                <% } else if (val >= 0.7) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_70.png"/>
                <% } else if (val >= 0.6) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_60.png"/>
                <% } else if (val >= 0.5) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_50.png"/>
                <% } else if (val >= 0.4) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_40.png"/>
                <% } else if (val >= 0.3) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_30.png"/>
                <% } else if (val >= 0.2) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_20.png"/>
                <% } else if (val >= 0.1) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_10.png"/>
                <% } else if (val >= 0.01) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_00.png"/>
                <% } else { %>
                <img width="90%" src="widgets/metro/img/light_light_dim.png"/>
                <% } %>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                </div>
            </div>
            <div
                <%= (el) -> vis.binds.metro.tileDialogSlider(el, data.wid, data.oid, data['oid-working'], {title: data.label, flat: data.dialog_flat, shadow: data.dialog_shadow, overlay: data.dialog_modal, icon: data.dialog_icon_src, icon_class: data.dialog_icon_class, draggable: data.dialog_draggable, width: 300, height: 180}, {min: data.min, max: data.max, step: parseFloat(data.step), color: data.sliderColor, completeColor: data.sliderCompleteColor, markerColor: data.sliderMarkerColor, digits: data.digits}) %> style="padding: 42px 10px 10px;">
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileShutter"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileShutter" style="position: relative; text-align: initial;padding: 4px "><div id="19l1ml014" class="vis-widget_prev  vis-widget-lock " style="width: 287px; height: 120px; padding: 3px; zoom: 0.5;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" id="metroTile_19l1ml014" class="tile hover bg-indigo"> <div class="tile-content"> <div style="float:left; height: 90px;"> <img width="90px" src="widgets/metro/img/fts_shutter_100.png"> </div> <div style="margin: 30px 70px 0 0; float:right"> <div class="input-control switch"> <label> <input type="checkbox" name="19l1ml014_checkbox" id="19l1ml014_checkbox" data-oid="nothing_selected" data-oid-working=""> <span class="check"></span> </label> </div> </div> <div style="clear: both; margin: 0 12px;" data-oid="nothing_selected" data-oid-working="" class="slider" data-role="slider"><div class="complete" style="width: 0;"></div><a class="marker" style="left: 0;"></a></div>  </div> <div class="brand ribbed-steel"><span class="label fg-white">Shutter</span></div></div><div></div> </div></div></div>'
        data-vis-attrs="oid;oid-working;min;max;step[1];hover/checkbox;transform/checkbox;label;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color"
        data-vis-set="metro"
        data-vis-type="ctrl,shutter"
        data-vis-name="Tile Shutter">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width:287px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >

            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content">
                    <div style="float:left; height: 90px;">
                    <%
                    var str = vis.states.attr(this.data.oid + '.val');
                    var val = parseFloat(str);
                    if (str === true || str === 'true') val = 1;
                    if (isNaN(val)) val = 0;

                    var min = this.data.attr('min');
                    if (min !== undefined && min !== null && min !== '') {
                        min = parseFloat(min);
                    } else {
                        min = 0;
                    }

                    var max = this.data.attr('max');
                    if (max !== undefined && max !== null && max !== '') {
                        max = parseFloat(max);
                    } else {
                        max = 1;
                    }

                    val = (val - min) / (max - min);
                    val = 1 - val;
                    if (val === 1) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_100.png"/>
                    <% } else if (val >= 0.9) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_90.png"/>
                    <% } else if (val >= 0.8) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_80.png"/>
                    <% } else if (val >= 0.7) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_70.png"/>
                    <% } else if (val >= 0.6) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_60.png"/>
                    <% } else if (val >= 0.5) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_50.png"/>
                    <% } else if (val >= 0.4) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_40.png"/>
                    <% } else if (val >= 0.3) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_30.png"/>
                    <% } else if (val >= 0.2) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_20.png"/>
                    <% } else if (val >= 0.1) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_10.png"/>
                    <% } else { %>
                    <img width="90px" src="widgets/metro/img/fts_window_2w.png"/>
                    <% } %>
                    </div>
                    <div style="margin: 30px 70px 0 0; float:right">
                        <div class="input-control switch">
                            <label>
                                <input type="checkbox" name="<%= this.data.attr('wid') %>_checkbox" id="<%= this.data.attr('wid') %>_checkbox" data-oid="<%= this.data.attr('oid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.basic.checkbox(el, true, data.min, data.max) %>/>
                                <span class="check"></span>
                            </label>
                        </div>
                    </div>
                    <div style="clear: both; margin: 0 12px;" data-oid="<%= this.data.attr('oid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" id="metroSlider_<%= this.data.attr('wid') %>" class="slider" data-role="slider"></div>
                    <div <%= (el) -> vis.binds.metro.slider(el, {min: data.min, max: data.max, step: parseFloat(data.step), color:data.sliderColor,completeColor:data.sliderCompleteColor,markerColor:data.sliderMarkerColor}) %>></div>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                </div>
            </div>


            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %><%= (el) -> vis.binds.metro.inputControl(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileShutterDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileShutterDialog" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content" style="text-align: center"> <img width="90px" src="widgets/metro/img/fts_shutter_100.png"> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Shutter dialog</span> </div> </div> <div style="padding: 42px 10px 10px;"> </div>  </div> </div></div>'
        data-vis-attrs="oid;oid-working;min;max;step[1];hover[true]/checkbox;transform[true]/checkbox;label;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color;"
        data-vis-attrs3="group.dialog;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox"
        data-vis-set="metro"
        data-vis-type="ctrl,shutter,dialog"
        data-vis-name="Tile Shutter Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >

            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content" style="text-align: center">
                <%
                var str = vis.states.attr(this.data.oid + '.val');
                var val = parseFloat(str);
                if (str === true || str === 'true') val = 1;
                if (isNaN(val)) val = 0;

                var min = this.data.attr('min');
                if (min !== undefined && min !== null && min !== '') {
                    min = parseFloat(min);
                } else {
                    min = 0;
                }

                var max = this.data.attr('max');
                if (max !== undefined && max !== null && max !== '') {
                    max = parseFloat(max);
                } else {
                    max = 1;
                }

                val = (val - min) / (max - min);
                val = 1 - val;

                if (val === 1) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_100.png"/>
                <% } else if (val >= 0.9) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_90.png"/>
                <% } else if (val >= 0.8) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_80.png"/>
                <% } else if (val >= 0.7) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_70.png"/>
                <% } else if (val >= 0.6) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_60.png"/>
                <% } else if (val >= 0.5) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_50.png"/>
                <% } else if (val >= 0.4) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_40.png"/>
                <% } else if (val >= 0.3) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_30.png"/>
                <% } else if (val >= 0.2) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_20.png"/>
                <% } else if (val >= 0.1) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_10.png"/>
                <% } else { %>
                <img width="90px" src="widgets/metro/img/fts_window_2w.png"/>
                <% } %>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                </div>
            </div>
            <div
                <%= (el) -> vis.binds.metro.tileDialogSlider(el, data.wid, data.oid, data['oid-working'], {title:data.label,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:300,height: 180}, {min: data.min, max: data.max, step: parseFloat(data.step),color:data.sliderColor,completeColor:data.sliderCompleteColor,markerColor:data.sliderMarkerColor}) %> style="padding: 42px 10px 10px;">
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileHeating"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileHeating" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock " style="width: 250px; height: 136px; padding: 3px; zoom: 0.5;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile bg-indigo"> <div class="tile-content"> <div style="float:left; height: 90px;"> <img width="90px" src="widgets/metro/img/sani_heating_temp.png"> </div> <div style="float: right; padding-top: 16px; padding-right: 12px;"> <table style="color:white;font-size:11px;display:inline-block;"> <tr><td>Set temperature:</td><td>0%</td></tr> <tr><td>Actual temperature:</td><td>0.0°C</td></tr> <tr><td>Drive position:</td><td>0</td></tr> </table> </div> <div style="clear: both; margin: 0 12px;" class="slider" data-role="slider"></div>  </div> <div class="brand ribbed-steel"> <span class="label fg-white">Heating</span> </div> </div> <div></div> </div> </div></div>'
        data-vis-attrs="set_oid/id/onHeatingOid;temp_oid/id;drive_oid/id;hum_oid/id;hover/checkbox;transform/checkbox;label;min[6]/slider,-20,40,1;max[30]/slider,-20,40,1;step;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="label_set;label_temp;label_drive;label_humidity;"
        data-vis-attrs3="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color;"
        data-vis-attrs4="group.service;lowbat_oid/id;icon_lowbat[icon-battery]/style,iconFont,icon-,,Icon;controlmode_oid/id;icon_control_mode_0[icon-clock]/style,iconFont,icon-,,Icon;icon_control_mode_1[icon-radio-unchecked]/style,iconFont,icon-,,Icon;icon_control_mode_2[icon-briefcase]/style,iconFont,icon-,,Icon;windowopen_oid/id;icon_windowopen[icon-enter]/style,iconFont,icon-,,Icon;badge_bg_class[]/style,metro-,bg-;"
        data-vis-set="metro"
        data-vis-type="ctrl,heating"
        data-vis-name="Tile Heating">
    <% // some data processing to prepare the data 
        var size_badge      = 0;

        if (this.data.attr('controlmode_oid')) size_badge++;
        if (this.data.attr('windowopen_oid'))  size_badge++;
        if (this.data.attr('lowbat_oid'))      size_badge++; 
    %>
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width:287px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content">
                    <div style="float:left; height: 90px;">
                        <img width="90px" src="widgets/metro/img/sani_heating_temp.png"/>
                    </div>
                    <div style="float: right; padding-top: 16px; padding-right: 12px;">
                        <table style="color:white;font-size:11px;display:inline-block;">
                            <% if (this.data.attr('set_oid')) { %>
                                <tr><td><%== this.data.attr('label_set')   ? this.data.attr('label_set')   : _('Set temperature') %>:</td><td><%= vis.binds.metro.format(vis.states.attr(this.data.attr('set_oid') + '.val'), '°') %></td></tr>
                            <% } %>
                            <% if (this.data.attr('temp_oid')) { %>
                                <tr><td><%== this.data.attr('label_temp')  ? this.data.attr('label_temp')  : _('Actual temp.') %>:</td><td><%=    vis.binds.metro.format(vis.states.attr(this.data.attr('temp_oid') + '.val'), '°') %></td></tr>
                            <% } %>
                            <% if (this.data.attr('drive_oid')) { %>
                                <tr><td><%== this.data.attr('label_drive') ? this.data.attr('label_drive') : _('Valve position') %>:</td><td><%=  vis.binds.metro.format(vis.states.attr(this.data.attr('drive_oid') + '.val'), '%') %></td></tr>
                            <% } %>
                            <% if (this.data.attr('hum_oid')) { %>
                                <tr><td><%== this.data.attr('label_humidity') ? this.data.attr('label_humidity') : _('Humidity') %>:</td><td><%=  vis.binds.metro.format(vis.states.attr(this.data.attr('hum_oid') + '.val'), '%') %></td></tr>
                            <% } %>
                        </table>
                    </div>
                    <div style="clear: both; margin: 0 12px;" data-oid="<%= this.data.attr('set_oid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" id="metroSlider_<%= this.data.attr('wid') %>" class="slider" data-role="slider"></div>
                    <div <%= (el) -> vis.binds.metro.slider(el, {color: data.sliderColor, completeColor: data.sliderCompleteColor, markerColor: data.sliderMarkerColor, max: (data.max === '' || data.max === undefined || data.max === null) ? 30 : data.max, min: (data.min === '' || data.min === undefined || data.min === null) ? 6 : data.min, step: parseFloat(data.step) || 0.1, hideIfNoOid: true}) %>></div>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                    <% if (size_badge > 0) { %>
                        <div class="badge <%= this.data.attr('badge_bg_class') %>" style="width: <%= size_badge * 19 %>px">
                        <% if (this.data.attr('controlmode_oid')) { %>
                            <i class="<%= this.data.attr('icon_control_mode_' + vis.states.attr(this.data.attr('controlmode_oid') + '.val')) %>" style="padding: 0 1px;"></i>
                        <% } %>
                        <% if (this.data.attr('lowbat_oid')) { %>
                            <i class="<%= (vis.states.attr(this.data.attr('lowbat_oid') + '.val') === true || vis.states.attr(this.data.attr('lowbat_oid') + '.val') === 'true' || vis.states.attr(this.data.attr('lowbat_oid') + '.val') == 1) ? this.data.attr('icon_lowbat') : 'metro-invisible' %>" style="padding: 0 1px;"></i>
                        <% } %>
                        <% if (this.data.attr('windowopen_oid')) { %>
                            <i class="<%= (vis.states.attr(this.data.attr('windowopen_oid') + '.val') === true || vis.states.attr(this.data.attr('windowopen_oid') + '.val') === 'true' || vis.states.attr(this.data.attr('windowopen_oid') + '.val') == 1) ? this.data.attr('icon_windowopen') : 'metro-invisible' %>" style="padding: 0 1px;"></i>
                        <% } %>
                        </div>
                    <% } %>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %><%= (el) -> vis.binds.metro.inputControl(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileHeatingDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileHeatingDialog" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content" style="text-align: center"> <img width="105px" src="widgets/metro/img/sani_heating_temp.png"> </div> <div style="color:white; font-size:11px; margin-top: 84px; padding-left: 12px;"> Target: °C, Actual: °C </div> <div class="brand "> <span class="label fg-white"></span> </div> </div> <div></div> <div></div> </div> </div>'
        data-vis-attrs="set_oid/id/onHeatingOid;temp_oid/id;drive_oid/id;hover[true]/checkbox;transform[true]/checkbox;label;min[6]/slider,-20,40,1;max[30]/slider,-20,40,1;step;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="label_short_set;label_short_temp;label_short_drive;label_set;label_temp;label_drive;"
        data-vis-attrs3="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color;"
        data-vis-attrs4="group.dialog;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox"
        data-vis-set="metro"
        data-vis-type="ctrl,heating,dialog"
        data-vis-name="Tile Heating Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content" style="text-align: center">
                     <img width="105px" src="widgets/metro/img/sani_heating_temp.png"/>
                </div>
                <div style="color:white; font-size:11px; margin-top: 84px; padding-left: 12px;">
                    <%== this.data.attr('set_oid')   ? (      (this.data.attr('label_short_set')   ? this.data.attr('label_short_set')   : _('Target'))         + ': ' + vis.binds.metro.format(vis.states.attr(this.data.attr('set_oid')   + '.val'), '°')) : '' %>
                    <%== this.data.attr('temp_oid')  ? (' ' + (this.data.attr('label_short_temp')  ? this.data.attr('label_short_temp')  : _('Actual'))         + ': ' + vis.binds.metro.format(vis.states.attr(this.data.attr('temp_oid')  + '.val'), '°')) : '' %>
                    <%== this.data.attr('drive_oid') ? (' ' + (this.data.attr('label_short_drive') ? this.data.attr('label_short_drive') : _('Valve position')) + ': ' + vis.binds.metro.format(vis.states.attr(this.data.attr('drive_oid') + '.val'), '%')) : '' %>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tileDialogHeating(el, data.wid, data.set_oid, data.temp_oid, data.drive_oid, {title: data.label, flat: data.dialog_flat, shadow: data.dialog_shadow, overlay: data.dialog_modal, icon: data.dialog_icon_src, icon_class: data.dialog_icon_class, draggable: data.dialog_draggable, width: 300, height: 180, label_set: this.data.attr('label_set'), label_temp: this.data.attr('label_temp'), label_drive: this.data.attr('label_drive')}, {color: data.sliderColor, completeColor: data.sliderCompleteColor, markerColor: data.sliderMarkerColor, max: data.max, min: data.min, step: parseFloat(data.step)}); %>></div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileDialogStatic"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileDialogStatic" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev  vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content fg-white icon"> <i class="icon-home"></i> </div> <div class="brand "> <span class="label fg-white"></span> <div class="badge "><i class=""></i></div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div></div> </div> <div></div> </div>'
        data-vis-attrs="label;content_oid/id;hover[true]/checkbox;transform[true]/checkbox;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs2="group.badge;icon_badge[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs3="badge_bg_class[]/style,metro-,bg-;"
        data-vis-attrs4="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs5="group.dialog;html/html;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="ctrl,dialog"
        data-vis-name="static - Tile Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>" >
                <div class="tile-content fg-white icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
                    <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                    <i class="<%= this.data.attr("icon_class") %>"></i>
                    <%== this.data.attr('content_oid') ? vis.states.attr(this.data.content_oid + '.val') : '' %>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                    <div class="badge <%= this.data.attr("badge_bg_class") %>"><i class="<%= this.data.attr("icon_badge") %>"></i></div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tileDialog(el, data.wid, null, {title: data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay: data.dialog_modal, icon: data.dialog_icon_src, icon_class: data.dialog_icon_class, draggable: data.dialog_draggable, width: data.dialog_width, height: data.dialog_height}, data.html) %> style="padding: 42px 10px 10px;">
                <div class="caption"></div>
                <div class="content"></div>
            </div>
        </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

<script id="tplMetroTileStaticDialogNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileStaticDialogNumber" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 120px; height: 120px; padding: 3px; z-index: 0;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-book"></i> </div> <div class="brand bg-orange"> <span class="label fg-white"></span> <div style="display: none;" class="badge "></div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div></div> </div> <div></div> </div>'
        data-vis-attrs="content_oid/id;number_oid/id;hide_on_0/checkbox;hover[true]/checkbox;transform[true]/checkbox;bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs0="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[icon-pictures]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs1="group.badge;label;badge_bg_class[]/style,metro-,bg-;brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.dialog;html/html;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="static,dialog"
        data-vis-name="Tile Dialog / val - Badge Number">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
        <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %> <%= this.data.attr('bg_class') %>" >
            <div class="tile-content icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
                <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                <i class="<%= this.data.attr("icon_class") %>"></i>
                <%== this.data.attr('content_oid') ? vis.states.attr(this.data.content_oid + '.val') : '' %>
            </div>
            <div class="brand <%= this.data.attr("brand_bg_class") %>">
                <span class="label fg-white"><%= this.data.attr("label") %></span>
                <div style="<%= vis.states.attr(this.data.number_oid + '.val') > 0 ? '' : 'display:none;' %>" class="badge <%= this.data.attr("badge_bg_class") %>"><%= vis.states.attr(this.data.number_oid + '.val') %></div>
            </div>
        </div>
        <div <%= (el) -> vis.binds.metro.tileDialog(el, data.wid, null, {title:data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:data.dialog_width,height:data.dialog_height}, data.html) %> style="padding: 42px 10px 10px;">
            <div class="caption"></div>
            <div class="content"></div></div>
            </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

<script id="tplMetroTileDialogString"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileDialogString" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-draggable-handle " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-film"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Dialog Object</span> <div class="badge "><i class=""></i></div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div></div> </div>  </div></div>'
        data-vis-attrs="content_oid/id;dialog_oid/id;hover[true]/checkbox;transform[true]/checkbox;bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs0="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs1="group.badge;label;icon_badge[]/style,iconFont,icon-,,Icon ;badge_bg_class[]/style,metro-,bg-;brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.dialog;dialog_fontSize[12px];dialog_padding[0px 0px 0px 0px];dialog_textAlign;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="val,dialog"
        data-vis-name="Tile Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
    <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >

        <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>" >
        <div class="tile-content icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
        <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
        <i class="<%= this.data.attr("icon_class") %>"></i>
        <%== this.data.attr('content_oid') ? vis.states.attr(this.data.content_oid + '.val') : '' %>
    </div>
    <div class="brand <%= this.data.attr("brand_bg_class") %>">
    <span class="label fg-white"><%= this.data.attr("label") %></span>
    <div class="badge <%= this.data.attr("badge_bg_class") %>"><i class="<%= this.data.attr("icon_badge") %>"></i></div>
    </div>
    </div>

    <div <%= (el) -> vis.binds.metro.tileDialogString(el, data.wid, data.dialog_oid, {title:data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:data.dialog_width,height:data.dialog_height},data.dialog_fontSize, data.dialog_padding, data.dialog_textAlign) %> style="padding: 42px 10px 10px;">
    <div class="caption"></div>
    <div class="content"></div></div>
    </div>
    <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

<script id="tplMetroTileStringDialogNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileStringDialogNumber" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-draggable-handle " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;"class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-film"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Dialog Object</span> <div class="badge bg-cyan">1</div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div></div> </div>  </div></div>'
        data-vis-attrs="content_oid/id;dialog_oid/id;number_oid/id;hide_on_0/checkbox;hover[true]/checkbox;transform[true]/checkbox;bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs0="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[icon-database]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs1="group.badge;label;badge_bg_class[]/style,metro-,bg-;brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.dialog;dialog_fontSize[12px];dialog_padding[0px 0px 0px 0px];dialog_textAlign;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="val,dialog"
        data-vis-name="Tile Dialog / Badge Number">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>" >
                <div class="tile-content icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
                    <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                    <i class="<%= this.data.attr("icon_class") %>"></i>
                    <%== this.data.attr('content_oid') ? vis.states.attr(this.data.content_oid + '.val') : '' %>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                <div style="<%= vis.states.attr(this.data.number_oid + '.val') > 0 ? '' : 'display:none;' %>" class="badge <%= this.data.attr("badge_bg_class") %>"><%= vis.states.attr(this.data.number_oid + '.val') %></div>
            </div>
        </div>

        <div <%= (el) -> vis.binds.metro.tileDialogString(el, data.wid, data.dialog_oid, {title:data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:data.dialog_width,height:data.dialog_height},data.dialog_fontSize,data.dialog_padding,data.dialog_textAlign) %> style="padding: 42px 10px 10px;">
            <div class="caption"></div>
            <div class="content"></div></div>
        </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

<script id="tplMetroTileDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileDialog" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-draggable-handle " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-pictures"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">View Container</span> <div class="badge "><i class=""></i></div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div> </div> </div>  </div></div>'
        data-vis-attrs="contains_view/views;hover[true]/checkbox;transform[true]/checkbox;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs2="icon_class[icon-pictures]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs3="group.badge;label;icon_badge[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="badge_bg_class[]/style,metro-,bg-;"
        data-vis-attrs5="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs6="group.dialog;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;"
        data-vis-attrs7="dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="container,dialog"
        data-vis-name="Tile Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>" >
                <div class="tile-content icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
                    <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                    <i class="<%= this.data.attr("icon_class") %>"></i>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                    <div class="badge <%= this.data.attr("badge_bg_class") %>"><i class="<%= this.data.attr("icon_badge") %>"></i></div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tileDialog(el, data.wid, data.contains_view, {title:data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:data.dialog_width,height:data.dialog_height}) %> style="padding: 42px 10px 10px;">
                <div class="caption"></div>
                <div class="content"></div>
            </div>
        </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

<script id="tplMetroTileDialogNumber"
        type="text/ejs"
        data-vis-prev='<div id="prev_tplMetroTileDialogNumber" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev ui-draggable-handle " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-pictures"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Dialog num</span> <div class="badge bg-teal">2</div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div> </div> </div>  </div></div>'
        data-vis-attrs="contains_view/views;number_oid/id;hide_on_0/checkbox;hover[true]/checkbox;transform[true]/checkbox;"
        data-vis-attrs0="bg_class[]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs2="group.badge;label;badge_bg_class[]/style,metro-,bg-;"
        data-vis-attrs3="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs4="group.dialog;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;"
        data-vis-attrs5="dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        class="vis-tpl"
        data-vis-set="metro"
        data-vis-type="container,dialog"
        data-vis-name="Tile Dialog / val - Badge Number">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>" >
                <div class="tile-content icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
                    <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                    <i class="<%= this.data.attr("icon_class") %>"></i>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                    <div style="<%= vis.states.attr(this.data.number_oid + '.val') > 0 ? '' : 'display:none;' %>" class="badge <%= this.data.attr("badge_bg_class") %>"><%= vis.states.attr(this.data.number_oid + '.val') %></div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tileDialog(el, data.wid, data.contains_view, {title:data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:data.dialog_width,height:data.dialog_height}) %> style="padding: 42px 10px 10px;">
                <div class="caption"></div>
                <div class="content"></div>
            </div>
        </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

<script id="tplMetroTileFrameDialogNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileFrameDialogNumber" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev" style="width: 136px; height: 136px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"><div class="tile-content icon"><i class="icon-cloud"></i></div><div class="brand ribbed-steel"><span class="label fg-white">iFrame Dialog</span> <div style="" class="badge "></div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div></div> </div>  </div></div>'
        data-vis-attrs="content;hover[true]/checkbox;transform[true]/checkbox;bg_class[bg-indigo]/style,metro-,bg- ribbed-;group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[icon-accessibility]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs0="group.badge;label;badge_label;badge_bg_class[]/style,metro-,bg-;brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="group.dialog;dialog_url[https:~~maps.google.com~maps?f=q&source=s_q&hl=de&geocode=&q=Karlsruhe&ie=UTF8&t=m&z=12&output=embed&iwloc=near];dialog_scroll;dialog_width[400px];dialog_height[300px];dialog_title[Google maps];dialog_flat[true]/checkbox;dialog_shadow[true]/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;dialog_icon_class[icon-globe]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="iframe,dialog"
        data-vis-name="Tile Dialog / iFrame">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>" >
                <div class="tile-content icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
                    <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                    <i class="<%= this.data.attr("icon_class") %>"></i>
                    <%== this.data.attr('content') || '' %>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr('label') %></span>
                    <div style="" class="badge <%= this.data.attr('badge_bg_class') %>"><%= this.data.attr('badge_label') %></div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tileDialog(el, data.wid, null, {title: data.dialog_title, flat: data.dialog_flat, shadow: data.dialog_shadow, overlay: data.dialog_modal, icon: data.dialog_icon_src, icon_class: data.dialog_icon_class, draggable: data.dialog_draggable, width: data.dialog_width, height: data.dialog_height, scroll: data.dialog_scroll}, data.dialog_url, true) %> style="padding: 42px 10px 10px;">
                <div class="caption"></div>
                <div class="content"></div></div>
            </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>



<script id="tplMetroTileToggleNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileToggle" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body " data-oid="dev1"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-minus-2"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Toggle</span> <div class="badge bg-cyan"><i class="icon-minus"></i></div> </div> </div>  </div> </div></div>'
        data-vis-attrs="oid;number_oid/id;hide_on_0/checkbox;hover[true]/checkbox;transform[true]/checkbox;select_on_true/checkbox;label_false;label_true;"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false/image;icon_true/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[icon-minus]/style,iconFont,icon-,,Icon ;icon_class_true[icon-plus]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="group.badge;badge_bg_class[]/style,metro-,bg-;"
        data-vis-attrs5="badge_bg_class_false[bg-cyan]/style,metro-,bg-;"
        data-vis-attrs6="badge_bg_class_true[bg-teal]/style,metro-,bg-;"
        data-vis-attrs7="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs8="brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs9="group.ccontrol;urlTrue;urlFalse;oidTrue/id;oidFalse/id;oidTrueValue;oidFalseValue;"
        data-vis-set="metro"
        data-vis-type="ctrl,bool"
        data-vis-name="Tile Toggle - Bage Number">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%"
            class="metro vis-widget-body <%== this.data.attr('class') %>"
            data-oid="<%= this.data.attr('oid') %>"
            data-url-true="<%=  this.data.attr('urlTrue') %>"
            data-url-false="<%= this.data.attr('urlFalse') %>"
            data-oid-true="<%=  this.data.attr('oidTrue') %>"
            data-oid-false="<%= this.data.attr('oidFalse') %>"
            data-oid-true-value="<%=  this.data.attr('oidTrueValue') %>"
            data-oid-false-value="<%= this.data.attr('oidFalseValue') %>"
            <%= (el) -> vis.binds.basic.toggle(el) %>
            >
            <div style="width: 100%; height: 100%;"  id="metroTile_<%= this.data.attr('wid') %>" class="tile icon <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val')) === '_true') && this.data.attr('select_on_true') ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>" >
                <div class="tile-content icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) + '"/>' : '' %>
                    <i class="<%= vis.states.attr(this.data.attr('oid') + '.val') ? this.data.attr("icon_class_true") : this.data.attr("icon_class_false") %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                    <span class="label fg-white"><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %></span>
                    <div style="<%= vis.states.attr(this.data.number_oid + '.val') > 0 ? '' : 'display:none;' %>" class="badge <%= this.data.attr("badge_bg_class") %>"><%= vis.states.attr(this.data.number_oid + '.val') %></div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileDimmerDialogactiv"
        type="text/ejs"
        data-vis-prev='<div id="prev_tplMetroTileDimmerDialog" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"><div class="tile-content" style="text-align: center"><img width="90%" src="widgets/metro/img/light_light_dim.png"></div> <div class="brand ribbed-steel"><span class="label fg-white">Dimmer Dialog</span></div> </div><div style="padding: 42px 10px 10px;"></div></div></div></div>'
        data-vis-attrs="oid;oid-working;min;max;step[1];digits/number;hover[true]/checkbox;transform[true]/checkbox;label;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
	data-vis-attrs2="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs3="brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs4="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color;"
        data-vis-attrs5="group.dialog;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;autoclose/slider,0,30000,100;"
        class="vis-tpl"
        data-vis-set="metro"
        data-vis-type="ctrl,dimmer,dialog"
        data-vis-name="Tile Dimmer Dialog activ">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >

            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content" style="text-align: center">
                <%
                var str = vis.states.attr(this.data.oid + '.val');
                var val = parseFloat(str);
                if (str === true || str === 'true') val = 1;
                if (isNaN(val)) val = 0;

                var min = this.data.attr('min');
                if (min !== undefined && min !== null && min !== '') {
                    min = parseFloat(min);
                } else {
                    min = 0;
                }

                var max = this.data.attr('max');
                if (max !== undefined && max !== null && max !== '') {
                    max = parseFloat(max);
                } else {
                    max = 1;
                }

                val = (val - min) / (max - min);

                if (val === 1) {
                %>
                <img width="90%" src="widgets/metro/img/light_light_dim_100.png"/>
                <% } else if (val >= 0.9) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_90.png"/>
                <% } else if (val >= 0.8) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_80.png"/>
                <% } else if (val >= 0.7) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_70.png"/>
                <% } else if (val >= 0.6) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_60.png"/>
                <% } else if (val >= 0.5) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_50.png"/>
                <% } else if (val >= 0.4) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_40.png"/>
                <% } else if (val >= 0.3) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_30.png"/>
                <% } else if (val >= 0.2) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_20.png"/>
                <% } else if (val >= 0.1) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_10.png"/>
                <% } else if (val >= 0.01) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_00.png"/>
                <% } else { %>
                <img width="90%" src="widgets/metro/img/light_light_dim.png"/>
                <% } %>
                </div>

		<div class="brand <%= vis.states.attr(this.data.attr('oid') + '.val') > 0 ? this.data.attr("brand_bg_class_true") : this.data.attr("brand_bg_class_false") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                </div>
            </div>
            <div
                <%= (el) -> vis.binds.metro.tileDialogSlider(el, data.wid, data.oid, data['oid-working'], {title: data.label, flat: data.dialog_flat, shadow: data.dialog_shadow, overlay: data.dialog_modal, icon: data.dialog_icon_src, icon_class: data.dialog_icon_class, draggable: data.dialog_draggable, width: 300, height: 180}, {min: data.min, max: data.max, step: parseFloat(data.step), color: data.sliderColor, completeColor: data.sliderCompleteColor, markerColor: data.sliderMarkerColor, digits: data.digits}) %> style="padding: 42px 10px 10px;">
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
	<div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>


<!-- --------------metro.html--- END -->
<!-- --------------spotify-premium.html--- START -->
<!--
    ioBroker.spotify-premium Widget-Set

    version: "1.0.0"

    Copyright 12.2018-2021 twonky4<twonky4@gmx.de>
-->

<script type="text/javascript">
"use strict";

// add translations for edit mode
if (vis.editMode) {
	 $.extend(true, systemDictionary, {
 		"oidplay": { "en": "Trigger Play Id", "de": "Auslösespiel-ID", "ru": "Идентификатор запуска воспроизведения", "pt": "ID do jogo do acionador", "nl": "Trigger Play-ID", "fr": "Identifiant de lecture du déclencheur", "it": "Attiva l'ID del gioco", "es": "Trigger Play Id", "pl": "Trigger Play Id"},
 		"oidpause": {"en": "Trigger Pause Id", "de": "Auslöser-Pause-ID", "ru": "Идентификатор паузы запуска", "pt": "ID de pausa do acionador", "nl": "Trigger-pauze-ID", "fr": "Id de pause de déclenchement", "it": "Trigger Pause Id", "es": "Id. De pausa del disparador", "pl": "Trigger Pause Id"},
 		"oidstate": {"en": "Status Id", "de": "Status-ID", "ru": "Идентификатор статуса", "pt": "ID do estado", "nl": "Status-ID", "fr": "ID de statut", "it": "ID stato", "es": "ID de estado", "pl": "ID statusu"},
 		"colorplay": {"en": "play icon color", "de": "Farbe Play Icon", "ru": "цвет", "pt": "cor", "nl": "kleur", "fr": "Couleur", "it": "colore", "es": "color", "pl": "kolor"},
 		"colorpause": {"en": "pause icon color", "de": "Farbe Pause Icon", "ru": "цвет", "pt": "cor", "nl": "kleur", "fr": "Couleur", "it": "colore", "es": "color", "pl": "kolor"},
 		"oidon": { "en": "Trigger On Id", "de": "Auslösespiel-ID", "ru": "Идентификатор запуска воспроизведения", "pt": "ID do jogo do acionador", "nl": "Trigger Play-ID", "fr": "Identifiant de lecture du déclencheur", "it": "Attiva l'ID del gioco", "es": "Trigger Play Id", "pl": "Trigger Play Id"},
 		"oidoff": {"en": "Trigger Off Id", "de": "Auslöser-Pause-ID", "ru": "Идентификатор паузы запуска", "pt": "ID de pausa do acionador", "nl": "Trigger-pauze-ID", "fr": "Id de pause de déclenchement", "it": "Trigger Pause Id", "es": "Id. De pausa del disparador", "pl": "Trigger Pause Id"},
 		"oidall": {"en": "Trigger All Id", "de": "Auslöser-Pause-ID", "ru": "Идентификатор паузы запуска", "pt": "ID de pausa do acionador", "nl": "Trigger-pauze-ID", "fr": "Id de pause de déclenchement", "it": "Trigger Pause Id", "es": "Id. De pausa del disparador", "pl": "Trigger Pause Id"},
 		"oidone": {"en": "Trigger One Id", "de": "Auslöser-Pause-ID", "ru": "Идентификатор паузы запуска", "pt": "ID de pausa do acionador", "nl": "Trigger-pauze-ID", "fr": "Id de pause de déclenchement", "it": "Trigger Pause Id", "es": "Id. De pausa del disparador", "pl": "Trigger Pause Id"},
 		"coloron": {"en": "shuffle on icon color", "de": "Farbe Shuffle An Icon", "ru": "цвет", "pt": "cor", "nl": "kleur", "fr": "Couleur", "it": "colore", "es": "color", "pl": "kolor"},
 		"coloroff": {"en": "off icon color", "de": "Farbe Aus Icon", "ru": "цвет", "pt": "cor", "nl": "kleur", "fr": "Couleur", "it": "colore", "es": "color", "pl": "kolor"},
 		"colorall": {"en": "all icon color", "de": "Farbe Alle Icon", "ru": "цвет", "pt": "cor", "nl": "kleur", "fr": "Couleur", "it": "colore", "es": "color", "pl": "kolor"},
 		"colorone": {"en": "one icon color", "de": "Farbe Eins Icon", "ru": "цвет", "pt": "cor", "nl": "kleur", "fr": "Couleur", "it": "colore", "es": "color", "pl": "kolor"}
	 });
}

vis.binds.spotify = {
	 getPlayImage: function (data) {
	 	var src;

	 	// display next state
	 	if(vis.states[data.oidstate + '.val']) {
	 		src = 'pause_' + data.colorpause;
	 	} else {
	 		src = 'play_' + data.colorplay;
	 	}

	 	return 'widgets/spotify-premium/img/' + src + '.png';
	 },
	 triggerPlayButton: function (el) {
	     var $this = $(el);
	     var state = $this.data('oidstate');
	     var play = $this.data('oidplay');
	     var pause = $this.data('oidpause');
	     var colorplay = $this.data('colorplay');
	     var colorpause = $this.data('colorpause');

	     if (state && play && pause && !vis.editMode) {
            function onChange(e, newVal) {
                $this.find('img').prop('src', vis.binds.spotify.getPlayImage({oidstate: state, colorplay: colorplay, colorpause: colorpause}));
            }
	    	vis.states.bind(state + '.val', onChange);

			var moved = false;
	        $this.on('click touchend', function () {
	             // Protect against two events
	             if (vis.detectBounce(this) || moved) return;

	             var val = vis.states[state + '.val'];
	             if(val) {
	             	vis.setValue(pause, true);
	             } else {
	             	vis.setValue(play, true);
	             }
	        }).on('touchmove', function () {
				moved = true;
			}).on('touchstart', function () {
				moved = false;
			}).data('destroy', function (id, $widget) {
				$widget.off('click touchend').off('touchmove').off('touchstart');
	        });
	     }
	 },
	 getShuffleImage: function (data) {
	 	var src = 'shuffle_';

	 	// display current state
	 	if(vis.states[data.oidstate + '.val'] == 'on') {
	 		src += data.coloron;
	 	} else {
	 		src += data.coloroff;
	 	}

	 	return 'widgets/spotify-premium/img/' + src + '.png';
	 },
	 triggerShuffleButton: function (el) {
	     var $this = $(el);
	     var state = $this.data('oidstate');
	     var on = $this.data('oidon');
	     var off = $this.data('oidoff');
	     var coloron = $this.data('coloron');
	     var coloroff = $this.data('coloroff');

	     if (state && on && off && !vis.editMode) {
            function onChange(e, newVal) {
                $this.find('img').prop('src', vis.binds.spotify.getShuffleImage({oidstate: state, coloroff: coloroff, coloron: coloron}));
            }
	    	vis.states.bind(state + '.val', onChange);

			var moved = false;
	        $this.on('click touchend', function () {
	             // Protect against two events
	             if (vis.detectBounce(this) || moved) return;

	             var val = vis.states[state + '.val'];
	             if(val == 'on') {
	             	vis.setValue(off, true);
	             } else {
	             	vis.setValue(on, true);
	             }
	        }).on('touchmove', function () {
				moved = true;
			}).on('touchstart', function () {
				moved = false;
			}).data('destroy', function (id, $widget) {
				$widget.off('click touchend').off('touchmove').off('touchstart');
	        });
	     }
	 },
	 getRepeatImage: function (data) {
	 	var src = 'repeat_';

	 	// display current state
	 	if(vis.states[data.oidstate + '.val'] == 'track') {
	 		src += 'one_';
	 		src += data.colorone;
	 	} else if(vis.states[data.oidstate + '.val'] == 'context') {
	 		src += data.colorall;
	 	} else {
	 		src += data.coloroff;
	 	}

	 	return 'widgets/spotify-premium/img/' + src + '.png';
	 },
	 triggerRepeatButton: function (el) {
	     var $this = $(el);
	     var state = $this.data('oidstate');
	     var one = $this.data('oidone');
	     var all = $this.data('oidall');
	     var off = $this.data('oidoff');
	     var colorone = $this.data('colorone');
	     var colorall = $this.data('colorall');
	     var coloroff = $this.data('coloroff');

	     if (state && one && all && off && !vis.editMode) {
            function onChange(e, newVal) {
                $this.find('img').prop('src', vis.binds.spotify.getRepeatImage({oidstate: state, coloroff: coloroff, colorone: colorone, colorall: colorall}));
            }
	    	vis.states.bind(state + '.val', onChange);

			var moved = false;
	        $this.on('click touchend', function () {
	             // Protect against two events
	             if (vis.detectBounce(this) || moved) return;

	             // off -> context -> track
	             var val = vis.states[state + '.val'];
	             if(val == 'context') {
	             	vis.setValue(one, true);
	             } else if(val == 'track') {
	             	vis.setValue(off, true);
	             } else {
	             	vis.setValue(all, true);
	             }
	        }).on('touchmove', function () {
				moved = true;
			}).on('touchstart', function () {
				moved = false;
			}).data('destroy', function (id, $widget) {
				$widget.off('click touchend').off('touchmove').off('touchstart');
	        });
	     }
	 },
	 getSkipImage: function (data, str) {
	 	return 'widgets/spotify-premium/img/skip_' + str + '_' + data.colorbox + '.png';
	 },
	 triggerSkipButton: function (el) {
	     var $this = $(el);
	     var oid = $this.data('oid');

	     if (oid && !vis.editMode) {
			var moved = false;
	        $this.on('click touchend', function () {
	             // Protect against two events
	             if (vis.detectBounce(this) || moved) return;

             	vis.setValue(oid, true);
	        }).on('touchmove', function () {
				moved = true;
			}).on('touchstart', function () {
				moved = false;
			}).data('destroy', function (id, $widget) {
				$widget.off('click touchend').off('touchmove').off('touchstart');
	        });
	     }
	 }
};
</script>

<script id="tplSpotifyPlayButton"
        type="text/ejs"
        class="vis-tpl"
  		data-vis-prev='<div id="prev_tplSpotifyPlayButton" style="position: relative; text-align: initial;padding: 4px; height: 72px"><div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled"false "handles":"e"}"> <div class="vis-widget-prev-body"> <img data-oidplay="" data-oidpause="" data-oidstate="" data-colorplay="" data-colorpause="" style="width:auto; height:72px" src="widgets/spotify-premium/img/play_black.png" role="button"/> </div> </div>'
        data-vis-set="spotify-premium"
        data-vis-type="ctrl"
        data-vis-name="Play Toggle"
        data-vis-attrs="oidplay[spotify-premium.0.player.play]/id;oidpause[spotify-premium.0.player.pause]/id;oidstate[spotify-premium.0.player.isPlaying]/id;colorplay[black]/select,black,white,green;colorpause[black]/select,black,white,green">
    <div
		class="vis-widget <%== this.data.attr('class') %>"
		id="<%= this.data.attr('wid') %>"
		data-oidplay="<%= this.data.attr('oidplay') %>"
		data-oidpause="<%= this.data.attr('oidpause') %>"
		data-oidstate="<%= this.data.attr('oidstate') %>"
		data-colorplay="<%= this.data.attr('colorplay') %>"
		data-colorpause="<%= this.data.attr('colorpause') %>"
		<%= (el) -> vis.binds.spotify.triggerPlayButton(el) %>
	>
        <div class="vis-widget-body">
            <img style="width:100%; height:auto" src="<%= vis.binds.spotify.getPlayImage(data) %>" />
        </div>
    </div>
</script>

<script id="tplSpotifyShuffleButton"
        type="text/ejs"
        class="vis-tpl"
  		data-vis-prev='<div id="prev_tplSpotifyShuffleButton" style="position: relative; text-align: initial;padding: 4px; height: 72px"><div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled"false "handles":"e"}"> <div class="vis-widget-prev-body"> <img data-oidon="" data-oidoff="" data-oidstate="" data-coloron="" data-coloroff="" style="width:auto; height:72px" src="widgets/spotify-premium/img/shuffle_black.png" role="button"/> </div> </div>'
        data-vis-set="spotify-premium"
        data-vis-type="ctrl"
        data-vis-name="Shuffle Toggle"
        data-vis-attrs="oidon[spotify-premium.0.player.shuffleOn]/id;oidoff[spotify-premium.0.player.shuffleOff]/id;oidstate[spotify-premium.0.player.shuffle]/id;coloroff[black]/nselect,black,white,green;coloron[green]/nselect,black,white,green">
    <div
		class="vis-widget <%== this.data.attr('class') %>"
		id="<%= this.data.attr('wid') %>"
		data-oidon="<%= this.data.attr('oidon') %>"
		data-oidoff="<%= this.data.attr('oidoff') %>"
		data-oidstate="<%= this.data.attr('oidstate') %>"
		data-coloron="<%= this.data.attr('coloron') %>"
		data-coloroff="<%= this.data.attr('coloroff') %>"
		<%= (el) -> vis.binds.spotify.triggerShuffleButton(el) %>
	>
        <div class="vis-widget-body">
            <img style="width:100%; height:auto" src="<%= vis.binds.spotify.getShuffleImage(data) %>" />
        </div>
    </div>
</script>

<script id="tplSpotifyRepeatButton"
        type="text/ejs"
        class="vis-tpl"
  		data-vis-prev='<div id="prev_tplSpotifyRepeatButton" style="position: relative; text-align: initial;padding: 4px; height: 72px"><div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled"false "handles":"e"}"> <div class="vis-widget-prev-body"> <img data-oidall="" data-oidoff="" data-oidone="" data-oidstate="" data-colorall="" data-coloroff="" data-colorone="" data-colorall="" style="width:auto; height:72px" src="widgets/spotify-premium/img/repeat_black.png" role="button"/> </div> </div>'
        data-vis-set="spotify-premium"
        data-vis-type="ctrl"
        data-vis-name="Repeat Toggle"
        data-vis-attrs="oidall[spotify-premium.0.player.repeatContext]/id;oidoff[spotify-premium.0.player.repeatOff]/id;oidone[spotify-premium.0.player.repeatTrack]/id;oidstate[spotify-premium.0.player.repeat]/id;coloroff[black]/nselect,black,white,green;colorall[green]/nselect,black,white,green;colorone[green]/nselect,black,white,green">
    <div
		class="vis-widget <%== this.data.attr('class') %>"
		id="<%= this.data.attr('wid') %>"
		data-oidall="<%= this.data.attr('oidall') %>"
		data-oidoff="<%= this.data.attr('oidoff') %>"
		data-oidone="<%= this.data.attr('oidone') %>"
		data-oidstate="<%= this.data.attr('oidstate') %>"
		data-colorall="<%= this.data.attr('colorall') %>"
		data-coloroff="<%= this.data.attr('coloroff') %>"
		data-colorone="<%= this.data.attr('colorone') %>"
		<%= (el) -> vis.binds.spotify.triggerRepeatButton(el) %>
	>
        <div class="vis-widget-body">
            <img style="width:100%; height:auto" src="<%= vis.binds.spotify.getRepeatImage(data) %>" />
        </div>
    </div>
</script>

<script id="tplSpotifyPreviousButton"
        type="text/ejs"
        class="vis-tpl"
  		data-vis-prev='<div id="prev_tplSpotifyPreviousButton" style="position: relative; text-align: initial;padding: 4px; height: 72px"><div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled"false "handles":"e"}"> <div class="vis-widget-prev-body"> <img data-oid="" data-colorbox="" style="width:auto; height:72px" src="widgets/spotify-premium/img/skip_prev_black.png" role="button"/> </div> </div>'
        data-vis-set="spotify-premium"
        data-vis-type="ctrl"
        data-vis-name="Previous Track Button"
        data-vis-attrs="oid[spotify-premium.0.player.skipMinus]/id;colorbox[black]/nselect,black,white,green">
    <div
		class="vis-widget <%== this.data.attr('class') %>"
		id="<%= this.data.attr('wid') %>"
		data-oid="<%= this.data.attr('oid') %>"
		data-colorbox="<%= this.data.attr('colorbox') %>"
		<%= (el) -> vis.binds.spotify.triggerSkipButton(el) %>
	>
        <div class="vis-widget-body">
            <img style="width:100%; height:auto" src="<%= vis.binds.spotify.getSkipImage(data, 'prev') %>" />
        </div>
    </div>
</script>

<script id="tplSpotifyNextButton"
        type="text/ejs"
        class="vis-tpl"
  		data-vis-prev='<div id="prev_tplSpotifyNextButton" style="position: relative; text-align: initial;padding: 4px; height: 72px"><div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled"false "handles":"e"}"> <div class="vis-widget-prev-body"> <img data-oid="" data-colorbox="" style="width:auto; height:72px" src="widgets/spotify-premium/img/skip_next_black.png" role="button"/> </div> </div>'
        data-vis-set="spotify-premium"
        data-vis-type="ctrl"
        data-vis-name="Previous Track Button"
        data-vis-attrs="oid[spotify-premium.0.player.skipPlus]/id;colorbox[black]/nselect,black,white,green">
    <div
		class="vis-widget <%== this.data.attr('class') %>"
		id="<%= this.data.attr('wid') %>"
		data-oid="<%= this.data.attr('oid') %>"
		data-colorbox="<%= this.data.attr('colorbox') %>"
		<%= (el) -> vis.binds.spotify.triggerSkipButton(el) %>
	>
        <div class="vis-widget-body">
            <img style="width:100%; height:auto" src="<%= vis.binds.spotify.getSkipImage(data, 'next') %>" />
        </div>
    </div>
</script>

<!-- --------------spotify-premium.html--- END -->
<!-- --------------swipe.html--- START -->
<style>
    .roundabout-holder {
        list-style: none;
        position: absolute;
        left:100px;
        top:10px;
        right: 0;
        margin: 0;
        overflow: visible;
        height: calc(100% - 20px);
        width: calc(100% - 200px);
    }

    .roundabout-moveable-item {
        text-align: center;
    }

    .li_carousel {
        background-color: rgba(0, 0, 0, 0);
        text-align: center;
        position: relative;
    }

    .carousel_blocking {
        position: relative;
        z-index: 149;
        width: 100%;
        height: 100%;
    }

    .roundabout-in-focus{
        z-index: 1000;
    }
</style>

<script type="text/javascript">
    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            "group_left":           {"en": "Swipe to left",     "de": "Swipe nach links",   "ru": "Сдвиг влево"},
            "left_nav_view":        {"en": "View name",         "de": "Viewname",           "ru": "Имя страницы"},
            "left_in_effect":       {"en": "In effect",         "de": "In-Effekt",          "ru": "In эффект"},
            "left_in_eff_opt":      {"en": "In options",        "de": "In-Optionen",        "ru": "In опции"},
            "left_out_effect":      {"en": "Out effect",        "de": "Out-Effekt",         "ru": "Out эффект"},
            "left_out_eff_opt":     {"en": "Out options",       "de": "Out-Optionen",       "ru": "Out опции"},
            "group_right":          {"en": "Swipe to right",    "de": "Swipe nach rechts",  "ru": "Сдвиг вправо"},
            "right_nav_view":       {"en": "View name",         "de": "Viewname",           "ru": "Имя страницы"},
            "right_in_effect":      {"en": "In effect",         "de": "In-Effekt",          "ru": "In эффект"},
            "right_in_eff_opt":     {"en": "In options",        "de": "In-Optionen",        "ru": "In опции"},
            "right_out_effect":     {"en": "Out effect",        "de": "Out-Effekt",         "ru": "Out эффект"},
            "right_out_eff_opt":    {"en": "Out options",       "de": "Out-Optionen",       "ru": "Out опции"},
            "Swipe Navigation":     {"en": "Swipe Navigation",  "de": "Swipe Navigation",   "ru": "Swipe навигация"}
        });
    }

    vis.binds.swipe = {
        loadedSwipe: false,
        loadedRound: false,
        loadSwipeScripts: function (cb) {
            if (vis.binds.swipe.loadedSwipe) {
                cb && cb();
            } else {
                vis.binds.swipe.loadedSwipe = true;
                $.ajax({
                    url: 'widgets/swipe/js/jquery.touchSwipe.min.js',
                    dataType: 'script',
                    success: function () {
                        cb && cb();
                    },
                    async: false
                });
            }
        },
        loadRoundScripts: function (cb) {
            if (vis.binds.swipe.loadedRound) {
                cb && cb();
            } else {
                vis.binds.swipe.loadedRound = true;
                $.ajax({
                    url: 'widgets/swipe/js/jquery.roundabout.min.js',
                    dataType: 'script',
                    success: function () {
                        jQuery.ajax({
                            url: 'widgets/swipe/js/jquery.roundabout-shapes.js',
                            dataType: 'script',
                            success: function () {
                                cb && cb();
                            },
                            async: false
                        });
                    },
                    async: false
                });
            }
        },
        swipeNav: function (wid, view, data, style) {
            var $div = $('#' + wid);
            // if nothing found => wait
            if (!$div.length) {
                setTimeout(function () {
                    vis.binds.swipe.swipeNav(wid, view, data, style);
                }, 100);
                return;
            }

            if (vis.editMode) {
                $div.show()
                    .find('.translate-it')
                        .each(function () {
                            $(this).html(_($(this).text()));
                        });
            }

            var $view = $('#visview_' + view);

            if (!vis.editMode) {
                vis.binds.swipe.loadSwipeScripts(function () {
                    $view.swipe({
                        swipeLeft: function () {
                            vis.changeView(data['left_nav_view'], data['left_nav_view'], {
                                effect: data['left_out_effect'],
                                options: {
                                    direction: data['left_out_eff_opt'],
                                    queue: false
                                }, duration: $div.attr('duration')
                            }, {
                                effect: data['left_in_effect'],
                                options: {direction: data['left_in_eff_opt'], queue: false},
                                duration: $div.attr('duration')
                            }, true)
                        },
                        swipeRight: function () {
                            vis.changeView(data['right_nav_view'], data['right_nav_view'], {
                                effect: data['right_out_effect'],
                                options: {direction: data['right_out_eff_opt'], queue: false},
                                duration: $div.attr('duration')
                            }, {
                                effect: data['right_in_effect'],
                                options: {direction: data['right_in_eff_opt'], queue: false},
                                duration: $div.attr('duration')
                            }, true)
                        }
                    });
                });
            }
        },
        applyCarousel: function ($div, childView) {
            var $childView = $div.find('#visview_' + childView);
            var count = $div.data('count');
            count = count || 0;

            if (!$childView.length) {
                count++;
                if (count > 20) {
                    return;
                }
                $div.data('count', count);
                setTimeout(function () {
                    vis.binds.swipe.applyCarousel($div, childView);
                }, 100);
                return;
            }
            var $all = $div.find('.vis-widget');
            $all.each(function () {
                var $id = $(this);
                var id = $id.attr('id');
                var idOldPos = $id.position();

                var $idAndChilds = $childView.children('[id^=' + id + ']');

                if ($idAndChilds.length === 1) {
                    $id.css({top: 0, left: 0});

                    $idAndChilds.wrapAll('<li id="li_' + id + '" class="li_carousel" ></li>');
                    $('#li_' + id).css({height: $id.css('height'), width: $id.css('width')});
                } else {
                    $idAndChilds.wrapAll('<div id="wrap_' + id + '" style="position: absolute; height: 50px; width: 50px; left: ' + (idOldPos.left * -1) + 'px; top:' + (idOldPos.top * -1) + 'px"></div>');
                    $('#wrap_' + id).wrap('<li id="li_' + id + '" class="li_carousel"></li>');
                    $('#li_' + id).css({height: $id.css('height'), width: $id.css('width')});
                }
            });

            $childView.children('.li_carousel').append('<div class="carousel_blocking"></div>');
            $childView.children('.li_carousel').wrapAll('<ul class="parent_carousel"></ul>');

            $childView.find('.parent_carousel')
                .bind('ready', function () {
                    var child = $('.roundabout-in-focus').children();
                    $(child[1]).removeClass('carousel_blocking');
                })
                .roundabout({
                    clickToFocus: true,
                    enableDrag: true,
                    dragFactor: 2,
                    minZ: 1,
                    maxZ: 100,
                    tilt: -4,
                    minOpacity: 0.2,
                    minScale: 1,
                    childSelector: '.li_carousel',
                    triggerFocusEvents: true,
                    triggerBlurEvents: true
                });

            $childView.find('.li_carousel')
                .bind('focus', function () {
                    var child = $(this).children();
                    $(child[1]).removeClass('carousel_blocking');
                    $(this).removeClass('roundabout-moveable-item')
                })
                .bind('blur', function () {
                    var child = $(this).children();
                    $(child[1]).addClass('carousel_blocking');
                    $(this).addClass('roundabout-moveable-item')
                });
        },
        carousel: function (wid, view, data, style) {
            var $div = $('#' + wid);
            var childView = data.contains_view;

            // if nothing found => wait
            if (!$div.length) {
                setTimeout(function () {
                    vis.binds.swipe.carousel(wid, view, data, style);
                }, 100);
                return;
            }

            if (view === data.contains_view) {
                $div.find('.vis-widget-body').attr('data-vis-contains', '');
                $div.html('<div style="color: red">' + _('Cannot show itself') + '</div>');
                return;
            }

            if (vis.editMode) return;

            vis.binds.swipe.loadRoundScripts(function () {
                vis.binds.swipe.applyCarousel($div, childView);
            });
        }
    };
</script>

<script id="tplSwipe"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="swipe"
        data-vis-prev='<img src="widgets/swipe/img/Prev_Swipe.png"></img>'
        data-vis-name="swipe Navigation"
        data-vis-attrs="duration;"
        data-vis-attrs0="group.left;left_nav_view;left_in_effect[slide];left_in_eff_opt[right];left_out_effect[slide];left_out_eff_opt[left];"
        data-vis-attrs1="group.right;right_nav_view;right_in_effect[slide];right_in_eff_opt[left];right_out_effect[slide];right_out_eff_opt[right];">
    <div class="vis-widget <%== this.data.attr('class') %>" style="display: none; width: 160px; height: 64px; background-color: #333; color: #eee; border: 2px dashed red; opacity:0.8;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.swipe.swipeNav(this.data.wid, this.view, this.data, this.style) %>>
        <div class="vis-widget-body">
            <div style="font-weight: bold" class="translate-it">Swipe Navigation</div>
            <table>
                <tr><td style="width: 40px" class="translate-it">left</td><td style="width: 20px">&gt;</td><td><%= this.data.attr('left_nav_view') %></td></tr>
                <tr><td style="width: 40px" class="translate-it">right</td><td style="width: 20px">&lt;</td><td><%= this.data.attr('right_nav_view') %></td></tr>
            </table>
        </div>
    </div>
</script>


<script id="tplCarousel"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="swipe"
        data-vis-prev='<img src="widgets/swipe/img/Prev_Carousel.png"></img>'
        data-vis-name="Carousel"
        data-vis-attrs="contains_view/views">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 300px; height: 100px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.swipe.carousel(this.data.wid, this.view, this.data, this.style) %>>
        <% if (vis.editMode) { %>
            <div class="editmode-helper" />
        <% } %>
        <div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container"></div>
    </div>
</script>
<!-- --------------swipe.html--- END -->
<!-- --------------tabs.html--- START -->
<link rel="stylesheet" href="widgets/tabs/styles/jquery.sliderTabs.css">
<script src="widgets/tabs/jquery.sliderTabs.js"></script>
<script type="text/javascript">
    if (vis.editMode) {
        // Add words for widgets
        $.extend(true, systemDictionary, {
            "show_tabs":        {"en": "Tabs count",    "de": "Tabs-Anzahl",    "ru": "Количество закладок"},
            "title_tab_":       {"en": "Tab title",     "de": "Tab-Titel",      "ru": "Заголовок закладки"},
            "contains_view_":   {"en": "Contains view", "de": "View für Tab",   "ru": "Имя страницы"}
        });
    }

    vis.binds.tabs = {
        stabs: function (view, wid, data) {
            var $wid = $('#' + wid);
            var id = $wid.attr('id');
            if (id && id.match(/_removed$/)) {
                return;
            }

            if (!$wid.length) {
                return setTimeout(function () {
                    vis.binds.tabs.stabs(view, wid, data);
                }, 100);
            }
            // wait till widget will be visible
            if (!$wid.is(':visible')) {
                return setTimeout(function () {
                    vis.binds.tabs.stabs(view, wid, data);
                }, 1000);
            }

            $wid.find('.tabs-container').remove();
            var i;
            var text = '<span style="width: 100%; height: 100%" class="tabs-container">\n';
            text += '<ul>\n';

            data.show_tabs = parseInt(data.show_tabs, 10) || 1;

            for (i = 1; i <= data.show_tabs; i++) {
                text += '<li><a href="#' + wid + '_st' + i + '">' + (data['title_tab_' + i] || '') + '</a></li>';
            }
            text += '</ul>';

            for (i = 1; i <= data.show_tabs; i++) {
                text += '<div id="' + wid + '_st' + i + '" style="padding-left:0; height:100%">\n';
                if (vis.editMode) text += '    <div class="editmode-helper" />\n';
                text += '    <div data-vis-contains="' + (data['contains_view_' + i] || '') + '" class="vis-widget-body vis-view-container"></div>\n';
                text += '</div>\n';
            }
            text += '</span>';
            $wid.html(text);
            $wid.find('.tabs-container').sliderTabs({
                height: $wid.height() - 5
            });

            vis.updateContainers(view, view);

            if (vis.editMode && vis.activeWidgets.indexOf(wid) !== -1) {
                $wid.resizable('destroy');
                vis.resizable(vis.activeViewDiv, vis.activeView, $wid);
            }

            $wid.data('destroy', function (id, $widget) {
                try {
                    $widget.resizable('destroy');
                } catch (e) {

                }
            });
        }
    };
</script>

<script type="text/ejs"
        id="tplSTab"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplSTab" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee" style="top: 76px; left: 23px; width: 138px; height: 121px; position: absolute;" > <div class="vis-widget-prev-body"> <span style="width:100%;height:100%" class="ui-slider-tabs"> <!-- Unordered list representing the tabs --> <div class="ui-slider-tabs-list-wrapper"><div class="ui-slider-tabs-list-container" style="margin: 0px 35px;"><ul class="ui-slider-tabs-list" style="margin-left: 0px; width: 166px;"> <li class="selected" style="height: 32px;"><a href="#w00016_st1" style="height: 32px;">Tab</a></li><li style="height: 32px;"><a href="#w00016_st2" style="height: 32px;">Tab</a></li><li style="height: 32px;"><a href="#w00016_st3" style="height: 32px;">Tab</a></li></ul><a href="#" class="ui-slider-left-arrow edge" style="width: 35px; height: 32px;"><div></div></a><a href="#" class="ui-slider-right-arrow" style="width: 35px; height: 32px;"><div></div></a></div></div><div class="ui-slider-tabs-content-container" style="height: 86px;"><div style="padding-left: 0px; height: 100%; display: block; left: 0px; width: 126px;" class="ui-slider-tab-content selected"> <div class="editmode-helper"></div> <div data-vis-contains="hallo" class="vis-widget-body vis-view-container"></div> </div><div style="padding-left: 0px; height: 100%; left: 138px; width: 126px;" class="ui-slider-tab-content"> <div class="editmode-helper"></div> <div data-vis-contains="" class="vis-widget-body vis-view-container"></div> </div><div style="padding-left: 0px; height: 100%; left: 138px; width: 126px;" class="ui-slider-tab-content"> <div class="editmode-helper"></div> <div data-vis-contains="" class="vis-widget-body vis-view-container"></div> </div></div></span> </div> </div>'
        data-vis-set="tabs"
        data-vis-update-style="true"
        data-vis-name="SliderTabs"
        data-vis-attrs="height[100]/slider,20,1000,1;show_tabs[1]/slider,1,8,1;title_tab_(1-show_tabs)[Tab];contains_view_(1-show_tabs)/views">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px; left: 0px; width: 250px; height: 250px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <% vis.binds.tabs.stabs(this.view, this.data.attr('wid'), data) %>
        </div>
    </div>
</script>

<!-- --------------tabs.html--- END -->
<!-- --------------vis-material-advanced.html--- START -->
<!--
    ioBroker.vis vis-material-advanced Widget-Set

    version: "0.8.1"

    Copyright 2020 EdgarM73 edgar.miller@gmail.com
-->
<!-- here you can include so many css as you want -->
<link rel="stylesheet" href="widgets/vis-material-advanced/css/style.css" />
<link rel="stylesheet" href="widgets/vis-material-advanced/css/vma.css" />
<link rel="stylesheet" href="widgets/vis-material-advanced/css/material.css" />
<!-- <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500&display=swap" rel="stylesheet"> -->
<!-- here you can include so many js-files as you want -->

<!-- here you can include so many js-files as you want -->
<script type="text/javascript"    src="widgets/vis-material-advanced/js/list.js"></script>
<script type="text/javascript"    src="widgets/vis-material-advanced/js/base.js"></script>
<!-- <script type="text/javascript"    src="widgets/vis-material-advanced/js/ListDiv/listDiv.js"></script> -->
<!-- <script type="text/javascript"    src="widgets/vis-material-advanced/js/ListRegenRadar/listRegenRadar.js"></script> -->
<script type="text/javascript"    src="widgets/vis-material-advanced/js/ListDoor/listDoor.js"></script>
<script type="text/javascript"    src="widgets/vis-material-advanced/js/ListWindow/listWindow.js"></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListTemp/listTemp.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListHumidity/listHumidity.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListPressure/listPressure.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListTempHumid/listTempHumid.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListOccupancy/listOccupancy.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListLight/listLight.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListLightDim/listLightDim.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListLightKelvin/listLightKelvin.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListWindowShutter/listWindowShutter.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListVolume/listVolume.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListThermostat/listThermostat.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListBoolean/listBoolean.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListPresence/listPresence.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListNumber/listNumber.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListText/listText.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListValve/listValve.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/ListGarage/listGarage.js></script>
<script type=text/javascript    src=widgets/vis-material-advanced/js/TempIcon/TempIcon.js></script>
<script type="text/javascript"    src="widgets/vis-material-advanced/js/vis-material-advanced.js"></script>


<!-- the full description  of format in data-vis-attrs can be found here:
    https://github.com/ioBroker/ioBroker.vis/blob/master/www/js/visEditInspect.js#L39

    ----------------------------------------------------------
    Mandatory XML attributes:
        id="tplVis-material-advancedWIDGETNAME"
        type="text/ejs"
        class="vis-tpl"

        "type" and "class" are always the same. "id" is unique and must start with "tplSETNAME" and ends with widget name. Use camel-case for it.

    ----------------------------------------------------------
    data-vis-attrs - divided with semicolon the list of attributes, like attr1/id;attr2/color
        Full format of one attribute is: attr_name(start-end)[default_value]/type,idFilter/onChangeFunc
            attr_name - the name of the attribute, e.g. "myID"
            start-end - creates automatically attributes from attr_namestart to attr_nameend, like "myID(1-3)" creates myID1, myID2, myID3
            default_value - by creation of widget this attribute will be filled with this value, e.g. "myID[#001122]/color"
            type - some predefined types have edit helpers, else it will be shown as text field

                Type format:
                      id - Object ID Dialog
                      checkbox
                      image - image
                      number,min,max,step - non-float number. min,max,step are optional
                      color - color picker
                      views - Name of the view
                      effect - jquery UI show/hide effects
                      eff_opt - additional option to effect slide (up, down, left, right)
                      fontName - Font name
                      slider,min,max,step - Default step is ((max - min) / 100)
                      select,value1,value2,... - dropdown select
                      nselect,value1,value2,... - same as select, but without translation of items
                      style,fileFilter,nameFilter,attrFilter
                      custom,functionName,options,... - custom editor - functionName is starting from vis.binds.[widgetset.funct]. E.g. custom/timeAndWeather.editWeather,short
                      group.name - define new or old group. All following attributes belongs to new group till new group.xyz
                      group.name/byindex - like group, but all following attributes will be grouped by ID. Like group.windows/byindex;slide(1-4)/id;slide_type(1-4)/select,open,closed  Following groups will be created Windows1(slide1,slide_type1), Windows2(slide2,slide_type2), Windows3(slide3,slide_type3), Windows4(slide4,slide_type4)
                      text - dialog box with html editor
                      html - dialog box with html editor

                If type is "id", you can define filer for "Select ID Dialog", like "myID/id,level.temperature".
                Additionally you can define callback(onChangeFunc), which will be called if this attribute was changed by user for different purposes: validate entry, fill other attributes, ...

        You can define additional data-vis-attrs line: data-vis-attrs0, data-vis-attrs1. Anyway data-vis-attrs must be there. You may not skip numbers.
        E.g. in "data-vis-attrs="A;" data-vis-attrs1="B" attribute B will be not parsed.

    --------------------------------------------------------
    data-vis-type
        Help information for user. Used for search.
        You can define more than one type divided by comma.
        There are following common types, but you can use your own specific types:
            ctrl   - widget that can write some Object IDs
            val    - widget that shows some information from Object IDs
            static - widget do not read information from Object IDs or URL
            button - button widget
            dimmer - dimmer widget
            weather - weather widget
            ...

    --------------------------------------------------------
    data-vis-set
        Name of the widget set. Must be equal to the name of this HTML file

    --------------------------------------------------------
    data-vis-prev
        Html code used as preview of this widget. If widget is complex you can just use image as preview:
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_tplVis-material-advancedShowInstance.png"></img>'
        Of course the image must exist.

    --------------------------------------------------------
    data-vis-name
        Readable name of widget shown in vis editor.

    --------------------------------------------------------
    data-vis-beta="true"
        Shows "BETA" symbol in vis editor by preview

    --------------------------------------------------------
    data-vis-update-style="true"
        Call redraw of widget if some of the CSS styles in editor for this widget was changed

    You can read about Magic tags here: http://canjs.com/guides/EJS.html
    Following magic tags are exist:
        <% %> - execute javascript
        <%= %> - place escaped result to HTML document
        <%== %> - place unescaped result to HTML document

    You can do "if" conditions and "for" cycles.

-->
<!--

<script
    id="tplMaListDiv"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListDiv" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="widgets/vis-material-advanced/img/fts_door.png " style="width: 100px; height: 100px;"></div></div>'
    data-vis-attrs="oid/id;title/text;subtitle/text;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="opacityColor[white]/color;"
    data-vis-attrs6="colorizeByValue/checkbox;colorOpen[orange]/color;"
    data-vis-attrs7="borderRadius[10]/number,0,20,1;border/checkbox;borderColor[white]/color;"
    data-vis-attrs8="group.icons;"
    data-vis-attrs9="cardIconClosed[widgets/vis-material-advanced/img/fts_door.png]/image;"
    data-vis-attrs10="cardIconOpen[widgets/vis-material-advanced/img/fts_door_open.png]/image;"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style="true"
    data-vis-name="ListDiv"    >
    <div class="vis-widget mdw-list vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>"
         data-oid="<%= this.data.oid %>">
        <div class="vis-widget-body vma_inner_container_div" >
            <%   let init = genListDiv(this.data);  %>
            <%==  init.widget   %>
        </div>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListDiv(this.data.wid, this.view, this.data);  %>
</script> -->

<!-- <script
    id="tplMaListRegenRadarDWD"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-RegenRadarDWD" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="widgets/vis-material-advanced/img/fts_door.png " style="width: 100px; height: 100px;"></div></div>'
    data-vis-attrs="oid/id;title/text;subtitle/text;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="opacityColor[white]/color;"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style= "true"
    data-vis-name="ListRegenRadarDWD"     >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListRegenRadar(this.data);           %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListRegenRadarDWD(this.data.wid, this.view, this.data);   %>
</script> -->


<script
    id="tplMaListDoor"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListDoor2" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/fts_door.svg " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;iWiki/custom,'https://github.com/iobroker-community-adapters/ioBroker.vis-material-advanced/wiki/Properties',wiki;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;colorizeByValue/checkbox;colorOpen[orange]/color;"
    data-vis-attrs7="group.icons;"
    data-vis-attrs8="cardIconClosed[/icons-mfd-svg/fts_door.svg]/image;"
    data-vis-attrs9="cardIconOpen[/icons-mfd-svg/fts_door_open.svg]/image;"
    data-vis-attrs10="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs11="group.border;"
    data-vis-attrs12="border/checkbox;borderColor[white]/color;borderRadius[10]/number,0,20,1;"
    data-vis-attrs13="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs14="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style= "true"
    data-vis-name="ListDoor" >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListDoor(this.data);    %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListOpenClose(this.data.wid, this.view, this.data);  %>
</script>

<script
    id="tplMaListWindow"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListWindow" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/fts_window_2w.svg " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="colorizeByValue/checkbox;colorOpen[orange]/color;"
    data-vis-attrs8="group.icons;"
    data-vis-attrs9="cardIconClosed[/icons-mfd-svg/fts_window_2w.svg]/image;"
    data-vis-attrs10="cardIconOpen[/icons-mfd-svg/fts_window_2w_open.svg]/image;"
    data-vis-attrs11="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs12="group.border;"
    data-vis-attrs13="border/checkbox;borderColor[white]/color;borderRadius[10]/number,0,20,1;"
    data-vis-attrs14="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs15="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style="true"
    data-vis-name="ListWindow"  >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListWindow(this.data);   %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListOpenClose(this.data.wid, this.view, this.data);  %>
</script>

<script
    id="tplMaListWindow3"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListWindow3" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/fts_window_2w.svg " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="colorizeByValue/checkbox;colorOpen[orange]/color;colorTilted[yellow]/color;"
    data-vis-attrs8="group.icons;"
    data-vis-attrs9="cardIconClosed[/icons-mfd-svg/fts_window_2w.svg]/image;"
    data-vis-attrs10="cardIconOpen[/icons-mfd-svg/fts_window_2w_open.svg]/image;cardIconTilted[/icons-mfd-svg/fts_window_2w_tilt.svg]/image;"
    data-vis-attrs11="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs12="group.border;"
    data-vis-attrs13="border/checkbox;borderColor[white]/color;borderRadius[10]/number,0,20,1;"
    data-vis-attrs14="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs15="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style="true"
    data-vis-name="ListWindow3"  >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListWindow(this.data);   %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListOpenCloseTilted(this.data.wid, this.view, this.data);  %>
</script>


<script
    id="tplMaListTemp"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListTemp" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/temp_temperature.svg " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id,value.temperature;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="colorizeByValue/checkbox;below[18]/number;above[24]/number;color-low[blue]/color;color-high[red]/color;"
    data-vis-attrs8="group.icons;"
    data-vis-attrs9="cardIcon[/icons-mfd-svg/temp_temperature.svg]/image;"
    data-vis-attrs10="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs11="group.border;"
    data-vis-attrs12="border/checkbox;borderColor[white]/color;borderRadius[10]/number,0,20,1;"
    data-vis-attrs13="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs14="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style="true"
    data-vis-name="ListTemp" >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListTemperature(this.data);   %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListVal(this.data.wid, this.view, this.data,'temp');  %>
</script>

<script
    id="tplMaTempIcon"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedTempIcon" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="widgets/vis-material-advanced/img/temp_verlauf_100.png " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id,value.temperature;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="opacityColor[white]/color;"
    data-vis-attrs2="colorizeByValue/checkbox;min/number;max/number;IcontypeSVG[]/checkbox;"
    data-vis-attrs3="group.icons;"
    data-vis-attrs4="cardIcon[widgets/vis-material-advanced/img/temp_verlauf_100.png]/image;"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style="true"
    data-vis-name="TempIcon"    >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %> icon-widget" id="<%= this.data.attr('wid') %>" >
        <%   let init = genTemperatureIcon(this.data);   %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdTempIcon(this.data.wid, this.view, this.data,'temp');  %>
</script>

<script
    id="tplMaListHumid"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListHumid" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/weather_humidity_rel.svg " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id,value.humidity;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="colorizeByValue/checkbox;below[40]/number;above[60]/number;color-low[blue]/color;color-high[red]/color;"
    data-vis-attrs8="group.icons;"
    data-vis-attrs9="cardIcon[/icons-mfd-svg/weather_humidity_rel.svg]/image;"
    data-vis-attrs10="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs11="group.border;"
    data-vis-attrs12="border/checkbox;borderColor[white]/color;borderRadius[10]/number,0,20,1;"
    data-vis-attrs13="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs14="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style="true"
    data-vis-name="ListHumid"  >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListHumidity(this.data);   %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListVal(this.data.wid, this.view, this.data,'humid'); %>
</script>


<script
    id="tplMaListPressure"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListPressure" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/weather_barometric_pressure.svg " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="colorizeByValue/checkbox;below[18]/number;above[24]/number;color-low[blue]/color;color-high[red]/color;"
    data-vis-attrs8="group.icons;"
    data-vis-attrs9="cardIcon[/icons-mfd-svg/weather_barometric_pressure.svg]/image;"
    data-vis-attrs10="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs11="group.border;"
    data-vis-attrs12="border/checkbox;borderColor[white]/color;borderRadius[10]/number,0,20,1;"
    data-vis-attrs13="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs14="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style="true"
    data-vis-name="ListPressure"  >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListPressure(this.data);   %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListVal(this.data.wid, this.view, this.data,'pressure'); %>
</script>


<script
    id="tplMaListTempHumid"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListTempHumid" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev " style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="widgets/vis-material-advanced/img/temperature.png " style="width: 100px; height: 100px; "></div></div>'
    data-vis-attrs="oid/id,value.temperature;oid2/id,value.humidity;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="group.icons;"
    data-vis-attrs8="cardIcon[widgets/vis-material-advanced/img/temperature.png]/image;"
    data-vis-attrs9="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs10="group.border;"
    data-vis-attrs11="border/checkbox;borderColor[white]/color;borderRadius[10]/number,0,20,1;"
    data-vis-attrs12="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs13="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-name="ListTemperatureHumid"   >
    <div  id="<%= this.data.attr('wid') %>"  class="vis-widget vma_outer_div  <%==this.data.attr( 'class') %> ">
        <%   let init = genListTempHumid(this.data);  %>
        <%== init.widget %>
    </div>
<% vis.binds['vis-material-advanced'].tplMdListTempHumid(this.data.wid,  this.view, this.data,'temp','humid');  %>
</script>

<script
    id="tplMaListPresence"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListPresence" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="widgets/vis-material-advanced/img/female_white.png " style="width: 100px; height: 100px;"></div></div>'
    data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="colorizeByValue/checkbox;presenceColor[yellow]/color;"
    data-vis-attrs8="group.icons;"
    data-vis-attrs9="iconPresent[widgets/vis-material-advanced/img/female_white_star.png]/image;"
    data-vis-attrs10="iconNotPresent[widgets/vis-material-advanced/img/female_white.png]/image;"
    data-vis-attrs11="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs12="group.border;"
    data-vis-attrs13="border/checkbox;borderColor[white]/color;borderRadius[10]/number,0,20,1;"
    data-vis-attrs14="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs15="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style="true"
    data-vis-name="ListPresence"  >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListPresence(this.data);   %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListPresence(this.data.wid, this.view, this.data,'humid'); %>
</script>

<script
    id="tplMaListOccupancy"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListOccupancy" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/message_presence_active.svg " style="width: 100px; height: 100px;"></div></div>'
    data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="colorizeByValue/checkbox;motionColor[yellow]/color;"
    data-vis-attrs8="group.icons;"
    data-vis-attrs9="iconMotion[/icons-mfd-svg/message_presence_active.svg]/image;"
    data-vis-attrs10="iconNoMotion[/icons-mfd-svg/message_presence_inactive.svg]/image;"
    data-vis-attrs11="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs12="group.border;"
    data-vis-attrs13="border/checkbox;borderColor[white]/color;borderRadius[10]/number,0,20,1;"
    data-vis-attrs14="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs15="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style="true"
    data-vis-name="ListOccupancy"  >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListOccupancy(this.data);   %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListOccupancy(this.data.wid, this.view, this.data,'pressure'); %>
</script>


<script
    id="tplMaListLight"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListLight" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/light_light_dim_100.svg" style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="colorizeByValue/checkbox;lightOnColor[yellow]/color;"
    data-vis-attrs8="readOnly/checkbox;"
    data-vis-attrs9="group.icons;"
    data-vis-attrs10="cardIconOn[/icons-mfd-svg/light_light_dim_100.svg]/image;"
    data-vis-attrs11="cardIconOff[/icons-mfd-svg/light_light_dim_00.svg]/image;"
    data-vis-attrs12="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs13="group.border;"
    data-vis-attrs14="border/checkbox;borderColor[white]/color;borderRadius[10]/number,0,20,1;"
    data-vis-attrs15="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs16="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val,ctrl"
    data-vis-update-style="true"
    data-vis-name="ListLight"         >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>"  >
        <%   let init = genListLight(this.data);   %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListLight(this.data.wid, this.view, this.data,'pressure');  %>
</script>


<script
    id="tplMaListLightDim"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListLightDim" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/light_control.svg " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;valueAsSubtitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="colorizeByValue/checkbox;low[20]/number;high[70]/number;"
    data-vis-attrs8="lightLowColor[white]/color;lightMediumColor[yellow]/color;lightHighColor[red]/color;"
    data-vis-attrs9="borderRadius[10]/number,0,20,1;border/checkbox;borderColor[white]/color;readOnly/checkbox;"
    data-vis-attrs10="group.icons;"
    data-vis-attrs11="cardIconOn[/icons-mfd-svg/light_light_dim_100.svg]/image;"
    data-vis-attrs12="cardIconOff[/icons-mfd-svg/light_light_dim_00.svg]/image;"
    data-vis-attrs13="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs14="group.border;"
    data-vis-attrs15="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs16="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val,dimmer"
    data-vis-update-style="true"
    data-vis-name="ListLightDim"    >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListLightDim(this.data);     %>
        <%== init.widget    %>
        <div  class="vma_value_container ">
            <div class="vma_value vma-slider"
                style="color:    <%= this.data.attr('Text-color') %>; text-align:<%= this.data.attr('valueAlign') %>; vertical-align:<%= this.data.attr('valueVertical') %>;" >
                <% if(!this.data.readOnly) { %>
                    <div class="sliderJQUI" id="<%= this.data.attr('wid') %>_slider"
                        data-oid="<%= this.data.attr('oid') %>" data-oid2="<%= this.data.attr('oid-2') %>" data-oid-working="<%= this.data.attr('oid-working') %>"  ,
                        data-oid2-working="<%= this.data.attr('oid-2-working') %>"<%= (el) -> vis.binds.jqueryui.slider(el, {min: 0,max:100,step:5,inverted:false}) %> />
                    </div><label for="<%= this.data.attr('wid') %>_checkbox"><label>
                <% } %>
            </div>
        </div>
        <div class="vma_overlay ms-button-op vis-widget-body" ></div>

    </div>
    <% vis.binds['vis-material-advanced'].tplMdListLightDim(this.data.wid, this.view, this.data,'pressure'); %>
</script>


<script
    id="tplMaListLightKelvin"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListLightKelvin" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="widgets/vis-material-advanced/img/fts_kelvin_warmweiss.png " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;valueAsSubtitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="min[2700]/number;max[6500]/number;"
    data-vis-attrs8="readOnly/checkbox;"
    data-vis-attrs9="group.icons;"
    data-vis-attrs10="cardIcon-warmwhite[widgets/vis-material-advanced/img/fts_kelvin_warmweiss.png]/image;"
    data-vis-attrs11="cardIcon-medium[widgets/vis-material-advanced/img/fts_kelvin_mittel.png]/image;"
    data-vis-attrs12="cardIcon-coldwhite[widgets/vis-material-advanced/img/fts_kelvin_kaltweiss.png]/image;"
    data-vis-attrs13="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs14="group.border;"
    data-vis-attrs15="borderRadius[10]/number,0,20,1;border/checkbox;borderColor[white]/color;"
    data-vis-attrs16="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs17="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val,dimmer,ctrl"
    data-vis-update-style="true"
    data-vis-name="ListLightKelvin"       >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListLightKelvin(this.data);   %>
        <%== init.widget  %>
            <div  class="vma_value_container ">
                <div class="vma_value vma-slider"
                    style="color:    <%= this.data.attr('TextColor') %>; text-align:<%= this.data.attr('valueAlign') %>; vertical-align:<%= this.data.attr('valueVertical') %>;" >
                    <% if(!this.data.readOnly) { %>
                        <div class="sliderJQUI" id="<%= this.data.attr('wid') %>_slider"
                            data-oid="<%= this.data.attr('oid') %>" data-oid2="<%= this.data.attr('oid-2') %>" data-oid-working="<%= this.data.attr('oid-working') %>"  ,
                            data-oid2-working="<%= this.data.attr('oid-2-working') %>"<%= (el) -> vis.binds.jqueryui.slider(el, {min: parseFloat(data.min),max:parseFloat(data.max),step:100,inverted:false}) %> />
                        </div><label for="<%= this.data.attr('wid') %>_checkbox"><label>
                    <% } %>
                </div>
            </div>
            <div class="vma_overlay ms-button-op vis-widget-body" ></div>
        </div>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListLightKelvin(this.data.wid, this.view, this.data,'pressure'); %>
</script>



<script
    id="tplMaListThermostat"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListThermostat" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev " style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/sani_heating_temp.svg " style="width: 100px; height: 100px; "></div></div>'
    data-vis-attrs="oid/id,level.temperature;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;valueAsSubtitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;min[14]/number;max[30]/number;"
    data-vis-attrs7="readOnly/checkbox;"
    data-vis-attrs8="group.icons;"
    data-vis-attrs9="cardIcon[/icons-mfd-svg/sani_heating_temp.svg]/image;"
    data-vis-attrs10="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs11="group.border;"
    data-vis-attrs12="borderRadius[10]/number,0,20,1;border/checkbox;borderColor[white]/color;"
    data-vis-attrs13="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs14="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val,ctrl"
    data-vis-name="ListThermostat">
    <div  id="<%= this.data.attr('wid') %>"  class="vis-widget vma_outer_div  <%=this.data.attr( 'class') %> ">
        <%   let init = genListThermostat(this.data);  %>
        <%== init.widget %>
        <div  class="vma_value_container ">
            <div class="vma_value vma-slider"
                style="color:    <%= this.data.attr('TextColor') %>; text-align:<%= this.data.attr('valueAlign') %>; vertical-align:<%= this.data.attr('valueVertical') %>;" >
                <% if(!this.data.readOnly) { %>
                    <div class="sliderJQUI" id="<%= this.data.attr('wid') %>_slider"
                        data-oid="<%= this.data.attr('oid') %>" data-oid2="<%= this.data.attr('oid-2') %>" data-oid-working="<%= this.data.attr('oid-working') %>"  ,
                        data-oid2-working="<%= this.data.attr('oid-2-working') %>"<%= (el) -> vis.binds.jqueryui.slider(el, {min: parseFloat(data.min),max:parseFloat(data.max),step:0.5,inverted:false}) %> />
                    </div><label for="<%= this.data.attr('wid') %>_checkbox"><label>
                <% } %>
            </div>
        </div>
        <div class="vma_overlay ms-button-op vis-widget-body" ></div>
    </div>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListThermostat(this.data.wid,  this.view, this.data,'temp');  %>
</script>

<script
    id="tplMaListWindowShutter"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListWindowShutter" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/fts_shutter_manual.svg" style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;valueAsSubtitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="inverted[checked]/checkbox;"
    data-vis-attrs8="readOnly/checkbox;"
    data-vis-attrs9="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs10="group.border;"
    data-vis-attrs11="borderRadius[10]/number,0,20,1;border/checkbox;borderColor[white]/color;"
    data-vis-attrs12="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs13="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val,ctrl"
    data-vis-update-style="true"
    data-vis-name="ListWindowShutter"      >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListWindowShutter(this.data);   %>
        <%== init.widget  %>
            <div  class="vma_value_container ">
                <div class="vma_value vma-slider"
                    style="color:    <%= this.data.attr('Text-color') %>; text-align:<%= this.data.attr('valueAlign') %>; vertical-align:<%= this.data.attr('valueVertical') %>;" >
                    <% if(!this.data.readOnly) { %>
                        <div class="sliderJQUI" id="<%= this.data.attr('wid') %>_slider"
                            data-oid="<%= this.data.attr('oid') %>" data-oid2="<%= this.data.attr('oid-2') %>" data-oid-working="<%= this.data.attr('oid-working') %>"  ,
                            data-oid2-working="<%= this.data.attr('oid-2-working') %>"<%= (el) -> vis.binds.jqueryui.slider(el, {min:0,max:100,step:1,inverted:false}) %> />
                        </div><label for="<%= this.data.attr('wid') %>_checkbox"><label>
                    <% } %>
                </div>
            </div>
            <div class="vma_overlay ms-button-op vis-widget-body" ></div>

    </div>
    <% vis.binds['vis-material-advanced'].tplMdListWindowShutter(this.data.wid, this.view, this.data); %>
</script>



<script
    id="tplMaListVolume"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListVolume" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/audio_volume_low.svg " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;valueAsSubtitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="Min[0]/number;Max[100]/number;step[5]/select,1,5,10;"
    data-vis-attrs8="readOnly/checkbox;"
    data-vis-attrs9="group.icons;"
    data-vis-attrs10="cardIcon-high[/icons-mfd-svg/audio_volume_high.svg]/image;"
    data-vis-attrs11="cardIcon-medium[/icons-mfd-svg/audio_volume_mid.svg]/image;"
    data-vis-attrs12="cardIcon-low[/icons-mfd-svg/audio_volume_mute.svg]/image;"
    data-vis-attrs13="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs14="group.border;"
    data-vis-attrs15="borderRadius[10]/number,0,20,1;border/checkbox;borderColor[white]/color;"
    data-vis-attrs16="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs17="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val,ctrl"
    data-vis-update-style="true"
    data-vis-name="ListVolume"  >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListVolume(this.data);   %>
        <%== init.widget  %>
            <div  class="vma_value_container ">
                <div class="vma_value vma-slider"
                    style="color:    <%= this.data.attr('Text-color') %>; text-align:<%= this.data.attr('valueAlign') %>; vertical-align:<%= this.data.attr('valueVertical') %>;" >
                    <% if(!this.data.readOnly) { %>
                        <div class="sliderJQUI" id="<%= this.data.attr('wid') %>_slider"
                            data-oid="<%= this.data.attr('oid') %>" data-oid2="<%= this.data.attr('oid-2') %>" data-oid-working="<%= this.data.attr('oid-working') %>"  ,
                            data-oid2-working="<%= this.data.attr('oid-2-working') %>"<%= (el) -> vis.binds.jqueryui.slider(el, {min: this.data.attr('Min'),max:this.data.attr('Max'),step:parseInt(this.data.attr('step')),inverted:false}) %> />
                        </div><label for="<%= this.data.attr('wid') %>_checkbox"><label>
                    <% } %>
                </div>
            </div>
            <div class="vma_overlay ms-button-op vis-widget-body" ></div>
        </div>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListVolume(this.data.wid, this.view, this.data); %>
</script>


<script
    id="tplMaListBoolean"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListBoolean" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="widgets/vis-material-advanced/img/checked.png " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="true[Wahr]/text;false[Falsch]/text;"
    data-vis-attrs8="colorizeByValue/checkbox;color-true/color;color-false/color;"
    data-vis-attrs9="group.icons;"
    data-vis-attrs10="cardIconTrue[/icons-mfd-svg/status_light_low.svg]/image;"
    data-vis-attrs11="cardIconFalse[/icons-mfd-svg/status_light_off.svg]/image;"
    data-vis-attrs12="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs13="group.border;"
    data-vis-attrs14="borderRadius[10]/number,0,20,1;border/checkbox;borderColor[white]/color;"
    data-vis-attrs15="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs16="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val,button"
    data-vis-update-style="true"
    data-vis-name="ListBoolean" >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListBoolean(this.data);   %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListBoolean(this.data.wid, this.view, this.data);  %>
</script>



<script
    id="tplMaListNumber"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListNumber" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="widgets/vis-material-advanced/img/123.png " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;unit[]/select,,percent,Celsius,Fahrenheit,ppm,kmh,mph,mm,m,mb,GB,Wh,V,Hz,mA;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="low/number;high/number;"
    data-vis-attrs8="colorizeByValue/checkbox;color-low/color;color-high/color;"
    data-vis-attrs9="group.border;"
    data-vis-attrs10="borderRadius[10]/number,0,20,1;border/checkbox;borderColor[white]/color;"
    data-vis-attrs11="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs12="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style="true"
    data-vis-name="ListNumber"    >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
            <%   let init = genListNumber(this.data);      %>
            <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListNumber(this.data.wid, this.view, this.data);  %>
</script>


<script
    id="tplMaListText"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListText" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="widgets/vis-material-advanced/img/abc.png " style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="colorizeByValue/checkbox;searchString/text;stringFoundColor/color;"
    data-vis-attrs8="group.border;"
    data-vis-attrs9="borderRadius[10]/number,0,20,1;border/checkbox;borderColor[white]/color;"
    data-vis-attrs10="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs11="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style="true"
    data-vis-name="ListText"    >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListText(this.data);   %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListText(this.data.wid, this.view, this.data);  %>
</script>

<script
    id="tplMaListValve"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListValve" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/sani_valve_50.svg" style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="colorizeByValue/checkbox;"
    data-vis-attrs8="below[18]/number;above[24]/number;color-medium[darkyellow]/color;color-high[red]/color;"
    data-vis-attrs9="group.icons;"
    data-vis-attrs10="cardIcon[/icons-mfd-svg/sani_valve_50.svg]/image;"
    data-vis-attrs11="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs12="group.border;"
    data-vis-attrs13="borderRadius[10]/number,0,20,1;border/checkbox;borderColor[white]/color;"
    data-vis-attrs14="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs15="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-update-style="true"
    data-vis-name="ListValve" >
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListValve(this.data);   %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListValve(this.data.wid, this.view, this.data,'pressure'); %>
</script>

<script
    id="tplMaListGarage"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListGarage" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="/icons-mfd-svg/fts_garage_door_100.svg" style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;showTitle[checked]/checkbox;onlyTitle[]/checkbox;"
    data-vis-attrs0="group.BoxStyle;"
    data-vis-attrs1="titleSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs2="widgetBackground[#121212]/color;TextColor[white]/color;"
    data-vis-attrs3="subtitleSize[x-small]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs4="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs5="valueSize[medium]/select, medium, xx-small, x-small, small, large, x-large, xx-large, smaller, larger;"
    data-vis-attrs6="opacityColor[white]/color;"
    data-vis-attrs7="colorizeByValue/checkbox;colorOpen[orange]/color;"
    data-vis-attrs8="group.icons;"
    data-vis-attrs9="cardIconClosed[/icons-mfd-svg/fts_garage_door_100.svg]/image;"
    data-vis-attrs10="cardIconOpen[/icons-mfd-svg/fts_garage.svg]/image;"
    data-vis-attrs11="showIcon[checked]/checkbox;centerIcon[]/checkbox;"
    data-vis-attrs12="group.border;"
    data-vis-attrs13="borderRadius[10]/number,0,20,1;border/checkbox;borderColor[white]/color;"
    data-vis-attrs14="useOverallRoundedValues[checked]/checkbox;roundLeftUp[10]/number,0,20,1;roundLeftBottom[0]/number,0,20,1;roundRightUp[0]/number,0,20,1;roundRightBottom[10]/number,0,20,1;"
    data-vis-attrs15="boxShadow[unchecked]/checkbox;shadowWidth[2]/number,1,10,1"
    data-vis-set="vis-material-advanced"
    data-vis-type="val,switch"
    data-vis-update-style="true"
    data-vis-name="ListGarage"    >
    <div class="vis-widget mdw-list vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" >
        <%   let init = genListGarage(this.data);  %>
        <%== init.widget %>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListOpenClose(this.data.wid, this.view, this.data);  %>
</script>

<!--
<script
    id="tplMaListNew"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListNew" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev " style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="widgets/vis-material-advanced/img/garage.png " style="width: 100px; height: 100px; "></div></div>'
    data-vis-attrs="oid/id;title[not working yet]/text;subtitle/text;widgetBackground[#121212]/color;Text-color[white]/color;"
    data-vis-attrs0="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs1="opacityColor[white]/color;"
    data-vis-attrs2="borderRadius[10]/number;"
    data-vis-attrs3="group.icons;"
    data-vis-attrs4="cardIconClosed[widgets/vis-material-advanced/img/garage_closed.png]/image;"
    data-vis-attrs5="cardIconOpen[widgets/vis-material-advanced/img/garage.png]/image;"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-beta="true"
    data-vis-name="ListNew">
<div id="<%= this.data.attr('wid') %>" class=" vma_outer_div  <%==this.data.attr( 'class') %> ">
    <div class="vma_inner_container_div" >
        <div class="vma_picture">
            <img class="vma_icon"        src="<%= this.data.attr('cardIcon') %>">
        </div>
        <div class="vma_title_subtitle_container" style="color: <%= this.data.attr('Text-color') %>;">
            <div  class="vma_title">
                <%= this.data.attr('title') %>
            </div>
            <div  class="vma_subtitle" style=" color: <%= this.data.attr('Text-color') %>;">
                <%= this.data.attr('subtitle') %>
            </div>
        </div>
        <div  class="vma_value_container">
            <div class="vma_value"
                style="color:    <%= this.data.attr('Text-color') %>; text-align:<%= this.data.attr('valueAlign') %>; vertical-align:<%= this.data.attr('valueVertical') %>;" >
            </div>
        </div>
        <div class="vma_overlay"  ></div>
    </div>
</div>
<% vis.binds['vis-material-advanced'].tplMdListNew(this.data.wid, this.view, this.data);  %>
</script>

<script
    id="tplMaListNewDuo"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListNewDuo" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev " style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="widgets/vis-material-advanced/img/temperature.png " style="width: 100px; height: 100px; "></div></div>'
    data-vis-attrs="oid/id,value.temperature;oid2/id,value.humidity;title[to be tested]/text;subtitle/text;widgetBackground[#121212]/color;Text-color[white]/color;"
    data-vis-attrs0="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs1="opacityColor[white]/color;"
    data-vis-attrs2="borderRadius[10]/number,1,20,1;"
    data-vis-attrs3="group.icons;"
    data-vis-attrs4="cardIcon[widgets/vis-material-advanced/img/temperature.png]/image;"
    data-vis-set="vis-material-advanced"
    data-vis-type="val"
    data-vis-beta="true"
    data-vis-name="ListNewDuo"  >
    <div  id="<%= this.data.attr('wid') %>" class=" vma_outer_div  <%==this.data.attr( 'class') %> ">
        <div  class="vma_inner_container_div" >
            <div  class="vma_picture">
                <img class="vma_icon" src="<%= this.data.attr('cardIcon') %>">
            </div>
            <div  class="vma_title_subtitle_container" style="color: <%= this.data.attr('Text-color') %>;">
                <div class="vma_title">
                    <%= this.data.attr('title') %>
                </div>
                <div class="vma_subtitle" style=" color: <%= this.data.attr('Text-color') %>;">
                    <%= this.data.attr('subtitle') %>
                </div>
            </div>
            <div class="vma_value_container">
                <div class="vma_value2_1"
                    style="color:    <%= this.data.attr('Text-color') %>; text-align:<%= this.data.attr('valueAlign') %>; vertical-align:<%= this.data.attr('valueVertical') %>;" >
                </div>
                <div class="vma_value2_2"
                    style="color:    <%= this.data.attr('Text-color') %>; text-align:<%= this.data.attr('valueAlign') %>; vertical-align:<%= this.data.attr('valueVertical') %>;" >
                </div>
            </div>
            <div class="vma_overlay"  ></div>
        </div>
    </div>
<% vis.binds['vis-material-advanced'].tplMdListNewDuo(this.data.wid, this.view, this.data);  %>
</script>
-->

<!--
<script
    id="tplMaListRadio"
    type="text/ejs"
    class="vis-tpl"
    data-vis-prev='<div id="prev_tplVis-material-advancedListRadio" style="position: relative; text-align: initial;padding: 4px ">
        <div class="vis-widget_prev" style="width: 100px; height: 100px; padding:2px; background-color: #121212 " >
        <img src="widgets/vis-material-advanced/img/radio.png " style="width: 100px; height: 100px;"></div></div>'
    data-vis-attrs="oid/id;value;title/text;subtitle/text;widgetBackground[#121212]/color;Text-color[white]/color;"
    data-vis-attrs0="valueAlign[right]/select,left,center,right;valueVertical[center]/select,top,center,bottom;"
    data-vis-attrs1="opacityColor[white]/color;colorizeByValue/checkbox;lightOnColor[yellow]/color;"
    data-vis-attrs2="borderRadius[10]/number,0,20,1;border/checkbox;borderColor[white]/color;readOnly/checkbox;"
    data-vis-attrs3="group.icons;"
    data-vis-attrs4="cardIcon[widgets/vis-material-advanced/img/radio.png]/id;"
    data-vis-set="vis-material-advanced"
    data-vis-type="val,ctrl"
    data-vis-update-style="true"
    data-vis-name="ListRadio">
    <div class="vis-widget vma_outer_div <%= this.data.attr( 'class') %>" id="<%= this.data.attr('wid') %>" style="background-color: <%= this.data.attr('widgetBackground') %>; " >
        <div class="vis-widget-body vma_inner_container_div"  >
            <div class="vma_picture">
                <img class="vma_icon" src="{<%= this.data.attr('cardIcon') %>}">
            </div>
            <div class="vma_title_subtitle_container" style="color: <%= this.data.attr('Text-color') %>;">
                <div  class="vma_title" >
                    <%= this.data.attr('title') %>
                </div>
                <div  class="vma_subtitle" style=" color:  <%= this.data.attr('Text-color') %>;" >
                    <%= this.data.attr('subtitle') %>
                </div>
            </div>
            <div  class="vma_value_container ">
                <div class="vma_value  "
                    style="color:    <%= this.data.attr('Text-color') %>; text-align:<%= this.data.attr('valueAlign') %>; vertical-align:<%= this.data.attr('valueVertical') %>;" >
                    <% if(!this.data.readOnly) { %>

                        <label class="vma-switch">
                                <input type="checkbox" checked="" name="<%=this.data.attr( 'wid') %>_checkbox" id="<%= this.data.attr('wid') %>_checkbox"  data-oid="<%= this.data.attr('oid') %>">
                                 <span class="vma-slider-switch round"></span>
                        </label>

                    <% } %>
                </div>
            </div>
            <div class="vma_overlay ms-button-op vis-widget-body"></div>
        </div>
    </div>
    <% vis.binds['vis-material-advanced'].tplMdListRadio(this.data.wid, this.view, this.data,'pressure');  %>
</script>
-->
<!-- --------------vis-material-advanced.html--- END -->